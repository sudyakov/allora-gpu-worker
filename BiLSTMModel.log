2024-10-04 14:58:16,159 - INFO - Logging is set up.
2024-10-04 14:58:16,159 - INFO - Используемое устройство: cuda
2024-10-04 14:58:16,159 - INFO - Numerical columns for scaling: ['open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 14:58:16,159 - INFO - Categorical columns: ['symbol', 'interval']
2024-10-04 14:58:16,212 - INFO - Комбинированные данные загружены из data/combined_dataset.csv
2024-10-04 14:58:16,249 - INFO - Порядок столбцов после fit_transform: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 14:58:16,251 - INFO - DataProcessor сохранен: models/data_processor_ETHUSDT_v2.0.pkl
2024-10-04 14:58:16,251 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 14:58:16,251 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 14:58:17,120 - WARNING - Файл модели models/enhanced_bilstm_model_ETHUSDT_v2.0.pth не найден. Будет создана новая модель.
2024-10-04 14:58:39,738 - INFO - Epoch 1/5 - Loss: 8542312438637.7139
2024-10-04 14:58:39,812 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 14:58:39,812 - INFO - Validation loss improved to 8542312438637.7139. Model saved.
2024-10-04 14:59:01,525 - INFO - Epoch 2/5 - Loss: 8539763204486.0957
2024-10-04 14:59:01,606 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 14:59:01,606 - INFO - Validation loss improved to 8539763204486.0957. Model saved.
2024-10-04 14:59:22,645 - INFO - Epoch 3/5 - Loss: 8548928116833.5234
2024-10-04 14:59:22,645 - INFO - No improvement in validation loss. (1/5)
2024-10-04 14:59:22,645 - INFO - Reducing learning rate to: 0.00025
2024-10-04 14:59:44,431 - INFO - Epoch 4/5 - Loss: 8538897714224.7617
2024-10-04 14:59:44,516 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 14:59:44,516 - INFO - Validation loss improved to 8538897714224.7617. Model saved.
2024-10-04 15:00:06,323 - INFO - Epoch 5/5 - Loss: 8540099934695.6191
2024-10-04 15:00:06,323 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:00:06,323 - INFO - Reducing learning rate to: 0.000125
2024-10-04 15:00:06,324 - INFO - Скрипт запущен
2024-10-04 15:00:06,700 - INFO - Binance API доступен. Время сервера: 2024-10-04 12:00:06
2024-10-04 15:00:07,754 - INFO - Обновление данных для ETHUSDT с 1728043020001 до 1728043200000 (2024-10-04 11:57:00 до 2024-10-04 12:00:00)
2024-10-04 15:00:08,190 - INFO - Данные сохранены в data/ETHUSDT_1_data.csv
2024-10-04 15:00:08,833 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:08,834 - INFO - Сводка данных для ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        ETHUSDT    1          1728043200000 2386.199951171875 2386.35009765625 2386.1201171875 2386.340087890625 1.7990000247955322 4292.9033203125 240        1.63100004196167 3892.02099609375 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727265480000        ETHUSDT    1          1727265480000 2627.39990234375 2627.89990234375 2627.39990234375 2627.820068359375 76.50299835205078 201012.703125 842        67.06340026855469 176209.25  11         6          0.258819043636322 -0.9659258127212524 -0.7818315029144287 0.6234897971153259

2024-10-04 15:00:09,476 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:09,476 - INFO - ------------------------
2024-10-04 15:00:11,508 - INFO - Обновление данных для ETHUSDT с 1728042900001 до 1728043200000 (2024-10-04 11:55:00 до 2024-10-04 12:00:00)
2024-10-04 15:00:11,913 - INFO - Данные сохранены в data/ETHUSDT_5_data.csv
2024-10-04 15:00:12,565 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:12,567 - INFO - Сводка данных для ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        ETHUSDT    5          1728043200000 2386.199951171875 2386.719970703125 2386.1201171875 2386.719970703125 10.690500259399414 25512.998046875 573        8.301799774169922 19811.94921875 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726488000000        ETHUSDT    5          1726488000000 2307.800048828125 2310.610107421875 2306.60009765625 2309.989990234375 749.1240234375 1729554.25 5211       555.8009033203125 1283180.625 12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:00:13,214 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:13,215 - INFO - ------------------------
2024-10-04 15:00:15,254 - INFO - Обновление данных для ETHUSDT с 1728042300001 до 1728043200000 (2024-10-04 11:45:00 до 2024-10-04 12:00:00)
2024-10-04 15:00:15,635 - INFO - Данные сохранены в data/ETHUSDT_15_data.csv
2024-10-04 15:00:16,281 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:16,283 - INFO - Сводка данных для ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        ETHUSDT    15         1728043200000 2386.199951171875 2386.800048828125 2386.1201171875 2386.800048828125 13.31779956817627 31783.779296875 624        10.775699615478516 25716.595703125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724932800000        ETHUSDT    15         1724932800000 2555.199951171875 2558.4599609375 2552.139892578125 2556.7900390625 1688.5289306640625 4314773.5  17545      720.7266845703125 1841737.125 12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:00:16,956 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:16,957 - INFO - ------------------------
2024-10-04 15:00:19,006 - INFO - Обновление данных для BTCUSDT с 1728043020001 до 1728043200000 (2024-10-04 11:57:00 до 2024-10-04 12:00:00)
2024-10-04 15:00:19,441 - INFO - Данные сохранены в data/BTCUSDT_1_data.csv
2024-10-04 15:00:20,082 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:20,083 - INFO - Сводка данных для BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        BTCUSDT    1          1728043200000 61449.83984375 61458.0    61448.98828125 61458.0    1.6986500024795532 104382.9375 452        1.530400037765503 94043.8125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727265480000        BTCUSDT    1          1727265480000 63842.640625 63848.0    63838.0    63838.0    4.534259796142578 289491.6875 912        3.17549991607666 202743.3125 11         6          0.258819043636322 -0.9659258127212524 -0.7818315029144287 0.6234897971153259

2024-10-04 15:00:20,730 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:20,731 - INFO - ------------------------
2024-10-04 15:00:22,771 - INFO - Обновление данных для BTCUSDT с 1728042900001 до 1728043200000 (2024-10-04 11:55:00 до 2024-10-04 12:00:00)
2024-10-04 15:00:23,159 - INFO - Данные сохранены в data/BTCUSDT_5_data.csv
2024-10-04 15:00:23,803 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:23,805 - INFO - Сводка данных для BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        BTCUSDT    5          1728043200000 61449.83984375 61458.0    61448.98828125 61457.98828125 1.8829599618911743 115710.2578125 481        1.6337900161743164 100397.953125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726488000000        BTCUSDT    5          1726488000000 58664.0    58735.98828125 58642.0    58718.0    33.45286178588867 1963466.625 7261       20.301000595092773 1191636.0  12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:00:24,484 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:24,484 - INFO - ------------------------
2024-10-04 15:00:26,522 - INFO - Обновление данных для BTCUSDT с 1728042300001 до 1728043200000 (2024-10-04 11:45:00 до 2024-10-04 12:00:00)
2024-10-04 15:00:26,907 - INFO - Данные сохранены в data/BTCUSDT_15_data.csv
2024-10-04 15:00:27,543 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:27,544 - INFO - Сводка данных для BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        BTCUSDT    15         1728043200000 61449.83984375 61458.859375 61448.98828125 61458.8515625 1.9523299932479858 119973.609375 573        1.700569987297058 104502.1328125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724932800000        BTCUSDT    15         1724932800000 60067.05859375 60181.078125 59990.0    60084.0    265.12481689453125 15928289.0 36208      115.03851318359375 6911768.0  12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:00:28,185 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:00:28,186 - INFO - ------------------------
2024-10-04 15:00:29,186 - INFO - Все файлы обновлены с последними ценами.
2024-10-04 15:00:29,186 - INFO - Выполнение методов get_current_price и get_latest_prices для всех символов и интервалов.
2024-10-04 15:00:29,535 - INFO - Текущая цена для ETHUSDT (1):
    symbol  interval      timestamp         open         high          low        close     volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT         1  1728043200000  2386.199951  2386.800049  2386.120117  2386.800049  34.957901  ...                    26.143101                  62395.507812    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:00:29,570 - INFO - Последняя цена для ETHUSDT (1):
      symbol  interval      timestamp     open     high      low    close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
1    ETHUSDT         1  1728043200000  2386.20  2386.35  2386.12  2386.34    1.7990           4292.9033               240                       1.6310                      3892.021    12          1  1.224647e-16 -1.000000  0.781832  0.62349
7    ETHUSDT         1  1728043140000  2386.28  2386.28  2386.10  2386.20   31.7343          75723.2600               283                      11.8898                     28370.477    11          1  2.588190e-01 -0.965926  0.781832  0.62349
8    ETHUSDT         1  1728043080000  2385.66  2386.49  2385.66  2386.28   98.3319         234619.6600              1137                      81.8802                    195358.860    11          1  2.588190e-01 -0.965926  0.781832  0.62349
11   ETHUSDT         1  1728043020000  2384.39  2384.75  2384.39  2384.75   14.2419          33960.1050               345                      10.2421                     24422.209    11          1  2.588190e-01 -0.965926  0.781832  0.62349
13   ETHUSDT         1  1728042960000  2383.53  2384.90  2383.53  2384.33   52.9370         126222.0300              1423                      20.0961                     47915.880    11          1  2.588190e-01 -0.965926  0.781832  0.62349
..       ...       ...            ...      ...      ...      ...      ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
749  ETHUSDT         1  1728025500000  2374.30  2375.39  2373.36  2375.00  146.0864         346940.8400              1930                      44.4055                    105446.945     7          1  9.659258e-01 -0.258819  0.781832  0.62349
753  ETHUSDT         1  1728025440000  2374.05  2375.60  2374.04  2374.31  250.7246         595512.5000              1819                      61.1207                    145158.720     7          1  9.659258e-01 -0.258819  0.781832  0.62349
754  ETHUSDT         1  1728025380000  2372.96  2374.56  2372.84  2374.04   70.2416         166748.8100              2603                      52.6047                    124878.110     7          1  9.659258e-01 -0.258819  0.781832  0.62349
757  ETHUSDT         1  1728025320000  2372.88  2374.17  2372.88  2372.96   38.5711          91549.9140              1956                      15.0495                     35719.426     7          1  9.659258e-01 -0.258819  0.781832  0.62349
758  ETHUSDT         1  1728025260000  2372.79  2373.49  2371.81  2372.88  126.1013         299212.2000              3257                      55.1933                    130967.875     7          1  9.659258e-01 -0.258819  0.781832  0.62349

[300 rows x 18 columns]
2024-10-04 15:00:30,928 - INFO - Текущая цена для ETHUSDT (5):
    symbol  interval      timestamp         open         high          low        close   volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT         5  1728043200000  2386.199951  2386.800049  2386.120117  2386.790039  34.9603  ...                    26.143101                  62395.507812    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:00:30,961 - INFO - Последняя цена для ETHUSDT (5):
       symbol  interval      timestamp     open     high      low    close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0     ETHUSDT         5  1728043200000  2386.20  2386.72  2386.12  2386.72   10.6905           25512.998               573                       8.3018                     19811.950    12          1  1.224647e-16 -1.000000  0.781832  0.62349
14    ETHUSDT         5  1728042900000  2385.91  2385.98  2383.53  2384.75  176.2637          420376.700              2717                      43.9279                    104751.734    11          1  2.588190e-01 -0.965926  0.781832  0.62349
28    ETHUSDT         5  1728042600000  2384.43  2386.49  2384.00  2385.90  299.4295          714257.300              5393                     160.4486                    382737.660    11          1  2.588190e-01 -0.965926  0.781832  0.62349
39    ETHUSDT         5  1728042300000  2380.61  2384.44  2380.60  2384.44  313.4434          746995.600              4078                     182.0606                    433836.750    11          1  2.588190e-01 -0.965926  0.781832  0.62349
52    ETHUSDT         5  1728042000000  2380.01  2381.46  2379.44  2380.61  194.1151          462134.060              4769                      67.8168                    161456.730    11          1  2.588190e-01 -0.965926  0.781832  0.62349
...       ...       ...            ...      ...      ...      ...      ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
3741  ETHUSDT         5  1727954700000  2354.21  2359.81  2353.98  2356.42  558.1958         1315416.600              7998                     321.8039                    758301.300    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3752  ETHUSDT         5  1727954400000  2362.11  2362.66  2353.51  2354.20  892.8825         2106367.200             11280                     322.1513                    759926.200    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3763  ETHUSDT         5  1727954100000  2366.41  2366.58  2360.52  2362.12  843.7156         1994248.900             10288                     222.5167                    525804.900    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3777  ETHUSDT         5  1727953800000  2366.99  2368.66  2365.15  2366.41  896.8899         2122980.000             10367                     258.4522                    611628.500    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3788  ETHUSDT         5  1727953500000  2368.54  2368.95  2365.38  2366.98  647.3448         1532096.400             15807                     236.3631                    559341.500    11          0  2.588190e-01 -0.965926  0.000000  1.00000

[300 rows x 18 columns]
2024-10-04 15:00:32,312 - INFO - Текущая цена для ETHUSDT (15):
    symbol  interval      timestamp         open         high          low        close   volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT        15  1728043200000  2386.199951  2386.800049  2386.120117  2386.790039  45.5242  ...                    36.623402                  87409.882812    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:00:32,343 - INFO - Последняя цена для ETHUSDT (15):
        symbol  interval      timestamp     open     high      low    close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day   cos_day
3      ETHUSDT        15  1728043200000  2386.20  2386.80  2386.12  2386.80    13.3178            31783.78               624                      10.7757                     25716.596    12          1  1.224647e-16 -1.000000  0.781832  0.623490
42     ETHUSDT        15  1728042300000  2380.61  2386.49  2380.60  2384.76   789.9527          1883575.90             12194                     387.0750                    922847.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
76     ETHUSDT        15  1728041400000  2378.91  2382.00  2378.00  2380.61  1123.2635          2672941.80             14413                     640.7400                   1524555.100    11          1  2.588190e-01 -0.965926  0.781832  0.623490
116    ETHUSDT        15  1728040500000  2379.25  2382.84  2378.21  2378.90  1108.7366          2639710.50             14342                     600.4699                   1429835.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
154    ETHUSDT        15  1728039600000  2375.17  2379.62  2374.21  2379.24   785.0437          1865993.90             17167                     421.3286                   1001540.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
...        ...       ...            ...      ...      ...      ...      ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...       ...
11212  ETHUSDT        15  1727777700000  2632.99  2636.86  2631.59  2635.40  2006.5388          5284911.50             16870                     595.3239                   1568155.500    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11252  ETHUSDT        15  1727776800000  2635.19  2637.50  2632.07  2632.99  2018.0824          5316706.00             16263                     733.5127                   1932551.400    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11288  ETHUSDT        15  1727775900000  2637.69  2640.00  2634.65  2635.18  1250.7848          3299279.80             10756                     440.6499                   1162381.600     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11325  ETHUSDT        15  1727775000000  2642.88  2643.25  2636.82  2637.69  2026.0142          5348170.50              9969                     707.4836                   1867484.400     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11364  ETHUSDT        15  1727774100000  2644.86  2645.47  2640.00  2642.87  1630.5599          4308992.50             14437                     794.3692                   2099262.800     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521

[300 rows x 18 columns]
2024-10-04 15:00:33,698 - INFO - Текущая цена для BTCUSDT (1):
    symbol  interval      timestamp          open          high           low         close   volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT         1  1728043200000  61449.839844  61458.859375  61448.988281  61458.851562  2.17407  ...                      1.78327                  109584.78125    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:00:33,730 - INFO - Последняя цена для BTCUSDT (1):
      symbol  interval      timestamp      open      high       low     close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
4    BTCUSDT         1  1728043200000  61449.84  61458.00  61448.99  61458.00   1.69865           104382.94               452                      1.53040                     94043.810    12          1  1.224647e-16 -1.000000  0.781832  0.62349
6    BTCUSDT         1  1728043140000  61453.41  61453.42  61448.86  61449.84   2.47051           151813.16               343                      0.61908                     38041.945    11          1  2.588190e-01 -0.965926  0.781832  0.62349
9    BTCUSDT         1  1728043080000  61440.00  61465.69  61440.00  61453.41  23.53464          1446280.90              1299                     20.53227                   1261756.200    11          1  2.588190e-01 -0.965926  0.781832  0.62349
10   BTCUSDT         1  1728043020000  61407.99  61440.00  61407.99  61440.00   3.33551           204875.55              1255                      2.90552                    178465.500    11          1  2.588190e-01 -0.965926  0.781832  0.62349
12   BTCUSDT         1  1728042960000  61400.01  61420.00  61400.00  61407.99  10.58171           649807.10              2073                      6.09294                    374137.160    11          1  2.588190e-01 -0.965926  0.781832  0.62349
..       ...       ...            ...       ...       ...       ...       ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
751  BTCUSDT         1  1728025500000  61137.51  61158.00  61126.58  61157.99   2.89088           176742.17              1611                      1.39269                     85146.370     7          1  9.659258e-01 -0.258819  0.781832  0.62349
752  BTCUSDT         1  1728025440000  61120.69  61160.00  61120.69  61137.58  10.45818           639489.90              2130                      7.49281                    458167.160     7          1  9.659258e-01 -0.258819  0.781832  0.62349
755  BTCUSDT         1  1728025380000  61098.53  61126.44  61098.52  61120.69   4.44222           271497.53              1779                      2.11950                    129534.230     7          1  9.659258e-01 -0.258819  0.781832  0.62349
756  BTCUSDT         1  1728025320000  61090.00  61111.61  61090.00  61098.52   7.39564           451889.03              2170                      3.97650                    242969.060     7          1  9.659258e-01 -0.258819  0.781832  0.62349
759  BTCUSDT         1  1728025260000  61078.04  61100.00  61068.00  61090.00   9.06973           554029.94              3636                      2.33557                    142656.160     7          1  9.659258e-01 -0.258819  0.781832  0.62349

[300 rows x 18 columns]
2024-10-04 15:00:35,820 - INFO - Текущая цена для BTCUSDT (5):
    symbol  interval      timestamp          open          high           low         close   volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT         5  1728043200000  61449.839844  61458.859375  61448.988281  61458.851562  2.17653  ...                      1.78416                 109639.476562    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:00:35,852 - INFO - Последняя цена для BTCUSDT (5):
       symbol  interval      timestamp      open      high       low     close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
2     BTCUSDT         5  1728043200000  61449.84  61458.00  61448.99  61457.99    1.88296           115710.26               481                      1.63379                     100397.95    12          1  1.224647e-16 -1.000000  0.781832  0.62349
17    BTCUSDT         5  1728042900000  61456.00  61456.00  61400.00  61440.00   27.13787          1666718.80              4187                      9.88309                     606960.20    11          1  2.588190e-01 -0.965926  0.781832  0.62349
27    BTCUSDT         5  1728042600000  61465.50  61483.02  61449.70  61456.00   53.31801          3277459.00              6016                     36.07981                    2217850.20    11          1  2.588190e-01 -0.965926  0.781832  0.62349
41    BTCUSDT         5  1728042300000  61394.02  61469.00  61394.01  61465.50   26.63522          1636691.80              5554                     20.24487                    1243993.10    11          1  2.588190e-01 -0.965926  0.781832  0.62349
55    BTCUSDT         5  1728042000000  61359.16  61420.00  61357.16  61394.02   18.31383          1124324.40              4397                     11.14375                     684145.40    11          1  2.588190e-01 -0.965926  0.781832  0.62349
...       ...       ...            ...       ...       ...       ...       ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
3740  BTCUSDT         5  1727954700000  60689.02  60794.72  60679.94  60722.05   82.29679          4998126.50             12327                     16.69351                    1013791.94    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3751  BTCUSDT         5  1727954400000  60900.00  60905.97  60679.92  60689.02  154.58961          9396492.00             15268                     42.05248                    2555546.20    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3764  BTCUSDT         5  1727954100000  61001.16  61001.17  60900.00  60900.00   49.87969          3039922.50             11046                     13.88404                     846243.25    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3779  BTCUSDT         5  1727953800000  61025.10  61050.41  60994.00  61001.16   23.14982          1412495.80             10519                     12.24533                     747177.75    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3789  BTCUSDT         5  1727953500000  61008.01  61030.31  60991.46  61025.10   30.62289          1868202.90             14827                     18.52064                    1129880.90    11          0  2.588190e-01 -0.965926  0.000000  1.00000

[300 rows x 18 columns]
2024-10-04 15:00:37,200 - INFO - Текущая цена для BTCUSDT (15):
    symbol  interval      timestamp          open          high           low         close   volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT        15  1728043200000  61449.839844  61458.859375  61448.988281  61458.859375  2.19235  ...                      1.79938                 110574.882812    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:00:37,231 - INFO - Последняя цена для BTCUSDT (15):
        symbol  interval      timestamp      open      high       low     close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day   cos_day
5      BTCUSDT        15  1728043200000  61449.84  61458.86  61448.99  61458.85    1.95233           119973.61               573                      1.70057                     104502.13    12          1  1.224647e-16 -1.000000  0.781832  0.623490
40     BTCUSDT        15  1728042300000  61394.02  61483.02  61394.01  61439.99  107.23911          6589963.00             15779                     66.35461                    4077825.50    11          1  2.588190e-01 -0.965926  0.781832  0.623490
78     BTCUSDT        15  1728041400000  61320.32  61420.00  61301.75  61394.02  130.54375          8009725.00             22083                     73.86198                    4532674.50    11          1  2.588190e-01 -0.965926  0.781832  0.623490
115    BTCUSDT        15  1728040500000  61411.99  61460.00  61320.31  61320.31  235.35864         14443928.00             19323                     38.81200                    2383073.20    11          1  2.588190e-01 -0.965926  0.781832  0.623490
153    BTCUSDT        15  1728039600000  61284.01  61420.00  61274.00  61411.99   87.25890          5352607.50             21776                     52.50074                    3220560.50    11          1  2.588190e-01 -0.965926  0.781832  0.623490
...        ...       ...            ...       ...       ...       ...       ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...       ...
11211  BTCUSDT        15  1727777700000  63753.91  63871.44  63750.00  63850.00  100.80818          6433290.50             20646                     54.13152                    3454072.00    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11249  BTCUSDT        15  1727776800000  63864.47  63892.39  63707.89  63753.91  275.74530         17594600.00             25454                     88.56388                    5651176.00    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11290  BTCUSDT        15  1727775900000  63943.54  63964.00  63864.46  63864.46  111.21354          7110134.50             12441                     48.73248                    3115494.50     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11328  BTCUSDT        15  1727775000000  64058.00  64058.01  63941.32  63943.54  111.65746          7145016.00             15286                     33.55119                    2146673.50     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11365  BTCUSDT        15  1727774100000  64086.78  64088.76  64002.10  64058.00  148.36633          9502988.00             19282                     63.49062                    4066586.80     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521

[300 rows x 18 columns]
2024-10-04 15:00:38,231 - INFO - Завершено.
2024-10-04 15:00:38,268 - INFO - Latest dataset loaded with 300 records.
2024-10-04 15:00:38,270 - INFO - Порядок столбцов после transform: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:00:38,270 - INFO - Типы данных после transform:
2024-10-04 15:00:38,270 - INFO - symbol                            int64
interval                          int64
timestamp                         int64
open                            float32
high                            float32
low                             float32
close                           float32
volume                          float32
quote_asset_volume              float32
number_of_trades                  int64
taker_buy_base_asset_volume     float32
taker_buy_quote_asset_volume    float32
hour                              int64
dayofweek                         int64
sin_hour                        float32
cos_hour                        float32
sin_day                         float32
cos_day                         float32
dtype: object
2024-10-04 15:00:38,351 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 15:00:38,353 - INFO - Logging is set up.
2024-10-04 15:00:38,353 - INFO - Используемое устройство: cuda
2024-10-04 15:00:38,353 - INFO - DataProcessor загружен: models/data_processor_ETHUSDT_v2.0.pkl
2024-10-04 15:00:38,390 - INFO - Комбинированные данные загружены из data/combined_dataset.csv
2024-10-04 15:00:38,417 - INFO - Порядок столбцов после transform: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:00:38,417 - INFO - Типы данных после transform:
2024-10-04 15:00:38,417 - INFO - symbol                            int64
interval                          int64
timestamp                         int64
open                            float32
high                            float32
low                             float32
close                           float32
volume                          float32
quote_asset_volume              float32
number_of_trades                  int64
taker_buy_base_asset_volume     float32
taker_buy_quote_asset_volume    float32
hour                              int64
dayofweek                         int64
sin_hour                        float32
cos_hour                        float32
sin_day                         float32
cos_day                         float32
dtype: object
2024-10-04 15:00:38,417 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:00:38,418 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:00:38,590 - INFO - Оптимизатор загружен из models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:00:38,590 - INFO - Модель загружена из models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 15:01:00,316 - INFO - Epoch 1/5 - Loss: 8540045922108.9521
2024-10-04 15:01:00,400 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:01:00,400 - INFO - Validation loss improved to 8540045922108.9521. Model saved.
2024-10-04 15:01:22,197 - INFO - Epoch 2/5 - Loss: 8540763591241.1426
2024-10-04 15:01:22,197 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:01:22,197 - INFO - Reducing learning rate to: 0.00025
2024-10-04 15:01:44,045 - INFO - Epoch 3/5 - Loss: 8531872615472.7617
2024-10-04 15:01:44,133 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:01:44,133 - INFO - Validation loss improved to 8531872615472.7617. Model saved.
2024-10-04 15:02:05,243 - INFO - Epoch 4/5 - Loss: 8558023326963.8096
2024-10-04 15:02:05,244 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:02:05,244 - INFO - Reducing learning rate to: 0.000125
2024-10-04 15:02:27,127 - INFO - Epoch 5/5 - Loss: 8555726571812.5713
2024-10-04 15:02:27,127 - INFO - No improvement in validation loss. (2/5)
2024-10-04 15:02:27,127 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 15:02:27,128 - INFO - Скрипт запущен
2024-10-04 15:02:27,491 - INFO - Binance API доступен. Время сервера: 2024-10-04 12:02:27
2024-10-04 15:02:28,554 - INFO - Обновление данных для ETHUSDT с 1728043200001 до 1728043320000 (2024-10-04 12:00:00 до 2024-10-04 12:02:00)
2024-10-04 15:02:29,027 - INFO - Данные сохранены в data/ETHUSDT_1_data.csv
2024-10-04 15:02:29,684 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:02:29,684 - INFO - Сводка данных для ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043320000        ETHUSDT    1          1728043320000 2386.429931640625 2387.0     2385.330078125 2385.7099609375 69.83499908447266 166666.265625 1260       17.60140037536621 41999.23828125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727265480000        ETHUSDT    1          1727265480000 2627.39990234375 2627.89990234375 2627.39990234375 2627.820068359375 76.50299835205078 201012.703125 842        67.06340026855469 176209.25  11         6          0.258819043636322 -0.9659258127212524 -0.7818315029144287 0.6234897971153259

2024-10-04 15:02:30,334 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:02:30,334 - INFO - ------------------------
2024-10-04 15:02:31,685 - INFO - Данные для ETHUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:02:31,685 - INFO - Сводка данных для ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        ETHUSDT    5          1728043200000 2386.199951171875 2386.719970703125 2386.1201171875 2386.719970703125 10.690500259399414 25512.998046875 573        8.301799774169922 19811.94921875 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726488000000        ETHUSDT    5          1726488000000 2307.800048828125 2310.610107421875 2306.60009765625 2309.989990234375 749.1240234375 1729554.25 5211       555.8009033203125 1283180.625 12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:02:32,349 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:02:32,350 - INFO - ------------------------
2024-10-04 15:02:33,699 - INFO - Данные для ETHUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:02:33,699 - INFO - Сводка данных для ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        ETHUSDT    15         1728043200000 2386.199951171875 2386.800048828125 2386.1201171875 2386.800048828125 13.31779956817627 31783.779296875 624        10.775699615478516 25716.595703125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724932800000        ETHUSDT    15         1724932800000 2555.199951171875 2558.4599609375 2552.139892578125 2556.7900390625 1688.5289306640625 4314773.5  17545      720.7266845703125 1841737.125 12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:02:34,342 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:02:34,342 - INFO - ------------------------
2024-10-04 15:02:36,389 - INFO - Обновление данных для BTCUSDT с 1728043200001 до 1728043320000 (2024-10-04 12:00:00 до 2024-10-04 12:02:00)
2024-10-04 15:02:36,893 - INFO - Данные сохранены в data/BTCUSDT_1_data.csv
2024-10-04 15:02:37,540 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:02:37,541 - INFO - Сводка данных для BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043320000        BTCUSDT    1          1728043320000 61476.55078125 61502.69921875 61468.359375 61478.171875 19.390039443969727 1192304.5  2793       14.02987003326416 862758.9375 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727265480000        BTCUSDT    1          1727265480000 63842.640625 63848.0    63838.0    63838.0    4.534259796142578 289491.6875 912        3.17549991607666 202743.3125 11         6          0.258819043636322 -0.9659258127212524 -0.7818315029144287 0.6234897971153259

2024-10-04 15:02:38,186 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:02:38,187 - INFO - ------------------------
2024-10-04 15:02:39,545 - INFO - Данные для BTCUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:02:39,545 - INFO - Сводка данных для BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        BTCUSDT    5          1728043200000 61449.83984375 61458.0    61448.98828125 61457.98828125 1.8829599618911743 115710.2578125 481        1.6337900161743164 100397.953125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726488000000        BTCUSDT    5          1726488000000 58664.0    58735.98828125 58642.0    58718.0    33.45286178588867 1963466.625 7261       20.301000595092773 1191636.0  12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:02:40,217 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:02:40,217 - INFO - ------------------------
2024-10-04 15:02:41,562 - INFO - Данные для BTCUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:02:41,563 - INFO - Сводка данных для BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        BTCUSDT    15         1728043200000 61449.83984375 61458.859375 61448.98828125 61458.8515625 1.9523299932479858 119973.609375 573        1.700569987297058 104502.1328125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724932800000        BTCUSDT    15         1724932800000 60067.05859375 60181.078125 59990.0    60084.0    265.12481689453125 15928289.0 36208      115.03851318359375 6911768.0  12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:02:42,222 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:02:42,222 - INFO - ------------------------
2024-10-04 15:02:43,222 - INFO - Все файлы обновлены с последними ценами.
2024-10-04 15:02:43,223 - INFO - Выполнение методов get_current_price и get_latest_prices для всех символов и интервалов.
2024-10-04 15:02:43,574 - INFO - Текущая цена для ETHUSDT (1):
    symbol  interval      timestamp         open    high          low        close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT         1  1728043320000  2386.429932  2387.0  2385.330078  2385.590088  78.198601       186618.484375              1324                      24.4555                  58350.378906    12          1  1.224647e-16      -1.0  0.781832  0.62349
2024-10-04 15:02:43,608 - INFO - Последняя цена для ETHUSDT (1):
      symbol  interval      timestamp     open     high      low    close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0    ETHUSDT         1  1728043320000  2386.43  2387.00  2385.33  2385.71   69.8350         166666.2700              1260                      17.6014                     41999.240    12          1  1.224647e-16 -1.000000  0.781832  0.62349
3    ETHUSDT         1  1728043260000  2386.00  2386.42  2385.26  2386.42   62.1799         148348.3400              1185                      35.5650                     84850.890    12          1  1.224647e-16 -1.000000  0.781832  0.62349
6    ETHUSDT         1  1728043200000  2386.20  2386.35  2386.12  2386.34    1.7990           4292.9033               240                       1.6310                      3892.021    12          1  1.224647e-16 -1.000000  0.781832  0.62349
11   ETHUSDT         1  1728043140000  2386.28  2386.28  2386.10  2386.20   31.7343          75723.2600               283                      11.8898                     28370.477    11          1  2.588190e-01 -0.965926  0.781832  0.62349
12   ETHUSDT         1  1728043080000  2385.66  2386.49  2385.66  2386.28   98.3319         234619.6600              1137                      81.8802                    195358.860    11          1  2.588190e-01 -0.965926  0.781832  0.62349
..       ...       ...            ...      ...      ...      ...      ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
748  ETHUSDT         1  1728025620000  2374.91  2375.40  2374.58  2374.98  222.3166         528022.8000              1244                     113.6747                    269976.200     7          1  9.659258e-01 -0.258819  0.781832  0.62349
751  ETHUSDT         1  1728025560000  2375.00  2375.19  2374.00  2374.90  194.2533         461271.2000               844                      50.8504                    120737.580     7          1  9.659258e-01 -0.258819  0.781832  0.62349
754  ETHUSDT         1  1728025500000  2374.30  2375.39  2373.36  2375.00  146.0864         346940.8400              1930                      44.4055                    105446.945     7          1  9.659258e-01 -0.258819  0.781832  0.62349
757  ETHUSDT         1  1728025440000  2374.05  2375.60  2374.04  2374.31  250.7246         595512.5000              1819                      61.1207                    145158.720     7          1  9.659258e-01 -0.258819  0.781832  0.62349
759  ETHUSDT         1  1728025380000  2372.96  2374.56  2372.84  2374.04   70.2416         166748.8100              2603                      52.6047                    124878.110     7          1  9.659258e-01 -0.258819  0.781832  0.62349

[300 rows x 18 columns]
2024-10-04 15:02:44,960 - INFO - Текущая цена для ETHUSDT (5):
    symbol  interval      timestamp         open    high         low        close      volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT         5  1728043200000  2386.199951  2387.0  2385.26001  2385.600098  228.090698         544296.9375              4649                   115.522202                      275660.5    12          1  1.224647e-16      -1.0  0.781832  0.62349
2024-10-04 15:02:44,992 - INFO - Последняя цена для ETHUSDT (5):
       symbol  interval      timestamp     open     high      low    close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
4     ETHUSDT         5  1728043200000  2386.20  2386.72  2386.12  2386.72   10.6905           25512.998               573                       8.3018                     19811.950    12          1  1.224647e-16 -1.000000  0.781832  0.62349
21    ETHUSDT         5  1728042900000  2385.91  2385.98  2383.53  2384.75  176.2637          420376.700              2717                      43.9279                    104751.734    11          1  2.588190e-01 -0.965926  0.781832  0.62349
30    ETHUSDT         5  1728042600000  2384.43  2386.49  2384.00  2385.90  299.4295          714257.300              5393                     160.4486                    382737.660    11          1  2.588190e-01 -0.965926  0.781832  0.62349
47    ETHUSDT         5  1728042300000  2380.61  2384.44  2380.60  2384.44  313.4434          746995.600              4078                     182.0606                    433836.750    11          1  2.588190e-01 -0.965926  0.781832  0.62349
58    ETHUSDT         5  1728042000000  2380.01  2381.46  2379.44  2380.61  194.1151          462134.060              4769                      67.8168                    161456.730    11          1  2.588190e-01 -0.965926  0.781832  0.62349
...       ...       ...            ...      ...      ...      ...      ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
3744  ETHUSDT         5  1727954700000  2354.21  2359.81  2353.98  2356.42  558.1958         1315416.600              7998                     321.8039                    758301.300    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3754  ETHUSDT         5  1727954400000  2362.11  2362.66  2353.51  2354.20  892.8825         2106367.200             11280                     322.1513                    759926.200    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3771  ETHUSDT         5  1727954100000  2366.41  2366.58  2360.52  2362.12  843.7156         1994248.900             10288                     222.5167                    525804.900    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3780  ETHUSDT         5  1727953800000  2366.99  2368.66  2365.15  2366.41  896.8899         2122980.000             10367                     258.4522                    611628.500    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3792  ETHUSDT         5  1727953500000  2368.54  2368.95  2365.38  2366.98  647.3448         1532096.400             15807                     236.3631                    559341.500    11          0  2.588190e-01 -0.965926  0.000000  1.00000

[300 rows x 18 columns]
2024-10-04 15:02:46,343 - INFO - Текущая цена для ETHUSDT (15):
    symbol  interval      timestamp         open    high         low        close      volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT        15  1728043200000  2386.199951  2387.0  2385.26001  2385.600098  228.467499         545195.8125              4653                   115.808899                   276344.4375    12          1  1.224647e-16      -1.0  0.781832  0.62349
2024-10-04 15:02:46,375 - INFO - Последняя цена для ETHUSDT (15):
        symbol  interval      timestamp     open     high      low    close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day   cos_day
7      ETHUSDT        15  1728043200000  2386.20  2386.80  2386.12  2386.80    13.3178            31783.78               624                      10.7757                     25716.596    12          1  1.224647e-16 -1.000000  0.781832  0.623490
42     ETHUSDT        15  1728042300000  2380.61  2386.49  2380.60  2384.76   789.9527          1883575.90             12194                     387.0750                    922847.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
85     ETHUSDT        15  1728041400000  2378.91  2382.00  2378.00  2380.61  1123.2635          2672941.80             14413                     640.7400                   1524555.100    11          1  2.588190e-01 -0.965926  0.781832  0.623490
123    ETHUSDT        15  1728040500000  2379.25  2382.84  2378.21  2378.90  1108.7366          2639710.50             14342                     600.4699                   1429835.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
156    ETHUSDT        15  1728039600000  2375.17  2379.62  2374.21  2379.24   785.0437          1865993.90             17167                     421.3286                   1001540.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
...        ...       ...            ...      ...      ...      ...      ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...       ...
11214  ETHUSDT        15  1727777700000  2632.99  2636.86  2631.59  2635.40  2006.5388          5284911.50             16870                     595.3239                   1568155.500    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11256  ETHUSDT        15  1727776800000  2635.19  2637.50  2632.07  2632.99  2018.0824          5316706.00             16263                     733.5127                   1932551.400    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11292  ETHUSDT        15  1727775900000  2637.69  2640.00  2634.65  2635.18  1250.7848          3299279.80             10756                     440.6499                   1162381.600     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11331  ETHUSDT        15  1727775000000  2642.88  2643.25  2636.82  2637.69  2026.0142          5348170.50              9969                     707.4836                   1867484.400     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11367  ETHUSDT        15  1727774100000  2644.86  2645.47  2640.00  2642.87  1630.5599          4308992.50             14437                     794.3692                   2099262.800     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521

[300 rows x 18 columns]
2024-10-04 15:02:48,480 - INFO - Текущая цена для BTCUSDT (1):
    symbol  interval      timestamp          open          high           low         close   volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT         1  1728043320000  61476.550781  61502.699219  61468.359375  61478.179688  19.6196  ...                     14.10133                   867152.1875    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:02:48,514 - INFO - Последняя цена для BTCUSDT (1):
      symbol  interval      timestamp      open      high       low     close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
1    BTCUSDT         1  1728043320000  61476.55  61502.70  61468.36  61478.17  19.39004          1192304.50              2793                     14.02987                    862758.940    12          1  1.224647e-16 -1.000000  0.781832  0.62349
2    BTCUSDT         1  1728043260000  61446.55  61476.55  61438.00  61476.55   6.01110           369390.56              2176                      4.16825                    256148.920    12          1  1.224647e-16 -1.000000  0.781832  0.62349
9    BTCUSDT         1  1728043200000  61449.84  61458.00  61448.99  61458.00   1.69865           104382.94               452                      1.53040                     94043.810    12          1  1.224647e-16 -1.000000  0.781832  0.62349
10   BTCUSDT         1  1728043140000  61453.41  61453.42  61448.86  61449.84   2.47051           151813.16               343                      0.61908                     38041.945    11          1  2.588190e-01 -0.965926  0.781832  0.62349
13   BTCUSDT         1  1728043080000  61440.00  61465.69  61440.00  61453.41  23.53464          1446280.90              1299                     20.53227                   1261756.200    11          1  2.588190e-01 -0.965926  0.781832  0.62349
..       ...       ...            ...       ...       ...       ...       ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
749  BTCUSDT         1  1728025620000  61126.08  61129.67  61117.00  61129.60   2.60276           159092.78              1226                      0.73641                     45013.688     7          1  9.659258e-01 -0.258819  0.781832  0.62349
750  BTCUSDT         1  1728025560000  61158.00  61158.00  61122.98  61126.07  19.74179          1206983.20              1685                      4.57920                    279904.340     7          1  9.659258e-01 -0.258819  0.781832  0.62349
755  BTCUSDT         1  1728025500000  61137.51  61158.00  61126.58  61157.99   2.89088           176742.17              1611                      1.39269                     85146.370     7          1  9.659258e-01 -0.258819  0.781832  0.62349
756  BTCUSDT         1  1728025440000  61120.69  61160.00  61120.69  61137.58  10.45818           639489.90              2130                      7.49281                    458167.160     7          1  9.659258e-01 -0.258819  0.781832  0.62349
758  BTCUSDT         1  1728025380000  61098.53  61126.44  61098.52  61120.69   4.44222           271497.53              1779                      2.11950                    129534.230     7          1  9.659258e-01 -0.258819  0.781832  0.62349

[300 rows x 18 columns]
2024-10-04 15:02:49,869 - INFO - Текущая цена для BTCUSDT (5):
    symbol  interval      timestamp          open          high      low         close    volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT         5  1728043200000  61449.839844  61502.699219  61438.0  61478.179688  31.19519  ...                     21.40115                   1315757.875    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:02:49,902 - INFO - Последняя цена для BTCUSDT (5):
       symbol  interval      timestamp      open      high       low     close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
8     BTCUSDT         5  1728043200000  61449.84  61458.00  61448.99  61457.99    1.88296           115710.26               481                      1.63379                     100397.95    12          1  1.224647e-16 -1.000000  0.781832  0.62349
20    BTCUSDT         5  1728042900000  61456.00  61456.00  61400.00  61440.00   27.13787          1666718.80              4187                      9.88309                     606960.20    11          1  2.588190e-01 -0.965926  0.781832  0.62349
33    BTCUSDT         5  1728042600000  61465.50  61483.02  61449.70  61456.00   53.31801          3277459.00              6016                     36.07981                    2217850.20    11          1  2.588190e-01 -0.965926  0.781832  0.62349
46    BTCUSDT         5  1728042300000  61394.02  61469.00  61394.01  61465.50   26.63522          1636691.80              5554                     20.24487                    1243993.10    11          1  2.588190e-01 -0.965926  0.781832  0.62349
57    BTCUSDT         5  1728042000000  61359.16  61420.00  61357.16  61394.02   18.31383          1124324.40              4397                     11.14375                     684145.40    11          1  2.588190e-01 -0.965926  0.781832  0.62349
...       ...       ...            ...       ...       ...       ...       ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
3743  BTCUSDT         5  1727954700000  60689.02  60794.72  60679.94  60722.05   82.29679          4998126.50             12327                     16.69351                    1013791.94    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3756  BTCUSDT         5  1727954400000  60900.00  60905.97  60679.92  60689.02  154.58961          9396492.00             15268                     42.05248                    2555546.20    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3768  BTCUSDT         5  1727954100000  61001.16  61001.17  60900.00  60900.00   49.87969          3039922.50             11046                     13.88404                     846243.25    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3782  BTCUSDT         5  1727953800000  61025.10  61050.41  60994.00  61001.16   23.14982          1412495.80             10519                     12.24533                     747177.75    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3793  BTCUSDT         5  1727953500000  61008.01  61030.31  60991.46  61025.10   30.62289          1868202.90             14827                     18.52064                    1129880.90    11          0  2.588190e-01 -0.965926  0.000000  1.00000

[300 rows x 18 columns]
2024-10-04 15:02:51,254 - INFO - Текущая цена для BTCUSDT (15):
    symbol  interval      timestamp          open          high      low         close     volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT        15  1728043200000  61449.839844  61502.699219  61438.0  61478.988281  31.270041  ...                    21.474689                     1320279.0    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:02:51,286 - INFO - Последняя цена для BTCUSDT (15):
        symbol  interval      timestamp      open      high       low     close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day   cos_day
5      BTCUSDT        15  1728043200000  61449.84  61458.86  61448.99  61458.85    1.95233           119973.61               573                      1.70057                     104502.13    12          1  1.224647e-16 -1.000000  0.781832  0.623490
43     BTCUSDT        15  1728042300000  61394.02  61483.02  61394.01  61439.99  107.23911          6589963.00             15779                     66.35461                    4077825.50    11          1  2.588190e-01 -0.965926  0.781832  0.623490
81     BTCUSDT        15  1728041400000  61320.32  61420.00  61301.75  61394.02  130.54375          8009725.00             22083                     73.86198                    4532674.50    11          1  2.588190e-01 -0.965926  0.781832  0.623490
119    BTCUSDT        15  1728040500000  61411.99  61460.00  61320.31  61320.31  235.35864         14443928.00             19323                     38.81200                    2383073.20    11          1  2.588190e-01 -0.965926  0.781832  0.623490
161    BTCUSDT        15  1728039600000  61284.01  61420.00  61274.00  61411.99   87.25890          5352607.50             21776                     52.50074                    3220560.50    11          1  2.588190e-01 -0.965926  0.781832  0.623490
...        ...       ...            ...       ...       ...       ...       ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...       ...
11216  BTCUSDT        15  1727777700000  63753.91  63871.44  63750.00  63850.00  100.80818          6433290.50             20646                     54.13152                    3454072.00    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11254  BTCUSDT        15  1727776800000  63864.47  63892.39  63707.89  63753.91  275.74530         17594600.00             25454                     88.56388                    5651176.00    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11291  BTCUSDT        15  1727775900000  63943.54  63964.00  63864.46  63864.46  111.21354          7110134.50             12441                     48.73248                    3115494.50     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11330  BTCUSDT        15  1727775000000  64058.00  64058.01  63941.32  63943.54  111.65746          7145016.00             15286                     33.55119                    2146673.50     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11366  BTCUSDT        15  1727774100000  64086.78  64088.76  64002.10  64058.00  148.36633          9502988.00             19282                     63.49062                    4066586.80     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521

[300 rows x 18 columns]
2024-10-04 15:02:52,287 - INFO - Завершено.
2024-10-04 15:02:52,315 - INFO - Latest dataset loaded with 300 records.
2024-10-04 15:02:52,317 - INFO - Порядок столбцов после transform: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:02:52,317 - INFO - Типы данных после transform:
2024-10-04 15:02:52,317 - INFO - symbol                            int64
interval                          int64
timestamp                         int64
open                            float32
high                            float32
low                             float32
close                           float32
volume                          float32
quote_asset_volume              float32
number_of_trades                  int64
taker_buy_base_asset_volume     float32
taker_buy_quote_asset_volume    float32
hour                              int64
dayofweek                         int64
sin_hour                        float32
cos_hour                        float32
sin_day                         float32
cos_day                         float32
dtype: object
2024-10-04 15:02:52,392 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 15:02:52,393 - INFO - Logging is set up.
2024-10-04 15:02:52,394 - INFO - Используемое устройство: cuda
2024-10-04 15:02:52,394 - INFO - DataProcessor загружен: models/data_processor_ETHUSDT_v2.0.pkl
2024-10-04 15:02:52,429 - INFO - Комбинированные данные загружены из data/combined_dataset.csv
2024-10-04 15:02:52,453 - INFO - Порядок столбцов после transform: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:02:52,453 - INFO - Типы данных после transform:
2024-10-04 15:02:52,453 - INFO - symbol                            int64
interval                          int64
timestamp                         int64
open                            float32
high                            float32
low                             float32
close                           float32
volume                          float32
quote_asset_volume              float32
number_of_trades                  int64
taker_buy_base_asset_volume     float32
taker_buy_quote_asset_volume    float32
hour                              int64
dayofweek                         int64
sin_hour                        float32
cos_hour                        float32
sin_day                         float32
cos_day                         float32
dtype: object
2024-10-04 15:02:52,454 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:02:52,454 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:02:52,625 - INFO - Оптимизатор загружен из models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:02:52,625 - INFO - Модель загружена из models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 15:03:14,271 - INFO - Epoch 1/5 - Loss: 8545222053692.9521
2024-10-04 15:03:14,357 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:03:14,357 - INFO - Validation loss improved to 8545222053692.9521. Model saved.
2024-10-04 15:03:36,177 - INFO - Epoch 2/5 - Loss: 8546271511308.1904
2024-10-04 15:03:36,177 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:03:36,178 - INFO - Reducing learning rate to: 0.00025
2024-10-04 15:03:58,114 - INFO - Epoch 3/5 - Loss: 8537285945246.4766
2024-10-04 15:03:58,198 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:03:58,198 - INFO - Validation loss improved to 8537285945246.4766. Model saved.
2024-10-04 15:04:19,195 - INFO - Epoch 4/5 - Loss: 8543428779641.9043
2024-10-04 15:04:19,195 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:04:19,195 - INFO - Reducing learning rate to: 0.000125
2024-10-04 15:04:41,260 - INFO - Epoch 5/5 - Loss: 8540553405586.2861
2024-10-04 15:04:41,260 - INFO - No improvement in validation loss. (2/5)
2024-10-04 15:04:41,261 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 15:04:41,261 - INFO - Скрипт запущен
2024-10-04 15:04:41,698 - INFO - Binance API доступен. Время сервера: 2024-10-04 12:04:41
2024-10-04 15:04:42,744 - INFO - Обновление данных для ETHUSDT с 1728043320001 до 1728043440000 (2024-10-04 12:02:00 до 2024-10-04 12:04:00)
2024-10-04 15:04:47,147 - INFO - Logging is set up.
2024-10-04 15:04:47,147 - INFO - Используемое устройство: cuda
2024-10-04 15:04:47,147 - INFO - DataProcessor загружен: models/data_processor_ETHUSDT_v2.0.pkl
2024-10-04 15:04:47,192 - INFO - Комбинированные данные загружены из data/combined_dataset.csv
2024-10-04 15:04:47,222 - INFO - Порядок столбцов после transform: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:04:47,222 - INFO - Типы данных после transform:
2024-10-04 15:04:47,222 - INFO - symbol                            int64
interval                          int64
timestamp                         int64
open                            float32
high                            float32
low                             float32
close                           float32
volume                          float32
quote_asset_volume              float32
number_of_trades                  int64
taker_buy_base_asset_volume     float32
taker_buy_quote_asset_volume    float32
hour                              int64
dayofweek                         int64
sin_hour                        float32
cos_hour                        float32
sin_day                         float32
cos_day                         float32
dtype: object
2024-10-04 15:04:47,223 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:04:47,223 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:04:47,755 - INFO - Оптимизатор загружен из models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:04:47,755 - INFO - Модель загружена из models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 15:05:34,286 - INFO - Logging is set up.
2024-10-04 15:05:34,286 - INFO - Используемое устройство: cuda
2024-10-04 15:05:34,286 - INFO - Numerical columns for scaling: ['open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:05:34,286 - INFO - Categorical columns: ['symbol', 'interval']
2024-10-04 15:05:34,330 - INFO - Комбинированные данные загружены из data/combined_dataset.csv
2024-10-04 15:05:34,358 - INFO - Порядок столбцов после fit_transform: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:05:34,360 - INFO - DataProcessor сохранен: models/data_processor_ETHUSDT_v2.0.pkl
2024-10-04 15:05:34,360 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:05:34,360 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:05:34,906 - WARNING - Файл модели models/enhanced_bilstm_model_ETHUSDT_v2.0.pth не найден. Будет создана новая модель.
2024-10-04 15:05:56,677 - INFO - Epoch 1/5 - Loss: 8541791771501.7139
2024-10-04 15:05:56,750 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:05:56,750 - INFO - Validation loss improved to 8541791771501.7139. Model saved.
2024-10-04 15:06:18,739 - INFO - Epoch 2/5 - Loss: 8535212036681.1426
2024-10-04 15:06:18,825 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:06:18,825 - INFO - Validation loss improved to 8535212036681.1426. Model saved.
2024-10-04 15:06:40,683 - INFO - Epoch 3/5 - Loss: 8537930911548.9521
2024-10-04 15:06:40,683 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:06:40,683 - INFO - Reducing learning rate to: 0.00025
2024-10-04 15:07:01,689 - INFO - Epoch 4/5 - Loss: 8535653022963.8096
2024-10-04 15:07:01,689 - INFO - No improvement in validation loss. (2/5)
2024-10-04 15:07:01,689 - INFO - Reducing learning rate to: 0.000125
2024-10-04 15:07:23,780 - INFO - Epoch 5/5 - Loss: 8594974889301.3330
2024-10-04 15:07:23,780 - INFO - No improvement in validation loss. (3/5)
2024-10-04 15:07:23,780 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 15:07:23,780 - INFO - Скрипт запущен
2024-10-04 15:07:24,213 - INFO - Binance API доступен. Время сервера: 2024-10-04 12:07:24
2024-10-04 15:07:25,301 - INFO - Обновление данных для ETHUSDT с 1728043320001 до 1728043620000 (2024-10-04 12:02:00 до 2024-10-04 12:07:00)
2024-10-04 15:07:25,770 - INFO - Данные сохранены в data/ETHUSDT_1_data.csv
2024-10-04 15:07:26,417 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:26,418 - INFO - Сводка данных для ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043620000        ETHUSDT    1          1728043620000 2382.580078125 2382.580078125 2382.0     2382.0     11.102100372314453 26448.23828125 370        0.9692999720573425 2309.10205078125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727265480000        ETHUSDT    1          1727265480000 2627.39990234375 2627.89990234375 2627.39990234375 2627.820068359375 76.50299835205078 201012.703125 842        67.06340026855469 176209.25  11         6          0.258819043636322 -0.9659258127212524 -0.7818315029144287 0.6234897971153259

2024-10-04 15:07:27,064 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:27,064 - INFO - ------------------------
2024-10-04 15:07:29,083 - INFO - Обновление данных для ETHUSDT с 1728043200001 до 1728043500000 (2024-10-04 12:00:00 до 2024-10-04 12:05:00)
2024-10-04 15:07:29,468 - INFO - Данные сохранены в data/ETHUSDT_5_data.csv
2024-10-04 15:07:30,131 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:30,132 - INFO - Сводка данных для ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043500000        ETHUSDT    5          1728043500000 2383.699951171875 2384.39990234375 2382.0     2382.389892578125 158.8697052001953 378600.53125 4553       85.08910369873047 202767.75  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726488000000        ETHUSDT    5          1726488000000 2307.800048828125 2310.610107421875 2306.60009765625 2309.989990234375 749.1240234375 1729554.25 5211       555.8009033203125 1283180.625 12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:07:30,778 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:30,779 - INFO - ------------------------
2024-10-04 15:07:32,126 - INFO - Данные для ETHUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:07:32,126 - INFO - Сводка данных для ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        ETHUSDT    15         1728043200000 2386.199951171875 2386.800048828125 2386.1201171875 2386.800048828125 13.31779956817627 31783.779296875 624        10.775699615478516 25716.595703125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724932800000        ETHUSDT    15         1724932800000 2555.199951171875 2558.4599609375 2552.139892578125 2556.7900390625 1688.5289306640625 4314773.5  17545      720.7266845703125 1841737.125 12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:07:32,761 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:32,762 - INFO - ------------------------
2024-10-04 15:07:34,791 - INFO - Обновление данных для BTCUSDT с 1728043320001 до 1728043620000 (2024-10-04 12:02:00 до 2024-10-04 12:07:00)
2024-10-04 15:07:35,221 - INFO - Данные сохранены в data/BTCUSDT_1_data.csv
2024-10-04 15:07:35,881 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:35,882 - INFO - Сводка данных для BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043620000        BTCUSDT    1          1728043620000 61434.0    61434.0    61431.28125 61433.8984375 1.400230050086975 86021.1015625 376        0.1842000037431717 11316.01953125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727265480000        BTCUSDT    1          1727265480000 63842.640625 63848.0    63838.0    63838.0    4.534259796142578 289491.6875 912        3.17549991607666 202743.3125 11         6          0.258819043636322 -0.9659258127212524 -0.7818315029144287 0.6234897971153259

2024-10-04 15:07:36,538 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:36,539 - INFO - ------------------------
2024-10-04 15:07:38,590 - INFO - Обновление данных для BTCUSDT с 1728043200001 до 1728043500000 (2024-10-04 12:00:00 до 2024-10-04 12:05:00)
2024-10-04 15:07:38,979 - INFO - Данные сохранены в data/BTCUSDT_5_data.csv
2024-10-04 15:07:39,640 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:39,641 - INFO - Сводка данных для BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043500000        BTCUSDT    5          1728043500000 61456.0390625 61456.05078125 61426.109375 61433.91015625 17.182769775390625 1055786.0  3247       6.6587300300598145 409136.65625 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726488000000        BTCUSDT    5          1726488000000 58664.0    58735.98828125 58642.0    58718.0    33.45286178588867 1963466.625 7261       20.301000595092773 1191636.0  12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:07:40,315 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:40,316 - INFO - ------------------------
2024-10-04 15:07:41,662 - INFO - Данные для BTCUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:07:41,662 - INFO - Сводка данных для BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        BTCUSDT    15         1728043200000 61449.83984375 61458.859375 61448.98828125 61458.8515625 1.9523299932479858 119973.609375 573        1.700569987297058 104502.1328125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724932800000        BTCUSDT    15         1724932800000 60067.05859375 60181.078125 59990.0    60084.0    265.12481689453125 15928289.0 36208      115.03851318359375 6911768.0  12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:07:42,326 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:07:42,327 - INFO - ------------------------
2024-10-04 15:07:43,327 - INFO - Все файлы обновлены с последними ценами.
2024-10-04 15:07:43,327 - INFO - Выполнение методов get_current_price и get_latest_prices для всех символов и интервалов.
2024-10-04 15:07:43,679 - INFO - Текущая цена для ETHUSDT (1):
    symbol  interval      timestamp         open         high     low        close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT         1  1728043620000  2382.580078  2382.600098  2382.0  2382.330078  86.340897        205689.90625              1054                      30.8608                  73514.078125    12          1  1.224647e-16      -1.0  0.781832  0.62349
2024-10-04 15:07:43,716 - INFO - Последняя цена для ETHUSDT (1):
      symbol  interval      timestamp     open     high      low    close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
1    ETHUSDT         1  1728043620000  2382.58  2382.58  2382.00  2382.00   11.1021           26448.238               370                       0.9693                      2309.102    12          1  1.224647e-16 -1.000000  0.781832  0.62349
2    ETHUSDT         1  1728043560000  2383.01  2383.08  2382.01  2382.58   34.9807           83349.540              1710                      15.8236                     37702.438    12          1  1.224647e-16 -1.000000  0.781832  0.62349
5    ETHUSDT         1  1728043500000  2383.70  2384.40  2383.00  2383.00  108.6301          258900.810              2194                      64.4728                    153648.450    12          1  1.224647e-16 -1.000000  0.781832  0.62349
8    ETHUSDT         1  1728043440000  2383.44  2384.36  2382.64  2383.69  303.7555          724104.250              1621                      23.9771                     57147.180    12          1  1.224647e-16 -1.000000  0.781832  0.62349
11   ETHUSDT         1  1728043380000  2385.40  2385.40  2383.44  2383.44   59.4975          141855.670               881                      19.9931                     47662.900    12          1  1.224647e-16 -1.000000  0.781832  0.62349
..       ...       ...            ...      ...      ...      ...      ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
748  ETHUSDT         1  1728025920000  2374.80  2375.74  2374.31  2374.95  362.4716          860901.250              1892                     166.6640                    395837.530     7          1  9.659258e-01 -0.258819  0.781832  0.62349
751  ETHUSDT         1  1728025860000  2372.80  2374.94  2372.80  2374.79   43.9799          104432.000              1400                      22.2094                     52732.664     7          1  9.659258e-01 -0.258819  0.781832  0.62349
754  ETHUSDT         1  1728025800000  2374.42  2374.42  2370.90  2372.79   85.2660          202261.360              3222                      35.3901                     83943.800     7          1  9.659258e-01 -0.258819  0.781832  0.62349
756  ETHUSDT         1  1728025740000  2375.00  2375.23  2374.41  2374.42  191.6417          455136.120              1102                      53.3246                    126627.670     7          1  9.659258e-01 -0.258819  0.781832  0.62349
758  ETHUSDT         1  1728025680000  2374.98  2375.67  2374.85  2374.99  156.1314          370855.530               604                      57.0329                    135457.690     7          1  9.659258e-01 -0.258819  0.781832  0.62349

[300 rows x 18 columns]
2024-10-04 15:07:45,919 - INFO - Текущая цена для ETHUSDT (5):
    symbol  interval      timestamp         open         high     low        close      volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT         5  1728043500000  2383.699951  2384.399902  2382.0  2382.330078  229.951706           547940.25              4958                   111.157204                  264864.96875    12          1  1.224647e-16      -1.0  0.781832  0.62349
2024-10-04 15:07:45,954 - INFO - Последняя цена для ETHUSDT (5):
       symbol  interval      timestamp     open     high      low    close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
7     ETHUSDT         5  1728043500000  2383.70  2384.40  2382.00  2382.39   158.8697        3.786005e+05              4553                      85.0891                    202767.750    12          1  1.224647e-16 -1.000000  0.781832  0.62349
21    ETHUSDT         5  1728043200000  2386.20  2386.72  2386.12  2386.72    10.6905        2.551300e+04               573                       8.3018                     19811.950    12          1  1.224647e-16 -1.000000  0.781832  0.62349
32    ETHUSDT         5  1728042900000  2385.91  2385.98  2383.53  2384.75   176.2637        4.203767e+05              2717                      43.9279                    104751.734    11          1  2.588190e-01 -0.965926  0.781832  0.62349
44    ETHUSDT         5  1728042600000  2384.43  2386.49  2384.00  2385.90   299.4295        7.142573e+05              5393                     160.4486                    382737.660    11          1  2.588190e-01 -0.965926  0.781832  0.62349
59    ETHUSDT         5  1728042300000  2380.61  2384.44  2380.60  2384.44   313.4434        7.469956e+05              4078                     182.0606                    433836.750    11          1  2.588190e-01 -0.965926  0.781832  0.62349
...       ...       ...            ...      ...      ...      ...      ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
3745  ETHUSDT         5  1727955000000  2356.43  2356.45  2347.81  2348.26  5778.9840        1.359968e+07             13054                    1566.9355                   3686292.000    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3757  ETHUSDT         5  1727954700000  2354.21  2359.81  2353.98  2356.42   558.1958        1.315417e+06              7998                     321.8039                    758301.300    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3767  ETHUSDT         5  1727954400000  2362.11  2362.66  2353.51  2354.20   892.8825        2.106367e+06             11280                     322.1513                    759926.200    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3783  ETHUSDT         5  1727954100000  2366.41  2366.58  2360.52  2362.12   843.7156        1.994249e+06             10288                     222.5167                    525804.900    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3792  ETHUSDT         5  1727953800000  2366.99  2368.66  2365.15  2366.41   896.8899        2.122980e+06             10367                     258.4522                    611628.500    11          0  2.588190e-01 -0.965926  0.000000  1.00000

[300 rows x 18 columns]
2024-10-04 15:07:47,313 - INFO - Текущая цена для ETHUSDT (15):
    symbol  interval      timestamp         open    high     low        close      volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT        15  1728043200000  2386.199951  2387.0  2382.0  2382.330078  832.590088          1985140.25             12238                   273.289703                   651632.9375    12          1  1.224647e-16      -1.0  0.781832  0.62349
2024-10-04 15:07:47,347 - INFO - Последняя цена для ETHUSDT (15):
        symbol  interval      timestamp     open     high      low    close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day   cos_day
20     ETHUSDT        15  1728043200000  2386.20  2386.80  2386.12  2386.80    13.3178            31783.78               624                      10.7757                     25716.596    12          1  1.224647e-16 -1.000000  0.781832  0.623490
54     ETHUSDT        15  1728042300000  2380.61  2386.49  2380.60  2384.76   789.9527          1883575.90             12194                     387.0750                    922847.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
94     ETHUSDT        15  1728041400000  2378.91  2382.00  2378.00  2380.61  1123.2635          2672941.80             14413                     640.7400                   1524555.100    11          1  2.588190e-01 -0.965926  0.781832  0.623490
130    ETHUSDT        15  1728040500000  2379.25  2382.84  2378.21  2378.90  1108.7366          2639710.50             14342                     600.4699                   1429835.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
169    ETHUSDT        15  1728039600000  2375.17  2379.62  2374.21  2379.24   785.0437          1865993.90             17167                     421.3286                   1001540.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
...        ...       ...            ...      ...      ...      ...      ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...       ...
11229  ETHUSDT        15  1727777700000  2632.99  2636.86  2631.59  2635.40  2006.5388          5284911.50             16870                     595.3239                   1568155.500    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11269  ETHUSDT        15  1727776800000  2635.19  2637.50  2632.07  2632.99  2018.0824          5316706.00             16263                     733.5127                   1932551.400    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11304  ETHUSDT        15  1727775900000  2637.69  2640.00  2634.65  2635.18  1250.7848          3299279.80             10756                     440.6499                   1162381.600     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11345  ETHUSDT        15  1727775000000  2642.88  2643.25  2636.82  2637.69  2026.0142          5348170.50              9969                     707.4836                   1867484.400     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11383  ETHUSDT        15  1727774100000  2644.86  2645.47  2640.00  2642.87  1630.5599          4308992.50             14437                     794.3692                   2099262.800     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521

[300 rows x 18 columns]
2024-10-04 15:07:48,711 - INFO - Текущая цена для BTCUSDT (1):
    symbol  interval      timestamp     open     high          low         close   volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT         1  1728043620000  61434.0  61434.0  61431.28125  61433.910156  1.53977        94593.585938               428                      0.25051                  15389.701172    12          1  1.224647e-16      -1.0  0.781832  0.62349
2024-10-04 15:07:48,753 - INFO - Последняя цена для BTCUSDT (1):
      symbol  interval      timestamp      open      high       low     close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0    BTCUSDT         1  1728043620000  61434.00  61434.00  61431.28  61433.90   1.40023            86021.10               376                      0.18420                     11316.020    12          1  1.224647e-16 -1.000000  0.781832  0.62349
3    BTCUSDT         1  1728043560000  61442.01  61442.01  61426.11  61434.00   5.13987           315753.20              1485                      2.52862                    155333.840    12          1  1.224647e-16 -1.000000  0.781832  0.62349
6    BTCUSDT         1  1728043500000  61456.04  61456.05  61442.00  61442.01  10.61170           652109.20              1372                      3.93573                    241861.390    12          1  1.224647e-16 -1.000000  0.781832  0.62349
9    BTCUSDT         1  1728043440000  61446.00  61456.05  61434.22  61456.04   6.07302           373170.44              1586                      4.92933                    302897.880    12          1  1.224647e-16 -1.000000  0.781832  0.62349
10   BTCUSDT         1  1728043380000  61472.49  61472.49  61446.00  61446.00   3.24779           199609.27              1583                      0.40582                     24942.006    12          1  1.224647e-16 -1.000000  0.781832  0.62349
..       ...       ...            ...       ...       ...       ...       ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
749  BTCUSDT         1  1728025920000  61142.00  61170.00  61142.00  61161.63  18.96937          1160127.40              1705                     16.94025                   1036013.800     7          1  9.659258e-01 -0.258819  0.781832  0.62349
750  BTCUSDT         1  1728025860000  61088.23  61142.00  61088.23  61142.00   7.78256           475786.44              1540                      5.88858                    359988.800     7          1  9.659258e-01 -0.258819  0.781832  0.62349
752  BTCUSDT         1  1728025800000  61132.00  61132.01  61068.00  61088.23  11.97283           731627.20              3168                      0.97227                     59396.300     7          1  9.659258e-01 -0.258819  0.781832  0.62349
757  BTCUSDT         1  1728025740000  61141.78  61149.82  61132.00  61132.00  10.74027           656699.00              1010                      7.67955                    469564.660     7          1  9.659258e-01 -0.258819  0.781832  0.62349
759  BTCUSDT         1  1728025680000  61129.60  61141.79  61129.60  61141.78   2.85972           174823.94               447                      2.38526                    145817.810     7          1  9.659258e-01 -0.258819  0.781832  0.62349

[300 rows x 18 columns]
2024-10-04 15:07:50,111 - INFO - Текущая цена для BTCUSDT (5):
    symbol  interval      timestamp          open          high           low         close     volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT         5  1728043500000  61456.039062  61456.050781  61426.109375  61433.910156  17.293051  ...                      6.71632                    412674.625    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:07:50,146 - INFO - Последняя цена для BTCUSDT (5):
       symbol  interval      timestamp      open      high       low     close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
4     BTCUSDT         5  1728043500000  61456.04  61456.05  61426.11  61433.91   17.18277          1055786.00              3247                      6.65873                     409136.66    12          1  1.224647e-16 -1.000000  0.781832  0.62349
19    BTCUSDT         5  1728043200000  61449.84  61458.00  61448.99  61457.99    1.88296           115710.26               481                      1.63379                     100397.95    12          1  1.224647e-16 -1.000000  0.781832  0.62349
30    BTCUSDT         5  1728042900000  61456.00  61456.00  61400.00  61440.00   27.13787          1666718.80              4187                      9.88309                     606960.20    11          1  2.588190e-01 -0.965926  0.781832  0.62349
43    BTCUSDT         5  1728042600000  61465.50  61483.02  61449.70  61456.00   53.31801          3277459.00              6016                     36.07981                    2217850.20    11          1  2.588190e-01 -0.965926  0.781832  0.62349
57    BTCUSDT         5  1728042300000  61394.02  61469.00  61394.01  61465.50   26.63522          1636691.80              5554                     20.24487                    1243993.10    11          1  2.588190e-01 -0.965926  0.781832  0.62349
...       ...       ...            ...       ...       ...       ...       ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
3740  BTCUSDT         5  1727955000000  60722.05  60760.65  60594.00  60622.00  119.81434          7268758.00             17461                     52.32459                    3172936.50    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3756  BTCUSDT         5  1727954700000  60689.02  60794.72  60679.94  60722.05   82.29679          4998126.50             12327                     16.69351                    1013791.94    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3766  BTCUSDT         5  1727954400000  60900.00  60905.97  60679.92  60689.02  154.58961          9396492.00             15268                     42.05248                    2555546.20    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3778  BTCUSDT         5  1727954100000  61001.16  61001.17  60900.00  60900.00   49.87969          3039922.50             11046                     13.88404                     846243.25    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3793  BTCUSDT         5  1727953800000  61025.10  61050.41  60994.00  61001.16   23.14982          1412495.80             10519                     12.24533                     747177.75    11          0  2.588190e-01 -0.965926  0.000000  1.00000

[300 rows x 18 columns]
2024-10-04 15:07:51,495 - INFO - Текущая цена для BTCUSDT (15):
    symbol  interval      timestamp          open          high           low         close     volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT        15  1728043200000  61449.839844  61502.699219  61426.109375  61433.910156  82.716293  ...                    33.854679                     2080991.0    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:07:51,539 - INFO - Последняя цена для BTCUSDT (15):
        symbol  interval      timestamp      open      high       low     close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day   cos_day
18     BTCUSDT        15  1728043200000  61449.84  61458.86  61448.99  61458.85    1.95233           119973.61               573                      1.70057                     104502.13    12          1  1.224647e-16 -1.000000  0.781832  0.623490
56     BTCUSDT        15  1728042300000  61394.02  61483.02  61394.01  61439.99  107.23911          6589963.00             15779                     66.35461                    4077825.50    11          1  2.588190e-01 -0.965926  0.781832  0.623490
92     BTCUSDT        15  1728041400000  61320.32  61420.00  61301.75  61394.02  130.54375          8009725.00             22083                     73.86198                    4532674.50    11          1  2.588190e-01 -0.965926  0.781832  0.623490
133    BTCUSDT        15  1728040500000  61411.99  61460.00  61320.31  61320.31  235.35864         14443928.00             19323                     38.81200                    2383073.20    11          1  2.588190e-01 -0.965926  0.781832  0.623490
170    BTCUSDT        15  1728039600000  61284.01  61420.00  61274.00  61411.99   87.25890          5352607.50             21776                     52.50074                    3220560.50    11          1  2.588190e-01 -0.965926  0.781832  0.623490
...        ...       ...            ...       ...       ...       ...       ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...       ...
11231  BTCUSDT        15  1727777700000  63753.91  63871.44  63750.00  63850.00  100.80818          6433290.50             20646                     54.13152                    3454072.00    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11267  BTCUSDT        15  1727776800000  63864.47  63892.39  63707.89  63753.91  275.74530         17594600.00             25454                     88.56388                    5651176.00    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11307  BTCUSDT        15  1727775900000  63943.54  63964.00  63864.46  63864.46  111.21354          7110134.50             12441                     48.73248                    3115494.50     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11341  BTCUSDT        15  1727775000000  64058.00  64058.01  63941.32  63943.54  111.65746          7145016.00             15286                     33.55119                    2146673.50     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11379  BTCUSDT        15  1727774100000  64086.78  64088.76  64002.10  64058.00  148.36633          9502988.00             19282                     63.49062                    4066586.80     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521

[300 rows x 18 columns]
2024-10-04 15:07:52,539 - INFO - Завершено.
2024-10-04 15:07:52,573 - INFO - Latest dataset loaded with 300 records.
2024-10-04 15:07:52,574 - INFO - Порядок столбцов после transform: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:07:52,574 - INFO - Типы данных после transform:
2024-10-04 15:07:52,575 - INFO - symbol                            int64
interval                          int64
timestamp                         int64
open                            float32
high                            float32
low                             float32
close                           float32
volume                          float32
quote_asset_volume              float32
number_of_trades                  int64
taker_buy_base_asset_volume     float32
taker_buy_quote_asset_volume    float32
hour                              int64
dayofweek                         int64
sin_hour                        float32
cos_hour                        float32
sin_day                         float32
cos_day                         float32
dtype: object
2024-10-04 15:07:52,648 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 15:07:52,650 - INFO - Logging is set up.
2024-10-04 15:07:52,650 - INFO - Используемое устройство: cuda
2024-10-04 15:07:52,650 - INFO - DataProcessor загружен: models/data_processor_ETHUSDT_v2.0.pkl
2024-10-04 15:07:52,690 - INFO - Комбинированные данные загружены из data/combined_dataset.csv
2024-10-04 15:07:52,715 - INFO - Порядок столбцов после transform: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:07:52,716 - INFO - Типы данных после transform:
2024-10-04 15:07:52,716 - INFO - symbol                            int64
interval                          int64
timestamp                         int64
open                            float32
high                            float32
low                             float32
close                           float32
volume                          float32
quote_asset_volume              float32
number_of_trades                  int64
taker_buy_base_asset_volume     float32
taker_buy_quote_asset_volume    float32
hour                              int64
dayofweek                         int64
sin_hour                        float32
cos_hour                        float32
sin_day                         float32
cos_day                         float32
dtype: object
2024-10-04 15:07:52,716 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:07:52,716 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:07:52,886 - INFO - Оптимизатор загружен из models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:07:52,886 - INFO - Модель загружена из models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 15:08:14,470 - INFO - Epoch 1/5 - Loss: 8547931400874.6670
2024-10-04 15:08:14,555 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:08:14,555 - INFO - Validation loss improved to 8547931400874.6670. Model saved.
2024-10-04 15:08:36,499 - INFO - Epoch 2/5 - Loss: 8536597068263.6191
2024-10-04 15:08:36,581 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:08:36,581 - INFO - Validation loss improved to 8536597068263.6191. Model saved.
2024-10-04 15:08:58,680 - INFO - Epoch 3/5 - Loss: 8538103694092.1904
2024-10-04 15:08:58,680 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:08:58,680 - INFO - Reducing learning rate to: 0.00025
2024-10-04 15:09:19,584 - INFO - Epoch 4/5 - Loss: 8535205528332.1904
2024-10-04 15:09:19,671 - INFO - Модель сохранена в models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, а оптимизатор в models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:09:19,671 - INFO - Validation loss improved to 8535205528332.1904. Model saved.
2024-10-04 15:09:41,631 - INFO - Epoch 5/5 - Loss: 8544365006652.9521
2024-10-04 15:09:41,631 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:09:41,631 - INFO - Reducing learning rate to: 0.000125
2024-10-04 15:09:41,631 - INFO - Скрипт запущен
2024-10-04 15:09:42,002 - INFO - Binance API доступен. Время сервера: 2024-10-04 12:09:42
2024-10-04 15:09:43,038 - INFO - Обновление данных для ETHUSDT с 1728043620001 до 1728043740000 (2024-10-04 12:07:00 до 2024-10-04 12:09:00)
2024-10-04 15:09:43,476 - INFO - Данные сохранены в data/ETHUSDT_1_data.csv
2024-10-04 15:09:44,234 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:09:44,234 - INFO - Сводка данных для ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043740000        ETHUSDT    1          1728043740000 2382.31005859375 2382.31005859375 2381.10009765625 2381.22998046875 43.16659927368164 102803.9609375 642        16.083900451660156 38301.80859375 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727265480000        ETHUSDT    1          1727265480000 2627.39990234375 2627.89990234375 2627.39990234375 2627.820068359375 76.50299835205078 201012.703125 842        67.06340026855469 176209.25  11         6          0.258819043636322 -0.9659258127212524 -0.7818315029144287 0.6234897971153259

2024-10-04 15:09:44,912 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:09:44,912 - INFO - ------------------------
2024-10-04 15:09:46,259 - INFO - Данные для ETHUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:09:46,260 - INFO - Сводка данных для ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043500000        ETHUSDT    5          1728043500000 2383.699951171875 2384.39990234375 2382.0     2382.389892578125 158.8697052001953 378600.53125 4553       85.08910369873047 202767.75  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726488000000        ETHUSDT    5          1726488000000 2307.800048828125 2310.610107421875 2306.60009765625 2309.989990234375 749.1240234375 1729554.25 5211       555.8009033203125 1283180.625 12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:09:46,924 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:09:46,924 - INFO - ------------------------
2024-10-04 15:09:48,271 - INFO - Данные для ETHUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:09:48,272 - INFO - Сводка данных для ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        ETHUSDT    15         1728043200000 2386.199951171875 2386.800048828125 2386.1201171875 2386.800048828125 13.31779956817627 31783.779296875 624        10.775699615478516 25716.595703125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724932800000        ETHUSDT    15         1724932800000 2555.199951171875 2558.4599609375 2552.139892578125 2556.7900390625 1688.5289306640625 4314773.5  17545      720.7266845703125 1841737.125 12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:09:48,969 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:09:48,970 - INFO - ------------------------
2024-10-04 15:09:51,027 - INFO - Обновление данных для BTCUSDT с 1728043620001 до 1728043740000 (2024-10-04 12:07:00 до 2024-10-04 12:09:00)
2024-10-04 15:09:51,468 - INFO - Данные сохранены в data/BTCUSDT_1_data.csv
2024-10-04 15:09:52,205 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:09:52,206 - INFO - Сводка данных для BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043740000        BTCUSDT    1          1728043740000 61428.0    61428.0    61400.0    61400.0    4.180469989776611 256727.0625 1485       0.9702799916267395 59580.6015625 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727265480000        BTCUSDT    1          1727265480000 63842.640625 63848.0    63838.0    63838.0    4.534259796142578 289491.6875 912        3.17549991607666 202743.3125 11         6          0.258819043636322 -0.9659258127212524 -0.7818315029144287 0.6234897971153259

2024-10-04 15:09:52,865 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:09:52,865 - INFO - ------------------------
2024-10-04 15:09:54,219 - INFO - Данные для BTCUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:09:54,219 - INFO - Сводка данных для BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043500000        BTCUSDT    5          1728043500000 61456.0390625 61456.05078125 61426.109375 61433.91015625 17.182769775390625 1055786.0  3247       6.6587300300598145 409136.65625 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726488000000        BTCUSDT    5          1726488000000 58664.0    58735.98828125 58642.0    58718.0    33.45286178588867 1963466.625 7261       20.301000595092773 1191636.0  12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:09:54,889 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:09:54,889 - INFO - ------------------------
2024-10-04 15:09:57,557 - INFO - Данные для BTCUSDT не требуют обновления. Используются текущие данные.
2024-10-04 15:09:57,558 - INFO - Сводка данных для BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728043200000        BTCUSDT    15         1728043200000 61449.83984375 61458.859375 61448.98828125 61458.8515625 1.9523299932479858 119973.609375 573        1.700569987297058 104502.1328125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724932800000        BTCUSDT    15         1724932800000 60067.05859375 60181.078125 59990.0    60084.0    265.12481689453125 15928289.0 36208      115.03851318359375 6911768.0  12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:09:58,232 - INFO - Комбинированный набор данных обновлен: data/combined_dataset.csv
2024-10-04 15:09:58,233 - INFO - ------------------------
2024-10-04 15:09:59,233 - INFO - Все файлы обновлены с последними ценами.
2024-10-04 15:09:59,233 - INFO - Выполнение методов get_current_price и get_latest_prices для всех символов и интервалов.
2024-10-04 15:09:59,626 - INFO - Текущая цена для ETHUSDT (1):
    symbol  interval      timestamp         open         high          low        close     volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT         1  1728043740000  2382.310059  2382.310059  2381.100098  2381.399902  78.544502  ...                    21.257299                  50620.898438    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:09:59,659 - INFO - Последняя цена для ETHUSDT (1):
      symbol  interval      timestamp     open     high      low    close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
1    ETHUSDT         1  1728043740000  2382.31  2382.31  2381.10  2381.23   43.1666          102803.960               642                      16.0839                     38301.810    12          1  1.224647e-16 -1.000000  0.781832  0.62349
2    ETHUSDT         1  1728043680000  2382.60  2383.20  2382.08  2382.31   28.1175           66989.234              1368                       8.9679                     21366.250    12          1  1.224647e-16 -1.000000  0.781832  0.62349
5    ETHUSDT         1  1728043620000  2382.58  2382.58  2382.00  2382.00   11.1021           26448.238               370                       0.9693                      2309.102    12          1  1.224647e-16 -1.000000  0.781832  0.62349
6    ETHUSDT         1  1728043560000  2383.01  2383.08  2382.01  2382.58   34.9807           83349.540              1710                      15.8236                     37702.438    12          1  1.224647e-16 -1.000000  0.781832  0.62349
11   ETHUSDT         1  1728043500000  2383.70  2384.40  2383.00  2383.00  108.6301          258900.810              2194                      64.4728                    153648.450    12          1  1.224647e-16 -1.000000  0.781832  0.62349
..       ...       ...            ...      ...      ...      ...      ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
749  ETHUSDT         1  1728026040000  2373.73  2375.60  2373.73  2375.60   63.4893          150774.730               603                      20.2318                     48048.168     7          1  9.659258e-01 -0.258819  0.781832  0.62349
750  ETHUSDT         1  1728025980000  2374.95  2375.37  2373.73  2373.74  424.7798         1008841.800              2256                      69.2504                    164468.600     7          1  9.659258e-01 -0.258819  0.781832  0.62349
753  ETHUSDT         1  1728025920000  2374.80  2375.74  2374.31  2374.95  362.4716          860901.250              1892                     166.6640                    395837.530     7          1  9.659258e-01 -0.258819  0.781832  0.62349
754  ETHUSDT         1  1728025860000  2372.80  2374.94  2372.80  2374.79   43.9799          104432.000              1400                      22.2094                     52732.664     7          1  9.659258e-01 -0.258819  0.781832  0.62349
756  ETHUSDT         1  1728025800000  2374.42  2374.42  2370.90  2372.79   85.2660          202261.360              3222                      35.3901                     83943.800     7          1  9.659258e-01 -0.258819  0.781832  0.62349

[300 rows x 18 columns]
2024-10-04 15:10:01,015 - INFO - Текущая цена для ETHUSDT (5):
    symbol  interval      timestamp         open         high          low        close      volume  ...  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT         5  1728043500000  2383.699951  2384.399902  2381.100098  2381.399902  344.144989  ...                   148.447098                    353682.625    12          1  1.224647e-16      -1.0  0.781832  0.62349

[1 rows x 18 columns]
2024-10-04 15:10:01,050 - INFO - Последняя цена для ETHUSDT (5):
       symbol  interval      timestamp     open     high      low    close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
10    ETHUSDT         5  1728043500000  2383.70  2384.40  2382.00  2382.39   158.8697        3.786005e+05              4553                      85.0891                    202767.750    12          1  1.224647e-16 -1.000000  0.781832  0.62349
21    ETHUSDT         5  1728043200000  2386.20  2386.72  2386.12  2386.72    10.6905        2.551300e+04               573                       8.3018                     19811.950    12          1  1.224647e-16 -1.000000  0.781832  0.62349
37    ETHUSDT         5  1728042900000  2385.91  2385.98  2383.53  2384.75   176.2637        4.203767e+05              2717                      43.9279                    104751.734    11          1  2.588190e-01 -0.965926  0.781832  0.62349
49    ETHUSDT         5  1728042600000  2384.43  2386.49  2384.00  2385.90   299.4295        7.142573e+05              5393                     160.4486                    382737.660    11          1  2.588190e-01 -0.965926  0.781832  0.62349
60    ETHUSDT         5  1728042300000  2380.61  2384.44  2380.60  2384.44   313.4434        7.469956e+05              4078                     182.0606                    433836.750    11          1  2.588190e-01 -0.965926  0.781832  0.62349
...       ...       ...            ...      ...      ...      ...      ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
3748  ETHUSDT         5  1727955000000  2356.43  2356.45  2347.81  2348.26  5778.9840        1.359968e+07             13054                    1566.9355                   3686292.000    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3758  ETHUSDT         5  1727954700000  2354.21  2359.81  2353.98  2356.42   558.1958        1.315417e+06              7998                     321.8039                    758301.300    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3772  ETHUSDT         5  1727954400000  2362.11  2362.66  2353.51  2354.20   892.8825        2.106367e+06             11280                     322.1513                    759926.200    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3785  ETHUSDT         5  1727954100000  2366.41  2366.58  2360.52  2362.12   843.7156        1.994249e+06             10288                     222.5167                    525804.900    11          0  2.588190e-01 -0.965926  0.000000  1.00000
3798  ETHUSDT         5  1727953800000  2366.99  2368.66  2365.15  2366.41   896.8899        2.122980e+06             10367                     258.4522                    611628.500    11          0  2.588190e-01 -0.965926  0.000000  1.00000

[300 rows x 18 columns]
2024-10-04 15:10:02,404 - INFO - Текущая цена для ETHUSDT (15):
    symbol  interval      timestamp         open    high          low        close      volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  ETHUSDT        15  1728043200000  2386.199951  2387.0  2381.100098  2381.409912  948.087219           2260222.5             14545                   311.948914                     743711.25    12          1  1.224647e-16      -1.0  0.781832  0.62349
2024-10-04 15:10:02,437 - INFO - Последняя цена для ETHUSDT (15):
        symbol  interval      timestamp     open     high      low    close     volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day   cos_day
24     ETHUSDT        15  1728043200000  2386.20  2386.80  2386.12  2386.80    13.3178            31783.78               624                      10.7757                     25716.596    12          1  1.224647e-16 -1.000000  0.781832  0.623490
63     ETHUSDT        15  1728042300000  2380.61  2386.49  2380.60  2384.76   789.9527          1883575.90             12194                     387.0750                    922847.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
99     ETHUSDT        15  1728041400000  2378.91  2382.00  2378.00  2380.61  1123.2635          2672941.80             14413                     640.7400                   1524555.100    11          1  2.588190e-01 -0.965926  0.781832  0.623490
137    ETHUSDT        15  1728040500000  2379.25  2382.84  2378.21  2378.90  1108.7366          2639710.50             14342                     600.4699                   1429835.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
177    ETHUSDT        15  1728039600000  2375.17  2379.62  2374.21  2379.24   785.0437          1865993.90             17167                     421.3286                   1001540.400    11          1  2.588190e-01 -0.965926  0.781832  0.623490
...        ...       ...            ...      ...      ...      ...      ...        ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...       ...
11230  ETHUSDT        15  1727777700000  2632.99  2636.86  2631.59  2635.40  2006.5388          5284911.50             16870                     595.3239                   1568155.500    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11273  ETHUSDT        15  1727776800000  2635.19  2637.50  2632.07  2632.99  2018.0824          5316706.00             16263                     733.5127                   1932551.400    10          5  5.000000e-01 -0.866025 -0.974928 -0.222521
11310  ETHUSDT        15  1727775900000  2637.69  2640.00  2634.65  2635.18  1250.7848          3299279.80             10756                     440.6499                   1162381.600     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11349  ETHUSDT        15  1727775000000  2642.88  2643.25  2636.82  2637.69  2026.0142          5348170.50              9969                     707.4836                   1867484.400     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521
11382  ETHUSDT        15  1727774100000  2644.86  2645.47  2640.00  2642.87  1630.5599          4308992.50             14437                     794.3692                   2099262.800     9          5  7.071068e-01 -0.707107 -0.974928 -0.222521

[300 rows x 18 columns]
2024-10-04 15:10:03,854 - INFO - Текущая цена для BTCUSDT (1):
    symbol  interval      timestamp     open          high           low         close   volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0  BTCUSDT         1  1728043800000  61402.0  61411.988281  61401.988281  61411.988281  0.54703        33590.488281               542                      0.53048                  32574.121094    12          1  1.224647e-16      -1.0  0.781832  0.62349
2024-10-04 15:10:03,887 - INFO - Последняя цена для BTCUSDT (1):
      symbol  interval      timestamp      open      high       low     close    volume  quote_asset_volume  number_of_trades  taker_buy_base_asset_volume  taker_buy_quote_asset_volume  hour  dayofweek      sin_hour  cos_hour   sin_day  cos_day
0    BTCUSDT         1  1728043740000  61428.00  61428.00  61400.00  61400.00   4.18047           256727.06              1485                      0.97028                      59580.60    12          1  1.224647e-16 -1.000000  0.781832  0.62349
3    BTCUSDT         1  1728043680000  61433.90  61444.66  61418.42  61427.99  10.11429           621309.60              1861                      3.53277                     217027.77    12          1  1.224647e-16 -1.000000  0.781832  0.62349
4    BTCUSDT         1  1728043620000  61434.00  61434.00  61431.28  61433.90   1.40023            86021.10               376                      0.18420                      11316.02    12          1  1.224647e-16 -1.000000  0.781832  0.62349
7    BTCUSDT         1  1728043560000  61442.01  61442.01  61426.11  61434.00   5.13987           315753.20              1485                      2.52862                     155333.84    12          1  1.224647e-16 -1.000000  0.781832  0.62349
8    BTCUSDT         1  1728043500000  61456.04  61456.05  61442.00  61442.01  10.61170           652109.20              1372                      3.93573                     241861.39    12          1  1.224647e-16 -1.000000  0.781832  0.62349
..       ...       ...            ...       ...       ...       ...       ...       ...                 ...               ...                          ...                           ...   ...        ...           ...       ...       ...      ...
748  BTCUSDT         1  1728026040000  61162.01  61188.00  61162.01  61188.00   6.98070           427078.62              1014                      6.79146                     415501.47     7          1  9.659258e-01 -0.258819  0.781832  0.62349
751  BTCUSDT         1  1728025980000  61161.64  61177.11  61161.63  61162.01   7.22605           442028.16              1465                      2.22335                     136000.25     7          1  9.659258e-01 -0.258819  0.781832  0.62349
752  BTCUSDT         1  1728025920000  61142.00  61170.00  61142.00  61161.63  18.96937          1160127.40              1705                     16.94025                    1036013.80     7          1  9.659258e-01 -0.258819  0.781832  0.62349
755  BTCUSDT         1  1728025860000  61088.23  61142.00  61088.23  61142.00   7.78256           475786.44              1540                      5.88858                     359988.80     7          1  9.659258e-01 -0.258819  0.781832  0.62349
758  BTCUSDT         1  1728025800000  61132.00  61132.01  61068.00  61088.23  11.97283           731627.20              3168                      0.97227                      59396.30     7          1  9.659258e-01 -0.258819  0.781832  0.62349

[300 rows x 18 columns]
2024-10-04 15:40:30,184 - INFO - Logging is set up.
2024-10-04 15:40:30,185 - INFO - Using device: cuda
2024-10-04 15:40:30,185 - INFO - Numerical columns for scaling: ['open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:40:30,185 - INFO - Categorical columns: ['symbol', 'interval']
2024-10-04 15:40:30,234 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 15:40:30,264 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:40:30,264 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:40:31,088 - WARNING - Model file models/enhanced_bilstm_model_ETHUSDT_v2.0.pth not found. A new model will be created.
2024-10-04 15:40:53,739 - INFO - Epoch 1/5 - Loss: 8651125179148.1904
2024-10-04 15:40:53,813 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:40:53,813 - INFO - Validation loss improved to 8651125179148.1904. Model saved.
2024-10-04 15:41:14,759 - INFO - Epoch 2/5 - Loss: 8567766457977.9043
2024-10-04 15:41:14,845 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:41:14,845 - INFO - Validation loss improved to 8567766457977.9043. Model saved.
2024-10-04 15:41:36,672 - INFO - Epoch 3/5 - Loss: 8570328083894.8574
2024-10-04 15:41:36,673 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:41:36,673 - INFO - Reducing learning rate to: 0.00025
2024-10-04 15:41:58,483 - INFO - Epoch 4/5 - Loss: 8563721779687.6191
2024-10-04 15:41:58,562 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:41:58,562 - INFO - Validation loss improved to 8563721779687.6191. Model saved.
2024-10-04 15:42:19,545 - INFO - Epoch 5/5 - Loss: 8723812916857.9043
2024-10-04 15:42:19,545 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:42:19,545 - INFO - Reducing learning rate to: 0.000125
2024-10-04 15:42:19,546 - INFO - Script started
2024-10-04 15:42:19,947 - INFO - Binance API is available. Server time: 2024-10-04 12:42:20
2024-10-04 15:42:21,028 - INFO - Updating data for ETHUSDT from 1728045480001 to 1728045720000 (2024-10-04 12:38:00 to 2024-10-04 12:42:00)
2024-10-04 15:42:21,444 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 15:42:21,445 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045720000        ETHUSDT    1          1728045720000 2379.0     2379.239990234375 2377.10009765625 2378.0     116.93099975585938 278098.0625 1743       47.38779830932617 112713.0546875 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727267940000        ETHUSDT    1          1727267940000 2620.60009765625 2622.43994140625 2620.60009765625 2622.429931640625 97.71160125732422 256151.65625 1551       68.15160369873047 178649.359375 12         6          1.2246468525851679e-16 -1.0       -0.7818315029144287 0.6234897971153259

2024-10-04 15:42:22,090 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:42:22,090 - INFO - ------------------------
2024-10-04 15:42:24,193 - INFO - Updating data for ETHUSDT from 1728045300001 to 1728045600000 (2024-10-04 12:35:00 to 2024-10-04 12:40:00)
2024-10-04 15:42:24,625 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 15:42:24,626 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045600000        ETHUSDT    5          1728045600000 2385.7900390625 2386.489990234375 2376.719970703125 2378.2900390625 630.6403198242188 1501438.125 11067      222.63009643554688 530004.6875 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726490400000        ETHUSDT    5          1726490400000 2299.39990234375 2302.820068359375 2293.780029296875 2302.81005859375 1437.0611572265625 3301734.75 9245       711.0684814453125 1633614.0  12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:42:25,277 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:42:25,277 - INFO - ------------------------
2024-10-04 15:42:26,618 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 15:42:26,618 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045000000        ETHUSDT    15         1728045000000 2388.489990234375 2399.050048828125 2376.050048828125 2384.60009765625 7893.6630859375 18861728.0 72555      4004.2880859375 9570881.0  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724935500000        ETHUSDT    15         1724935500000 2573.320068359375 2575.35009765625 2567.5400390625 2572.909912109375 2849.990234375 7326047.0  17371      1481.322509765625 3807731.5  12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:42:27,266 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:42:27,266 - INFO - ------------------------
2024-10-04 15:42:30,163 - INFO - Updating data for BTCUSDT from 1728045480001 to 1728045720000 (2024-10-04 12:38:00 to 2024-10-04 12:42:00)
2024-10-04 15:42:30,583 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 15:42:30,583 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045720000        BTCUSDT    1          1728045720000 61401.98828125 61420.0    61365.23046875 61384.0    61.781009674072266 3792582.25 3498       25.459989547729492 1562868.25 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727267940000        BTCUSDT    1          1727267940000 63688.05859375 63733.30859375 63688.05078125 63733.30859375 10.734760284423828 683902.9375 1109       8.561739921569824 545442.5625 12         6          1.2246468525851679e-16 -1.0       -0.7818315029144287 0.6234897971153259

2024-10-04 15:42:31,228 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:42:31,228 - INFO - ------------------------
2024-10-04 15:42:33,277 - INFO - Updating data for BTCUSDT from 1728045300001 to 1728045600000 (2024-10-04 12:35:00 to 2024-10-04 12:40:00)
2024-10-04 15:42:33,653 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 15:42:33,653 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045600000        BTCUSDT    5          1728045600000 61549.62109375 61566.140625 61358.0    61381.98046875 168.48521423339844 10349413.0 17215      92.18438720703125 5662855.5  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726490400000        BTCUSDT    5          1726490400000 58545.5703125 58643.98828125 58419.91015625 58640.0    147.07135009765625 8603196.0  17759      77.21227264404297 4516739.0  12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:42:34,308 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:42:34,308 - INFO - ------------------------
2024-10-04 15:42:35,656 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 15:42:35,656 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045000000        BTCUSDT    15         1728045000000 61578.98828125 61793.8203125 61211.921875 61542.0    1066.809814453125 65656812.0 123222     554.4874267578125 34138200.0 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724935500000        BTCUSDT    15         1724935500000 60387.109375 60402.0    60240.0    60322.0    395.4984130859375 23857364.0 28244      167.7615966796875 10121136.0 12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:42:36,296 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:42:36,296 - INFO - ------------------------
2024-10-04 15:42:37,296 - INFO - All files have been updated with the latest prices.
2024-10-04 15:42:37,327 - INFO - Latest dataset loaded with 300 records.
2024-10-04 15:42:37,408 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 15:42:37,410 - INFO - Logging is set up.
2024-10-04 15:42:37,410 - INFO - Using device: cuda
2024-10-04 15:42:37,450 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 15:42:37,472 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:42:37,473 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:42:37,649 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:42:37,649 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 15:42:59,473 - INFO - Epoch 1/5 - Loss: 8568892999972.5713
2024-10-04 15:42:59,556 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:42:59,556 - INFO - Validation loss improved to 8568892999972.5713. Model saved.
2024-10-04 15:43:21,525 - INFO - Epoch 2/5 - Loss: 8567647876827.4287
2024-10-04 15:43:21,612 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:43:21,612 - INFO - Validation loss improved to 8567647876827.4287. Model saved.
2024-10-04 15:43:43,631 - INFO - Epoch 3/5 - Loss: 8573005800594.2861
2024-10-04 15:43:43,631 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:43:43,631 - INFO - Reducing learning rate to: 0.00025
2024-10-04 15:44:04,712 - INFO - Epoch 4/5 - Loss: 8570209413022.4766
2024-10-04 15:44:04,712 - INFO - No improvement in validation loss. (2/5)
2024-10-04 15:44:04,712 - INFO - Reducing learning rate to: 0.000125
2024-10-04 15:44:26,653 - INFO - Epoch 5/5 - Loss: 8572964275736.3809
2024-10-04 15:44:26,653 - INFO - No improvement in validation loss. (3/5)
2024-10-04 15:44:26,654 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 15:44:26,654 - INFO - Script started
2024-10-04 15:44:27,060 - INFO - Binance API is available. Server time: 2024-10-04 12:44:27
2024-10-04 15:44:28,133 - INFO - Updating data for ETHUSDT from 1728045720001 to 1728045840000 (2024-10-04 12:42:00 to 2024-10-04 12:44:00)
2024-10-04 15:44:28,593 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 15:44:28,593 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045840000        ETHUSDT    1          1728045840000 2377.0     2377.199951171875 2376.090087890625 2376.389892578125 189.62620544433594 450670.40625 915        20.32229995727539 48295.5    12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727267940000        ETHUSDT    1          1727267940000 2620.60009765625 2622.43994140625 2620.60009765625 2622.429931640625 97.71160125732422 256151.65625 1551       68.15160369873047 178649.359375 12         6          1.2246468525851679e-16 -1.0       -0.7818315029144287 0.6234897971153259

2024-10-04 15:44:29,225 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:44:29,225 - INFO - ------------------------
2024-10-04 15:44:30,627 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 15:44:30,627 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045600000        ETHUSDT    5          1728045600000 2385.7900390625 2386.489990234375 2376.719970703125 2378.2900390625 630.6403198242188 1501438.125 11067      222.63009643554688 530004.6875 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726490400000        ETHUSDT    5          1726490400000 2299.39990234375 2302.820068359375 2293.780029296875 2302.81005859375 1437.0611572265625 3301734.75 9245       711.0684814453125 1633614.0  12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:44:31,269 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:44:31,269 - INFO - ------------------------
2024-10-04 15:44:32,610 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 15:44:32,610 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045000000        ETHUSDT    15         1728045000000 2388.489990234375 2399.050048828125 2376.050048828125 2384.60009765625 7893.6630859375 18861728.0 72555      4004.2880859375 9570881.0  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724935500000        ETHUSDT    15         1724935500000 2573.320068359375 2575.35009765625 2567.5400390625 2572.909912109375 2849.990234375 7326047.0  17371      1481.322509765625 3807731.5  12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:44:33,263 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:44:33,263 - INFO - ------------------------
2024-10-04 15:44:35,295 - INFO - Updating data for BTCUSDT from 1728045720001 to 1728045840000 (2024-10-04 12:42:00 to 2024-10-04 12:44:00)
2024-10-04 15:44:35,715 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 15:44:35,716 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045840000        BTCUSDT    1          1728045840000 61354.44140625 61380.0    61343.87890625 61368.5    18.29412078857422 1122716.75 2274       11.989740371704102 735796.3125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727267940000        BTCUSDT    1          1727267940000 63688.05859375 63733.30859375 63688.05078125 63733.30859375 10.734760284423828 683902.9375 1109       8.561739921569824 545442.5625 12         6          1.2246468525851679e-16 -1.0       -0.7818315029144287 0.6234897971153259

2024-10-04 15:44:36,371 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:44:36,371 - INFO - ------------------------
2024-10-04 15:44:37,716 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 15:44:37,716 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045600000        BTCUSDT    5          1728045600000 61549.62109375 61566.140625 61358.0    61381.98046875 168.48521423339844 10349413.0 17215      92.18438720703125 5662855.5  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726490400000        BTCUSDT    5          1726490400000 58545.5703125 58643.98828125 58419.91015625 58640.0    147.07135009765625 8603196.0  17759      77.21227264404297 4516739.0  12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:44:38,370 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:44:38,370 - INFO - ------------------------
2024-10-04 15:44:39,710 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 15:44:39,710 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045000000        BTCUSDT    15         1728045000000 61578.98828125 61793.8203125 61211.921875 61542.0    1066.809814453125 65656812.0 123222     554.4874267578125 34138200.0 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724935500000        BTCUSDT    15         1724935500000 60387.109375 60402.0    60240.0    60322.0    395.4984130859375 23857364.0 28244      167.7615966796875 10121136.0 12         0          1.2246468525851679e-16 -1.0       0.0        1.0       

2024-10-04 15:44:40,361 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:44:40,361 - INFO - ------------------------
2024-10-04 15:44:42,195 - INFO - All files have been updated with the latest prices.
2024-10-04 15:44:42,223 - INFO - Latest dataset loaded with 300 records.
2024-10-04 15:44:42,299 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 15:44:42,301 - INFO - Logging is set up.
2024-10-04 15:44:42,301 - INFO - Using device: cuda
2024-10-04 15:44:42,336 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 15:44:42,357 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:44:42,357 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:44:42,535 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:44:42,535 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 15:45:04,432 - INFO - Epoch 1/5 - Loss: 8568746378776.3809
2024-10-04 15:45:04,524 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:45:04,524 - INFO - Validation loss improved to 8568746378776.3809. Model saved.
2024-10-04 15:45:26,514 - INFO - Epoch 2/5 - Loss: 8573251760323.0479
2024-10-04 15:45:26,514 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:45:26,515 - INFO - Reducing learning rate to: 0.00025
2024-10-04 15:45:48,372 - INFO - Epoch 3/5 - Loss: 8571285344841.1426
2024-10-04 15:45:48,373 - INFO - No improvement in validation loss. (2/5)
2024-10-04 15:45:48,373 - INFO - Reducing learning rate to: 0.000125
2024-10-04 15:49:43,756 - INFO - Logging is set up.
2024-10-04 15:49:43,756 - INFO - Using device: cuda
2024-10-04 15:49:43,756 - INFO - Numerical columns for scaling: ['open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:49:43,756 - INFO - Categorical columns: ['symbol', 'interval']
2024-10-04 15:49:43,799 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 15:49:43,825 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:49:43,825 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:49:44,334 - WARNING - Model file models/enhanced_bilstm_model_ETHUSDT_v2.0.pth not found. A new model will be created.
2024-10-04 15:50:05,977 - INFO - Epoch 1/5 - Loss: 8607171310543.2383
2024-10-04 15:50:06,049 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:50:06,049 - INFO - Validation loss improved to 8607171310543.2383. Model saved.
2024-10-04 15:50:27,957 - INFO - Epoch 2/5 - Loss: 8593669039250.2861
2024-10-04 15:50:28,038 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:50:28,038 - INFO - Validation loss improved to 8593669039250.2861. Model saved.
2024-10-04 15:50:49,897 - INFO - Epoch 3/5 - Loss: 8585917425566.4766
2024-10-04 15:50:49,980 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:50:49,980 - INFO - Validation loss improved to 8585917425566.4766. Model saved.
2024-10-04 15:51:10,834 - INFO - Epoch 4/5 - Loss: 8581502796556.1904
2024-10-04 15:51:10,915 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:51:10,915 - INFO - Validation loss improved to 8581502796556.1904. Model saved.
2024-10-04 15:51:32,773 - INFO - Epoch 5/5 - Loss: 8584864627175.6191
2024-10-04 15:51:32,773 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:51:32,773 - INFO - Reducing learning rate to: 0.00025
2024-10-04 15:51:32,773 - INFO - Script started
2024-10-04 15:51:33,180 - INFO - Binance API is available. Server time: 2024-10-04 12:51:33
2024-10-04 15:51:34,228 - INFO - Updating data for ETHUSDT from 1728046020001 to 1728046260000 (2024-10-04 12:47:00 to 2024-10-04 12:51:00)
2024-10-04 15:51:34,641 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 15:51:34,642 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728046260000        ETHUSDT    1          1728046260000 2382.590087890625 2383.419921875 2382.199951171875 2382.760009765625 54.830501556396484 130650.828125 869        32.89889907836914 78387.0078125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727268480000        ETHUSDT    1          1727268480000 2620.840087890625 2620.840087890625 2619.419921875 2619.419921875 221.79629516601562 581115.6875 2224       15.76200008392334 41295.98828125 12         6          1.2246468525851679e-16 -1.0       -0.7818315029144287 0.6234897971153259

2024-10-04 15:51:35,276 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:51:35,276 - INFO - ------------------------
2024-10-04 15:51:37,282 - INFO - Updating data for ETHUSDT from 1728045900001 to 1728046200000 (2024-10-04 12:45:00 to 2024-10-04 12:50:00)
2024-10-04 15:51:37,684 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 15:51:37,684 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728046200000        ETHUSDT    5          1728046200000 2382.860107421875 2383.89990234375 2380.39990234375 2382.75    185.94700622558594 443006.71875 3715       124.37349700927734 296302.78125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726491000000        ETHUSDT    5          1726491000000 2302.260009765625 2302.27001953125 2299.199951171875 2299.35009765625 660.5599975585938 1519475.375 4962       370.7427062988281 852824.5   12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:51:38,327 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:51:38,327 - INFO - ------------------------
2024-10-04 15:51:39,662 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 15:51:39,663 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045900000        ETHUSDT    15         1728045900000 2375.60009765625 2384.909912109375 2375.60009765625 2384.800048828125 1364.68798828125 3250089.25 9782       986.4075927734375 2349053.25 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724936400000        ETHUSDT    15         1724936400000 2572.909912109375 2578.14990234375 2568.010009765625 2573.199951171875 1831.93408203125 4713244.0  13226      850.910400390625 2189454.0  13         0          -0.258819043636322 -0.9659258127212524 0.0        1.0       

2024-10-04 15:51:40,295 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:51:40,295 - INFO - ------------------------
2024-10-04 15:51:42,343 - INFO - Updating data for BTCUSDT from 1728046020001 to 1728046260000 (2024-10-04 12:47:00 to 2024-10-04 12:51:00)
2024-10-04 15:51:42,789 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 15:51:42,790 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728046260000        BTCUSDT    1          1728046260000 61593.98828125 61632.0    61593.98828125 61632.0    7.094970226287842 437119.15625 3150       5.73406982421875 353270.875 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727268480000        BTCUSDT    1          1727268480000 63689.0703125 63689.0703125 63661.76953125 63669.98828125 6.734029769897461 428783.15625 3629       2.164210081100464 137790.15625 12         6          1.2246468525851679e-16 -1.0       -0.7818315029144287 0.6234897971153259

2024-10-04 15:51:43,425 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:51:43,425 - INFO - ------------------------
2024-10-04 15:51:45,466 - INFO - Updating data for BTCUSDT from 1728045900001 to 1728046200000 (2024-10-04 12:45:00 to 2024-10-04 12:50:00)
2024-10-04 15:51:45,840 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 15:51:45,840 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728046200000        BTCUSDT    5          1728046200000 61594.171875 61640.0    61550.0    61640.0    30.182939529418945 1858933.625 8846       20.026979446411133 1233482.5  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726491000000        BTCUSDT    5          1726491000000 58551.98828125 58555.98828125 58480.0    58511.62109375 46.83795166015625 2740545.0  15076      23.646350860595703 1383530.75 12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:51:46,478 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:51:46,478 - INFO - ------------------------
2024-10-04 15:51:47,824 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 15:51:47,825 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045900000        BTCUSDT    15         1728045900000 61363.62890625 61630.66015625 61363.62890625 61606.0703125 171.20924377441406 10534151.0 17300      124.01155090332031 7629538.0  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724936400000        BTCUSDT    15         1724936400000 60321.98828125 60450.0    60282.28125 60419.98828125 361.11895751953125 21803686.0 23052      189.83949279785156 11463633.0 13         0          -0.258819043636322 -0.9659258127212524 0.0        1.0       

2024-10-04 15:51:48,465 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:51:48,465 - INFO - ------------------------
2024-10-04 15:51:49,466 - INFO - All files have been updated with the latest prices.
2024-10-04 15:51:49,495 - INFO - Latest dataset loaded with 300 records.
2024-10-04 15:51:49,573 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 15:56:38,312 - INFO - Logging is set up.
2024-10-04 15:56:38,313 - INFO - Using device: cuda
2024-10-04 15:56:38,356 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 15:56:38,379 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 15:56:38,380 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 15:56:38,872 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:56:38,872 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 15:57:01,428 - INFO - Epoch 1/5 - Loss: 8580971811401.1426
2024-10-04 15:57:01,509 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 15:57:01,509 - INFO - Validation loss improved to 8580971811401.1426. Model saved.
2024-10-04 15:57:23,371 - INFO - Epoch 2/5 - Loss: 8582133228690.2861
2024-10-04 15:57:23,372 - INFO - No improvement in validation loss. (1/5)
2024-10-04 15:57:23,372 - INFO - Reducing learning rate to: 0.00025
2024-10-04 15:57:44,497 - INFO - Epoch 3/5 - Loss: 8586233366820.5713
2024-10-04 15:57:44,497 - INFO - No improvement in validation loss. (2/5)
2024-10-04 15:57:44,498 - INFO - Reducing learning rate to: 0.000125
2024-10-04 15:58:06,365 - INFO - Epoch 4/5 - Loss: 8585506897139.8096
2024-10-04 15:58:06,365 - INFO - No improvement in validation loss. (3/5)
2024-10-04 15:58:06,365 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 15:58:28,332 - INFO - Epoch 5/5 - Loss: 8590466552393.1426
2024-10-04 15:58:28,332 - INFO - No improvement in validation loss. (4/5)
2024-10-04 15:58:28,332 - INFO - Reducing learning rate to: 3.125e-05
2024-10-04 15:58:28,333 - INFO - Script started
2024-10-04 15:58:28,698 - INFO - Binance API is available. Server time: 2024-10-04 12:58:28
2024-10-04 15:58:29,748 - INFO - Updating data for ETHUSDT from 1728046260001 to 1728046680000 (2024-10-04 12:51:00 to 2024-10-04 12:58:00)
2024-10-04 15:58:30,171 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 15:58:30,172 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728046680000        ETHUSDT    1          1728046680000 2391.679931640625 2393.300048828125 2391.02001953125 2393.159912109375 192.69090270996094 460858.40625 3235       145.34800720214844 347620.03125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727268480000        ETHUSDT    1          1727268480000 2620.840087890625 2620.840087890625 2619.419921875 2619.419921875 221.79629516601562 581115.6875 2224       15.76200008392334 41295.98828125 12         6          1.2246468525851679e-16 -1.0       -0.7818315029144287 0.6234897971153259

2024-10-04 15:58:30,864 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:58:30,864 - INFO - ------------------------
2024-10-04 15:58:32,905 - INFO - Updating data for ETHUSDT from 1728046200001 to 1728046500000 (2024-10-04 12:50:00 to 2024-10-04 12:55:00)
2024-10-04 15:58:33,282 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 15:58:33,283 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728046500000        ETHUSDT    5          1728046500000 2390.179931640625 2393.81005859375 2389.5     2392.580078125 1321.78662109375 3161277.0  15856      667.969482421875 1597427.125 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726491000000        ETHUSDT    5          1726491000000 2302.260009765625 2302.27001953125 2299.199951171875 2299.35009765625 660.5599975585938 1519475.375 4962       370.7427062988281 852824.5   12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:58:33,915 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:58:33,915 - INFO - ------------------------
2024-10-04 15:58:35,257 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 15:58:35,258 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045900000        ETHUSDT    15         1728045900000 2375.60009765625 2384.909912109375 2375.60009765625 2384.800048828125 1364.68798828125 3250089.25 9782       986.4075927734375 2349053.25 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724936400000        ETHUSDT    15         1724936400000 2572.909912109375 2578.14990234375 2568.010009765625 2573.199951171875 1831.93408203125 4713244.0  13226      850.910400390625 2189454.0  13         0          -0.258819043636322 -0.9659258127212524 0.0        1.0       

2024-10-04 15:58:35,898 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:58:35,899 - INFO - ------------------------
2024-10-04 15:58:37,938 - INFO - Updating data for BTCUSDT from 1728046260001 to 1728046680000 (2024-10-04 12:51:00 to 2024-10-04 12:58:00)
2024-10-04 15:58:38,355 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 15:58:38,356 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728046680000        BTCUSDT    1          1728046680000 61835.05078125 61880.0    61817.640625 61854.0    52.073509216308594 3220822.5  5255       32.31986999511719 1999085.625 12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1727268480000        BTCUSDT    1          1727268480000 63689.0703125 63689.0703125 63661.76953125 63669.98828125 6.734029769897461 428783.15625 3629       2.164210081100464 137790.15625 12         6          1.2246468525851679e-16 -1.0       -0.7818315029144287 0.6234897971153259

2024-10-04 15:58:38,992 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:58:38,992 - INFO - ------------------------
2024-10-04 15:58:41,032 - INFO - Updating data for BTCUSDT from 1728046200001 to 1728046500000 (2024-10-04 12:50:00 to 2024-10-04 12:55:00)
2024-10-04 15:58:41,406 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 15:58:41,407 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728046500000        BTCUSDT    5          1728046500000 61754.0    61880.0    61746.171875 61855.98828125 189.7316131591797 11728943.0 19540      116.97662353515625 7231298.0  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1726491000000        BTCUSDT    5          1726491000000 58551.98828125 58555.98828125 58480.0    58511.62109375 46.83795166015625 2740545.0  15076      23.646350860595703 1383530.75 12         4          1.2246468525851679e-16 -1.0       -0.4338837265968323 -0.9009688496589661

2024-10-04 15:58:42,037 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:58:42,037 - INFO - ------------------------
2024-10-04 15:58:43,376 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 15:58:43,377 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728045900000        BTCUSDT    15         1728045900000 61363.62890625 61630.66015625 61363.62890625 61606.0703125 171.20924377441406 10534151.0 17300      124.01155090332031 7629538.0  12         1          1.2246468525851679e-16 -1.0       0.7818315029144287 0.6234897971153259
Last                 1724936400000        BTCUSDT    15         1724936400000 60321.98828125 60450.0    60282.28125 60419.98828125 361.11895751953125 21803686.0 23052      189.83949279785156 11463633.0 13         0          -0.258819043636322 -0.9659258127212524 0.0        1.0       

2024-10-04 15:58:44,013 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 15:58:44,013 - INFO - ------------------------
2024-10-04 15:58:45,014 - INFO - All files have been updated with the latest prices.
2024-10-04 15:58:45,044 - INFO - Latest dataset loaded with 300 records.
2024-10-04 15:58:45,123 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 16:07:28,872 - INFO - Logging is set up.
2024-10-04 16:07:28,872 - INFO - Using device: cuda
2024-10-04 16:07:28,872 - INFO - Numerical columns for scaling: ['open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 16:07:28,872 - INFO - Categorical columns: ['symbol', 'interval']
2024-10-04 16:07:28,912 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 16:07:28,935 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 16:07:28,936 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 16:07:29,381 - WARNING - Model file models/enhanced_bilstm_model_ETHUSDT_v2.0.pth not found. A new model will be created.
2024-10-04 16:07:29,913 - INFO - Sample training inputs:
2024-10-04 16:07:29,913 - INFO - [[[ 0.0000000e+00  0.0000000e+00  1.7278479e+12 ...  2.5881904e-01
   -7.8183150e-01  6.2348980e-01]
  [ 0.0000000e+00  2.0000000e+00  1.7278479e+12 ...  2.5881904e-01
   -7.8183150e-01  6.2348980e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7278479e+12 ...  2.5881904e-01
   -7.8183150e-01  6.2348980e-01]
  ...
  [ 1.0000000e+00  0.0000000e+00  1.7278549e+12 ... -2.5881904e-01
   -7.8183150e-01  6.2348980e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7278549e+12 ... -2.5881904e-01
   -7.8183150e-01  6.2348980e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7278549e+12 ... -2.5881904e-01
   -7.8183150e-01  6.2348980e-01]]

 [[ 0.0000000e+00  0.0000000e+00  1.7274727e+12 ...  7.0710677e-01
    7.8183150e-01  6.2348980e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7274727e+12 ...  7.0710677e-01
    7.8183150e-01  6.2348980e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7274727e+12 ...  7.0710677e-01
    7.8183150e-01  6.2348980e-01]
  ...
  [ 1.0000000e+00  0.0000000e+00  1.7274798e+12 ...  9.6592581e-01
    7.8183150e-01  6.2348980e-01]
  [ 1.0000000e+00  2.0000000e+00  1.7274798e+12 ...  9.6592581e-01
    7.8183150e-01  6.2348980e-01]
  [ 1.0000000e+00  1.0000000e+00  1.7274798e+12 ...  9.6592581e-01
    7.8183150e-01  6.2348980e-01]]

 [[ 0.0000000e+00  0.0000000e+00  1.7273651e+12 ... -7.0710677e-01
    0.0000000e+00  1.0000000e+00]
  [ 1.0000000e+00  0.0000000e+00  1.7273651e+12 ... -7.0710677e-01
    0.0000000e+00  1.0000000e+00]
  [ 0.0000000e+00  0.0000000e+00  1.7273651e+12 ... -7.0710677e-01
    0.0000000e+00  1.0000000e+00]
  ...
  [ 1.0000000e+00  1.0000000e+00  1.7273721e+12 ... -2.5881904e-01
    0.0000000e+00  1.0000000e+00]
  [ 1.0000000e+00  0.0000000e+00  1.7273721e+12 ... -2.5881904e-01
    0.0000000e+00  1.0000000e+00]
  [ 0.0000000e+00  1.0000000e+00  1.7273721e+12 ... -2.5881904e-01
    0.0000000e+00  1.0000000e+00]]]
2024-10-04 16:07:30,131 - INFO - Sample training outputs:
2024-10-04 16:07:30,131 - INFO - [[-0.0113416   0.01722578 -0.07544848  0.02186772 -0.03155772  0.02877774
  -0.05351254  0.03113323 -0.03967264]
 [-0.00664271  0.02456075 -0.07536914  0.0244481  -0.02946066  0.02933392
  -0.05119304  0.02801422 -0.03713232]
 [-0.0070253   0.02454976 -0.07485814  0.02310373 -0.02608133  0.02944531
  -0.04992103  0.03274524 -0.03734813]]
2024-10-04 16:07:51,964 - INFO - Epoch 1/5 - Loss: 8589442230954.6670
2024-10-04 16:07:52,041 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 16:07:52,041 - INFO - Validation loss improved to 8589442230954.6670. Model saved.
2024-10-04 16:07:52,132 - INFO - Sample training inputs:
2024-10-04 16:07:52,132 - INFO - [[[ 0.0000000e+00  0.0000000e+00  1.7276085e+12 ... -9.6592581e-01
    4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7276085e+12 ... -9.6592581e-01
    4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7276087e+12 ... -9.6592581e-01
    4.3388373e-01 -9.0096885e-01]
  ...
  [ 0.0000000e+00  0.0000000e+00  1.7276156e+12 ... -9.6592581e-01
    4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7276157e+12 ... -9.6592581e-01
    4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  1.0000000e+00  1.7276157e+12 ... -9.6592581e-01
    4.3388373e-01 -9.0096885e-01]]

 [[ 0.0000000e+00  0.0000000e+00  1.7276463e+12 ...  7.0710677e-01
    4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  2.0000000e+00  1.7276463e+12 ...  7.0710677e-01
    4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7276463e+12 ...  7.0710677e-01
    4.3388373e-01 -9.0096885e-01]
  ...
  [ 0.0000000e+00  0.0000000e+00  1.7276532e+12 ...  9.6592581e-01
    4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7276533e+12 ...  9.6592581e-01
    4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7276533e+12 ...  9.6592581e-01
    4.3388373e-01 -9.0096885e-01]]

 [[ 1.0000000e+00  2.0000000e+00  1.7265249e+12 ...  8.6602539e-01
   -4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  1.0000000e+00  1.7265252e+12 ...  8.6602539e-01
   -4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  1.0000000e+00  1.7265252e+12 ...  8.6602539e-01
   -4.3388373e-01 -9.0096885e-01]
  ...
  [ 1.0000000e+00  1.0000000e+00  1.7265585e+12 ... -2.5881904e-01
   -9.7492790e-01 -2.2252093e-01]
  [ 0.0000000e+00  1.0000000e+00  1.7265585e+12 ... -2.5881904e-01
   -9.7492790e-01 -2.2252093e-01]
  [ 0.0000000e+00  1.0000000e+00  1.7265588e+12 ... -2.5881904e-01
   -9.7492790e-01 -2.2252093e-01]]]
2024-10-04 16:07:52,147 - INFO - Sample training outputs:
2024-10-04 16:07:52,180 - INFO - [[44.813488 45.130726 44.54419  43.1686   44.13929  66.61034  42.186367
  40.648422 52.432625]
 [44.813614 45.13017  44.544086 43.16828  44.138893 66.60995  42.18564
  40.64845  52.432743]
 [44.81368  45.130375 44.544357 43.168343 44.13919  66.61013  42.18581
  40.64848  52.43276 ]]
2024-10-04 16:08:12,992 - INFO - Epoch 2/5 - Loss: 8584306325991.6191
2024-10-04 16:08:13,073 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 16:08:13,074 - INFO - Validation loss improved to 8584306325991.6191. Model saved.
2024-10-04 16:08:13,168 - INFO - Sample training inputs:
2024-10-04 16:08:13,169 - INFO - [[[ 1.0000000e+00  2.0000000e+00  1.7257392e+12 ...  5.0000000e-01
    9.7492790e-01 -2.2252093e-01]
  [ 0.0000000e+00  2.0000000e+00  1.7257392e+12 ...  5.0000000e-01
    9.7492790e-01 -2.2252093e-01]
  [ 1.0000000e+00  2.0000000e+00  1.7257401e+12 ...  5.0000000e-01
    9.7492790e-01 -2.2252093e-01]
  ...
  [ 1.0000000e+00  2.0000000e+00  1.7258723e+12 ... -7.0710677e-01
   -4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  2.0000000e+00  1.7258733e+12 ... -7.0710677e-01
   -4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  2.0000000e+00  1.7258733e+12 ... -7.0710677e-01
   -4.3388373e-01 -9.0096885e-01]]

 [[ 1.0000000e+00  0.0000000e+00  1.7272768e+12 ... -7.0710677e-01
   -7.8183150e-01  6.2348980e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7272768e+12 ... -7.0710677e-01
   -7.8183150e-01  6.2348980e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7272769e+12 ... -7.0710677e-01
   -7.8183150e-01  6.2348980e-01]
  ...
  [ 0.0000000e+00  0.0000000e+00  1.7272839e+12 ... -2.5881904e-01
   -7.8183150e-01  6.2348980e-01]
  [ 0.0000000e+00  1.0000000e+00  1.7272839e+12 ... -2.5881904e-01
   -7.8183150e-01  6.2348980e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7272839e+12 ... -2.5881904e-01
   -7.8183150e-01  6.2348980e-01]]

 [[ 1.0000000e+00  2.0000000e+00  1.7262504e+12 ... -1.8369701e-16
    7.8183150e-01  6.2348980e-01]
  [ 0.0000000e+00  2.0000000e+00  1.7262504e+12 ... -1.8369701e-16
    7.8183150e-01  6.2348980e-01]
  [ 0.0000000e+00  2.0000000e+00  1.7262513e+12 ... -1.8369701e-16
    7.8183150e-01  6.2348980e-01]
  ...
  [ 1.0000000e+00  2.0000000e+00  1.7263837e+12 ... -2.5881904e-01
    4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  2.0000000e+00  1.7263844e+12 ... -2.5881904e-01
    4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  2.0000000e+00  1.7263844e+12 ... -2.5881904e-01
    4.3388373e-01 -9.0096885e-01]]]
2024-10-04 16:08:13,184 - INFO - Sample training outputs:
2024-10-04 16:08:13,216 - INFO - [[ 88.67324   88.894005  88.40457   86.79055   84.30611  110.01626
   85.6402    77.33985   95.74132 ]
 [ 88.67369   88.89395   88.405174  86.790306  84.30628  110.016266
   85.63963   77.33985   95.74163 ]
 [ 88.67354   88.893906  88.405014  86.79021   84.306335 110.01627
   85.63991   77.3399    95.74157 ]]
2024-10-04 16:08:34,936 - INFO - Epoch 3/5 - Loss: 8609179807939.0479
2024-10-04 16:08:34,936 - INFO - No improvement in validation loss. (1/5)
2024-10-04 16:08:34,936 - INFO - Reducing learning rate to: 0.00025
2024-10-04 16:08:35,026 - INFO - Sample training inputs:
2024-10-04 16:08:35,026 - INFO - [[[ 1.0000000e+00  0.0000000e+00  1.7276241e+12 ... -7.0710677e-01
    4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7276242e+12 ... -7.0710677e-01
    4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7276242e+12 ... -7.0710677e-01
    4.3388373e-01 -9.0096885e-01]
  ...
  [ 1.0000000e+00  0.0000000e+00  1.7276312e+12 ... -2.5881904e-01
    4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7276312e+12 ... -2.5881904e-01
    4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  1.0000000e+00  1.7276313e+12 ... -2.5881904e-01
    4.3388373e-01 -9.0096885e-01]]

 [[ 1.0000000e+00  0.0000000e+00  1.7277222e+12 ... -1.8369701e-16
   -4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7277222e+12 ... -1.8369701e-16
   -4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7277223e+12 ... -1.8369701e-16
   -4.3388373e-01 -9.0096885e-01]
  ...
  [ 1.0000000e+00  0.0000000e+00  1.7277292e+12 ...  5.0000000e-01
   -4.3388373e-01 -9.0096885e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7277292e+12 ...  5.0000000e-01
   -4.3388373e-01 -9.0096885e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7277292e+12 ...  5.0000000e-01
   -4.3388373e-01 -9.0096885e-01]]

 [[ 1.0000000e+00  0.0000000e+00  1.7273118e+12 ...  1.0000000e+00
    0.0000000e+00  1.0000000e+00]
  [ 1.0000000e+00  0.0000000e+00  1.7273118e+12 ...  1.0000000e+00
    0.0000000e+00  1.0000000e+00]
  [ 0.0000000e+00  1.0000000e+00  1.7273118e+12 ...  1.0000000e+00
    0.0000000e+00  1.0000000e+00]
  ...
  [ 1.0000000e+00  0.0000000e+00  1.7273187e+12 ...  8.6602539e-01
    0.0000000e+00  1.0000000e+00]
  [ 0.0000000e+00  0.0000000e+00  1.7273187e+12 ...  8.6602539e-01
    0.0000000e+00  1.0000000e+00]
  [ 0.0000000e+00  0.0000000e+00  1.7273189e+12 ...  8.6602539e-01
    0.0000000e+00  1.0000000e+00]]]
2024-10-04 16:08:35,042 - INFO - Sample training outputs:
2024-10-04 16:08:35,073 - INFO - [[131.92421  132.14442  131.65541  130.04086  121.55812  152.91098
  128.505    108.421036 138.60095 ]
 [131.9246   132.1447   131.65578  130.04109  121.55818  152.91121
  128.50511  108.421234 138.60129 ]
 [131.92462  132.14467  131.6558   130.04097  121.55828  152.91103
  128.50484  108.42132  138.60138 ]]
2024-10-04 16:08:56,732 - INFO - Epoch 4/5 - Loss: 8602888191219.8096
2024-10-04 16:08:56,732 - INFO - No improvement in validation loss. (2/5)
2024-10-04 16:08:56,732 - INFO - Reducing learning rate to: 0.000125
2024-10-04 16:08:56,832 - INFO - Sample training inputs:
2024-10-04 16:08:56,832 - INFO - [[[ 1.0000000e+00  2.0000000e+00  1.7265457e+12 ...  5.0000000e-01
   -9.7492790e-01 -2.2252093e-01]
  [ 0.0000000e+00  1.0000000e+00  1.7265457e+12 ...  5.0000000e-01
   -9.7492790e-01 -2.2252093e-01]
  [ 0.0000000e+00  2.0000000e+00  1.7265457e+12 ...  5.0000000e-01
   -9.7492790e-01 -2.2252093e-01]
  ...
  [ 0.0000000e+00  2.0000000e+00  1.7265790e+12 ... -9.6592581e-01
   -9.7492790e-01 -2.2252093e-01]
  [ 1.0000000e+00  1.0000000e+00  1.7265790e+12 ... -9.6592581e-01
   -9.7492790e-01 -2.2252093e-01]
  [ 1.0000000e+00  2.0000000e+00  1.7265790e+12 ... -9.6592581e-01
   -9.7492790e-01 -2.2252093e-01]]

 [[ 0.0000000e+00  0.0000000e+00  1.7279726e+12 ... -5.0000000e-01
    0.0000000e+00  1.0000000e+00]
  [ 1.0000000e+00  0.0000000e+00  1.7279726e+12 ... -5.0000000e-01
    0.0000000e+00  1.0000000e+00]
  [ 0.0000000e+00  1.0000000e+00  1.7279726e+12 ... -5.0000000e-01
    0.0000000e+00  1.0000000e+00]
  ...
  [ 0.0000000e+00  0.0000000e+00  1.7279797e+12 ... -1.8369701e-16
    0.0000000e+00  1.0000000e+00]
  [ 1.0000000e+00  0.0000000e+00  1.7279797e+12 ... -1.8369701e-16
    0.0000000e+00  1.0000000e+00]
  [ 0.0000000e+00  0.0000000e+00  1.7279797e+12 ... -1.8369701e-16
    0.0000000e+00  1.0000000e+00]]

 [[ 1.0000000e+00  1.0000000e+00  1.7277426e+12 ...  1.0000000e+00
   -9.7492790e-01 -2.2252093e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7277426e+12 ...  1.0000000e+00
   -9.7492790e-01 -2.2252093e-01]
  [ 0.0000000e+00  2.0000000e+00  1.7277426e+12 ...  1.0000000e+00
   -9.7492790e-01 -2.2252093e-01]
  ...
  [ 1.0000000e+00  0.0000000e+00  1.7277497e+12 ...  8.6602539e-01
   -9.7492790e-01 -2.2252093e-01]
  [ 0.0000000e+00  0.0000000e+00  1.7277497e+12 ...  8.6602539e-01
   -9.7492790e-01 -2.2252093e-01]
  [ 1.0000000e+00  0.0000000e+00  1.7277497e+12 ...  8.6602539e-01
   -9.7492790e-01 -2.2252093e-01]]]
2024-10-04 16:08:56,847 - INFO - Sample training outputs:
2024-10-04 16:08:56,881 - INFO - [[153.63124 153.60669 153.4016  151.68571 139.74321 174.5133  149.92789
  122.53675 160.02313]
 [153.63112 153.6067  153.4016  151.68578 139.74347 174.51344 149.92805
  122.53678 160.02321]
 [153.63129 153.60681 153.40181 151.68576 139.74347 174.5133  149.92783
  122.53671 160.02327]]
2024-10-04 16:09:17,790 - INFO - Epoch 5/5 - Loss: 8595292007082.6670
2024-10-04 16:09:17,790 - INFO - No improvement in validation loss. (3/5)
2024-10-04 16:09:17,790 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 16:09:17,790 - INFO - Script started
2024-10-04 17:19:33,333 - INFO - Logging is set up.
2024-10-04 17:19:33,334 - INFO - Using device: cuda
2024-10-04 17:19:33,334 - INFO - Numerical columns for scaling: ['open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:19:33,334 - INFO - Categorical columns: ['symbol', 'interval']
2024-10-04 17:19:33,386 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:19:33,427 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:19:33,427 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:19:34,336 - WARNING - Model file models/enhanced_bilstm_model_ETHUSDT_v2.0.pth not found. A new model will be created.
2024-10-04 17:19:56,857 - INFO - Epoch 1/5 - Loss: 0.9825
2024-10-04 17:19:56,934 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:19:56,934 - INFO - Validation loss improved to 0.9825. Model saved.
2024-10-04 17:20:18,768 - INFO - Epoch 2/5 - Loss: 0.9822
2024-10-04 17:20:18,853 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:20:18,853 - INFO - Validation loss improved to 0.9822. Model saved.
2024-10-04 17:20:39,859 - INFO - Epoch 3/5 - Loss: 0.9824
2024-10-04 17:20:39,859 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:20:39,859 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:21:01,560 - INFO - Epoch 4/5 - Loss: 0.9825
2024-10-04 17:21:01,560 - INFO - No improvement in validation loss. (2/5)
2024-10-04 17:21:01,560 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:21:23,433 - INFO - Epoch 5/5 - Loss: 0.9817
2024-10-04 17:21:23,521 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:21:23,522 - INFO - Validation loss improved to 0.9817. Model saved.
2024-10-04 17:21:23,522 - INFO - Script started
2024-10-04 17:21:23,891 - INFO - Binance API is available. Server time: 2024-10-04 14:21:23
2024-10-04 17:21:24,954 - INFO - Updating data for ETHUSDT from 1728051480001 to 1728051660000 (2024-10-04 14:18:00 to 2024-10-04 14:21:00)
2024-10-04 17:21:25,388 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:21:25,389 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051660000        ETHUSDT    1          1728051660000 2374.7900390625 2375.39990234375 2372.0     2373.5     114.52159881591797 271816.6875 2054.0     89.71640014648438 212942.109375 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:21:26,064 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:21:26,064 - INFO - ------------------------
2024-10-04 17:21:28,066 - INFO - Updating data for ETHUSDT from 1728051300001 to 1728051600000 (2024-10-04 14:15:00 to 2024-10-04 14:20:00)
2024-10-04 17:21:28,439 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 17:21:28,439 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051600000        ETHUSDT    5          1728051600000 2376.360107421875 2376.360107421875 2372.0     2374.39990234375 357.81390380859375 849498.6875 6244.0     249.3592071533203 591998.4375 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:21:29,095 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:21:29,095 - INFO - ------------------------
2024-10-04 17:21:30,441 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:21:30,442 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        ETHUSDT    15         1728051300000 2373.10009765625 2375.669921875 2372.1298828125 2374.989990234375 249.63560485839844 592680.3125 9865.0     166.743896484375 395888.625 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:21:31,100 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:21:31,100 - INFO - ------------------------
2024-10-04 17:21:33,148 - INFO - Updating data for BTCUSDT from 1728051480001 to 1728051660000 (2024-10-04 14:18:00 to 2024-10-04 14:21:00)
2024-10-04 17:21:33,574 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:21:33,575 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051660000        BTCUSDT    1          1728051660000 61347.98828125 61360.0    61282.0    61360.0    9.735489845275879 596999.0   5134.0     4.963469982147217 304372.15625 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:21:34,237 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:21:34,238 - INFO - ------------------------
2024-10-04 17:21:36,274 - INFO - Updating data for BTCUSDT from 1728051300001 to 1728051600000 (2024-10-04 14:15:00 to 2024-10-04 14:20:00)
2024-10-04 17:21:36,654 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 17:21:36,654 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051600000        BTCUSDT    5          1728051600000 61416.0    61418.0    61282.0    61352.0    35.268489837646484 2163683.5  13720.0    15.517330169677734 951922.25  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:21:37,316 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:21:37,316 - INFO - ------------------------
2024-10-04 17:21:38,661 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:21:38,662 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        BTCUSDT    15         1728051300000 61300.0    61400.0    61279.91015625 61400.0    48.9693603515625 3003852.25 20273.0    32.608089447021484 2000422.0  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:21:39,320 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:21:39,320 - INFO - ------------------------
2024-10-04 17:21:40,320 - INFO - All files have been updated with the latest prices.
2024-10-04 17:21:40,352 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:21:40,439 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:21:40,440 - INFO - Logging is set up.
2024-10-04 17:21:40,441 - INFO - Using device: cuda
2024-10-04 17:21:40,481 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:21:40,505 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:21:40,505 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:21:40,682 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:21:40,682 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:22:03,086 - INFO - Epoch 1/5 - Loss: 0.9819
2024-10-04 17:22:03,169 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:22:03,169 - INFO - Validation loss improved to 0.9819. Model saved.
2024-10-04 17:22:25,024 - INFO - Epoch 2/5 - Loss: 0.9831
2024-10-04 17:22:25,024 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:22:25,024 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:22:46,056 - INFO - Epoch 3/5 - Loss: 0.9826
2024-10-04 17:22:46,056 - INFO - No improvement in validation loss. (2/5)
2024-10-04 17:22:46,056 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:23:07,987 - INFO - Epoch 4/5 - Loss: 0.9818
2024-10-04 17:23:08,068 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:23:08,068 - INFO - Validation loss improved to 0.9818. Model saved.
2024-10-04 17:23:29,475 - INFO - Epoch 5/5 - Loss: 0.9816
2024-10-04 17:23:29,561 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:23:29,562 - INFO - Validation loss improved to 0.9816. Model saved.
2024-10-04 17:23:29,562 - INFO - Script started
2024-10-04 17:23:29,982 - INFO - Binance API is available. Server time: 2024-10-04 14:23:30
2024-10-04 17:23:31,211 - INFO - Updating data for ETHUSDT from 1728051660001 to 1728051780000 (2024-10-04 14:21:00 to 2024-10-04 14:23:00)
2024-10-04 17:23:31,692 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:23:31,692 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051780000        ETHUSDT    1          1728051780000 2370.570068359375 2370.719970703125 2368.5     2369.989990234375 126.48760223388672 299725.96875 1834.0     56.684898376464844 134301.25  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:23:32,480 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:23:32,480 - INFO - ------------------------
2024-10-04 17:23:33,884 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:23:33,884 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051600000        ETHUSDT    5          1728051600000 2376.360107421875 2376.360107421875 2372.0     2374.39990234375 357.81390380859375 849498.6875 6244.0     249.3592071533203 591998.4375 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:23:34,624 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:23:34,624 - INFO - ------------------------
2024-10-04 17:23:35,978 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:23:35,978 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        ETHUSDT    15         1728051300000 2373.10009765625 2375.669921875 2372.1298828125 2374.989990234375 249.63560485839844 592680.3125 9865.0     166.743896484375 395888.625 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:23:36,597 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:23:36,597 - INFO - ------------------------
2024-10-04 17:23:38,576 - INFO - Updating data for BTCUSDT from 1728051660001 to 1728051780000 (2024-10-04 14:21:00 to 2024-10-04 14:23:00)
2024-10-04 17:23:38,976 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:23:38,977 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051780000        BTCUSDT    1          1728051780000 61237.98828125 61237.98828125 61180.109375 61180.12109375 10.81011962890625 661742.375 7075.0     2.769740104675293 169545.328125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:23:39,600 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:23:39,600 - INFO - ------------------------
2024-10-04 17:23:40,924 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:23:40,924 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051600000        BTCUSDT    5          1728051600000 61416.0    61418.0    61282.0    61352.0    35.268489837646484 2163683.5  13720.0    15.517330169677734 951922.25  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:23:41,543 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:23:41,543 - INFO - ------------------------
2024-10-04 17:23:42,870 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:23:42,870 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        BTCUSDT    15         1728051300000 61300.0    61400.0    61279.91015625 61400.0    48.9693603515625 3003852.25 20273.0    32.608089447021484 2000422.0  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:23:43,490 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:23:43,490 - INFO - ------------------------
2024-10-04 17:23:44,490 - INFO - All files have been updated with the latest prices.
2024-10-04 17:23:44,518 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:23:44,599 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:23:44,600 - INFO - Logging is set up.
2024-10-04 17:23:44,600 - INFO - Using device: cuda
2024-10-04 17:23:44,638 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:23:44,661 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:23:44,661 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:23:44,838 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:23:44,838 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:24:07,433 - INFO - Epoch 1/5 - Loss: 0.9825
2024-10-04 17:24:07,519 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:24:07,519 - INFO - Validation loss improved to 0.9825. Model saved.
2024-10-04 17:24:28,793 - INFO - Epoch 2/5 - Loss: 0.9832
2024-10-04 17:24:28,793 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:24:28,793 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:24:50,533 - INFO - Epoch 3/5 - Loss: 0.9818
2024-10-04 17:24:50,620 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:24:50,620 - INFO - Validation loss improved to 0.9818. Model saved.
2024-10-04 17:25:12,438 - INFO - Epoch 4/5 - Loss: 0.9817
2024-10-04 17:25:12,522 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:25:12,522 - INFO - Validation loss improved to 0.9817. Model saved.
2024-10-04 17:25:33,760 - INFO - Epoch 5/5 - Loss: 0.9820
2024-10-04 17:25:33,760 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:25:33,760 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:25:33,761 - INFO - Script started
2024-10-04 17:25:34,118 - INFO - Binance API is available. Server time: 2024-10-04 14:25:34
2024-10-04 17:25:35,154 - INFO - Updating data for ETHUSDT from 1728051780001 to 1728051900000 (2024-10-04 14:23:00 to 2024-10-04 14:25:00)
2024-10-04 17:25:35,580 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:25:35,580 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051900000        ETHUSDT    1          1728051900000 2362.919921875 2364.280029296875 2361.489990234375 2363.719970703125 810.5147094726562 1915367.25 2499.0     612.9661254882812 1448604.25 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:25:36,304 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:25:36,305 - INFO - ------------------------
2024-10-04 17:25:38,342 - INFO - Updating data for ETHUSDT from 1728051600001 to 1728051900000 (2024-10-04 14:20:00 to 2024-10-04 14:25:00)
2024-10-04 17:25:38,720 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 17:25:38,721 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051900000        ETHUSDT    5          1728051900000 2362.919921875 2364.280029296875 2361.489990234375 2363.969970703125 820.4248046875 1938791.125 2586.0     622.1550903320312 1470323.5  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:25:39,382 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:25:39,382 - INFO - ------------------------
2024-10-04 17:25:41,191 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:25:41,191 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        ETHUSDT    15         1728051300000 2373.10009765625 2375.669921875 2372.1298828125 2374.989990234375 249.63560485839844 592680.3125 9865.0     166.743896484375 395888.625 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:25:41,844 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:25:41,844 - INFO - ------------------------
2024-10-04 17:25:43,897 - INFO - Updating data for BTCUSDT from 1728051780001 to 1728051900000 (2024-10-04 14:23:00 to 2024-10-04 14:25:00)
2024-10-04 17:25:44,329 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:25:44,329 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051900000        BTCUSDT    1          1728051900000 61061.1015625 61142.0    61057.8203125 61124.0    69.1726303100586 4225870.0  8447.0     18.762319564819336 1146269.125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:25:44,987 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:25:44,987 - INFO - ------------------------
2024-10-04 17:25:47,010 - INFO - Updating data for BTCUSDT from 1728051600001 to 1728051900000 (2024-10-04 14:20:00 to 2024-10-04 14:25:00)
2024-10-04 17:25:47,394 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 17:25:47,394 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051900000        BTCUSDT    5          1728051900000 61061.1015625 61142.0    61057.8203125 61134.0    69.65895080566406 4255598.0  9113.0     19.20479965209961 1173317.0  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:25:48,052 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:25:48,052 - INFO - ------------------------
2024-10-04 17:25:49,397 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:25:49,398 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        BTCUSDT    15         1728051300000 61300.0    61400.0    61279.91015625 61400.0    48.9693603515625 3003852.25 20273.0    32.608089447021484 2000422.0  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:25:50,064 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:25:50,064 - INFO - ------------------------
2024-10-04 17:25:51,065 - INFO - All files have been updated with the latest prices.
2024-10-04 17:25:51,094 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:25:51,172 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:25:51,173 - INFO - Logging is set up.
2024-10-04 17:25:51,173 - INFO - Using device: cuda
2024-10-04 17:25:51,212 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:25:51,236 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:25:51,236 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:25:51,408 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:25:51,409 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:26:13,786 - INFO - Epoch 1/5 - Loss: 0.9817
2024-10-04 17:26:13,873 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:26:13,873 - INFO - Validation loss improved to 0.9817. Model saved.
2024-10-04 17:26:35,114 - INFO - Epoch 2/5 - Loss: 0.9819
2024-10-04 17:26:35,114 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:26:35,114 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:26:56,825 - INFO - Epoch 3/5 - Loss: 0.9817
2024-10-04 17:26:56,825 - INFO - No improvement in validation loss. (2/5)
2024-10-04 17:26:56,826 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:27:18,003 - INFO - Epoch 4/5 - Loss: 0.9819
2024-10-04 17:27:18,003 - INFO - No improvement in validation loss. (3/5)
2024-10-04 17:27:18,004 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 17:27:39,834 - INFO - Epoch 5/5 - Loss: 0.9820
2024-10-04 17:27:39,834 - INFO - No improvement in validation loss. (4/5)
2024-10-04 17:27:39,834 - INFO - Reducing learning rate to: 3.125e-05
2024-10-04 17:27:39,835 - INFO - Script started
2024-10-04 17:27:40,186 - INFO - Binance API is available. Server time: 2024-10-04 14:27:40
2024-10-04 17:27:41,226 - INFO - Updating data for ETHUSDT from 1728051900001 to 1728052020000 (2024-10-04 14:25:00 to 2024-10-04 14:27:00)
2024-10-04 17:27:41,651 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:27:41,652 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052020000        ETHUSDT    1          1728052020000 2358.2099609375 2358.31005859375 2352.93994140625 2355.47998046875 1250.4193115234375 2945897.75 4373.0     531.9307861328125 1253251.5  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:27:42,346 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:27:42,346 - INFO - ------------------------
2024-10-04 17:27:43,693 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:27:43,693 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051900000        ETHUSDT    5          1728051900000 2362.919921875 2364.280029296875 2361.489990234375 2363.969970703125 820.4248046875 1938791.125 2586.0     622.1550903320312 1470323.5  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:27:44,358 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:27:44,358 - INFO - ------------------------
2024-10-04 17:27:45,703 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:27:45,703 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        ETHUSDT    15         1728051300000 2373.10009765625 2375.669921875 2372.1298828125 2374.989990234375 249.63560485839844 592680.3125 9865.0     166.743896484375 395888.625 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:27:46,360 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:27:46,361 - INFO - ------------------------
2024-10-04 17:27:48,401 - INFO - Updating data for BTCUSDT from 1728051900001 to 1728052020000 (2024-10-04 14:25:00 to 2024-10-04 14:27:00)
2024-10-04 17:27:48,828 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:27:48,829 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052020000        BTCUSDT    1          1728052020000 60984.01171875 60984.01171875 60861.109375 60862.5    104.69319915771484 6377294.5  12916.0    42.905670166015625 2613460.25 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:27:49,576 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:27:49,576 - INFO - ------------------------
2024-10-04 17:27:50,922 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:27:50,923 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051900000        BTCUSDT    5          1728051900000 61061.1015625 61142.0    61057.8203125 61134.0    69.65895080566406 4255598.0  9113.0     19.20479965209961 1173317.0  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:27:52,071 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:27:52,071 - INFO - ------------------------
2024-10-04 17:27:53,422 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:27:53,423 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        BTCUSDT    15         1728051300000 61300.0    61400.0    61279.91015625 61400.0    48.9693603515625 3003852.25 20273.0    32.608089447021484 2000422.0  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:27:54,093 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:27:54,093 - INFO - ------------------------
2024-10-04 17:27:55,093 - INFO - All files have been updated with the latest prices.
2024-10-04 17:27:55,123 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:27:55,203 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:27:55,204 - INFO - Logging is set up.
2024-10-04 17:27:55,204 - INFO - Using device: cuda
2024-10-04 17:27:55,243 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:27:55,267 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:27:55,267 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:27:55,457 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:27:55,457 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:28:17,325 - INFO - Epoch 1/5 - Loss: 0.9826
2024-10-04 17:28:17,410 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:28:17,410 - INFO - Validation loss improved to 0.9826. Model saved.
2024-10-04 17:28:39,198 - INFO - Epoch 2/5 - Loss: 0.9816
2024-10-04 17:28:39,282 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:28:39,282 - INFO - Validation loss improved to 0.9816. Model saved.
2024-10-04 17:29:01,020 - INFO - Epoch 3/5 - Loss: 0.9848
2024-10-04 17:29:01,021 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:29:01,021 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:29:22,242 - INFO - Epoch 4/5 - Loss: 0.9819
2024-10-04 17:29:22,242 - INFO - No improvement in validation loss. (2/5)
2024-10-04 17:29:22,242 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:29:44,021 - INFO - Epoch 5/5 - Loss: 0.9819
2024-10-04 17:29:44,022 - INFO - No improvement in validation loss. (3/5)
2024-10-04 17:29:44,022 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 17:29:44,022 - INFO - Script started
2024-10-04 17:29:44,430 - INFO - Binance API is available. Server time: 2024-10-04 14:29:44
2024-10-04 17:29:45,473 - INFO - Updating data for ETHUSDT from 1728052020001 to 1728052140000 (2024-10-04 14:27:00 to 2024-10-04 14:29:00)
2024-10-04 17:29:45,904 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:29:45,904 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052140000        ETHUSDT    1          1728052140000 2356.18994140625 2360.60009765625 2354.800048828125 2360.60009765625 736.539306640625 1736979.75 3794.0     417.56329345703125 985021.0625 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:29:46,629 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:29:46,630 - INFO - ------------------------
2024-10-04 17:29:47,979 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:29:47,979 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051900000        ETHUSDT    5          1728051900000 2362.919921875 2364.280029296875 2361.489990234375 2363.969970703125 820.4248046875 1938791.125 2586.0     622.1550903320312 1470323.5  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:29:48,657 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:29:48,657 - INFO - ------------------------
2024-10-04 17:29:49,998 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:29:49,998 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        ETHUSDT    15         1728051300000 2373.10009765625 2375.669921875 2372.1298828125 2374.989990234375 249.63560485839844 592680.3125 9865.0     166.743896484375 395888.625 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:29:50,657 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:29:50,657 - INFO - ------------------------
2024-10-04 17:29:52,701 - INFO - Updating data for BTCUSDT from 1728052020001 to 1728052140000 (2024-10-04 14:27:00 to 2024-10-04 14:29:00)
2024-10-04 17:29:53,130 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:29:53,131 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052140000        BTCUSDT    1          1728052140000 60940.08984375 60994.0    60908.0    60970.0    43.684391021728516 2663057.0  8258.0     23.033580780029297 1404254.75 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:29:53,797 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:29:53,797 - INFO - ------------------------
2024-10-04 17:29:55,143 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:29:55,143 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051900000        BTCUSDT    5          1728051900000 61061.1015625 61142.0    61057.8203125 61134.0    69.65895080566406 4255598.0  9113.0     19.20479965209961 1173317.0  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:29:55,811 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:29:55,811 - INFO - ------------------------
2024-10-04 17:29:57,155 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:29:57,155 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728051300000        BTCUSDT    15         1728051300000 61300.0    61400.0    61279.91015625 61400.0    48.9693603515625 3003852.25 20273.0    32.608089447021484 2000422.0  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:29:57,814 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:29:57,815 - INFO - ------------------------
2024-10-04 17:29:58,815 - INFO - All files have been updated with the latest prices.
2024-10-04 17:29:58,844 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:29:58,923 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:29:58,924 - INFO - Logging is set up.
2024-10-04 17:29:58,924 - INFO - Using device: cuda
2024-10-04 17:29:58,964 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:29:58,988 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:29:58,989 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:29:59,162 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:29:59,162 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:30:21,696 - INFO - Epoch 1/5 - Loss: 0.9816
2024-10-04 17:30:21,783 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:30:21,784 - INFO - Validation loss improved to 0.9816. Model saved.
2024-10-04 17:30:43,643 - INFO - Epoch 2/5 - Loss: 0.9818
2024-10-04 17:30:43,643 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:30:43,644 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:31:04,896 - INFO - Epoch 3/5 - Loss: 0.9815
2024-10-04 17:31:04,981 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:31:04,981 - INFO - Validation loss improved to 0.9815. Model saved.
2024-10-04 17:31:26,788 - INFO - Epoch 4/5 - Loss: 0.9823
2024-10-04 17:31:26,788 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:31:26,788 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:31:48,540 - INFO - Epoch 5/5 - Loss: 0.9819
2024-10-04 17:31:48,541 - INFO - No improvement in validation loss. (2/5)
2024-10-04 17:31:48,541 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 17:31:48,541 - INFO - Script started
2024-10-04 17:31:48,913 - INFO - Binance API is available. Server time: 2024-10-04 14:31:48
2024-10-04 17:31:49,964 - INFO - Updating data for ETHUSDT from 1728052140001 to 1728052260000 (2024-10-04 14:29:00 to 2024-10-04 14:31:00)
2024-10-04 17:31:50,391 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:31:50,392 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052260000        ETHUSDT    1          1728052260000 2356.77001953125 2358.1298828125 2354.52001953125 2356.679931640625 453.8494873046875 1069492.375 3863.0     153.85360717773438 362503.8125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:31:51,058 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:31:51,058 - INFO - ------------------------
2024-10-04 17:31:53,098 - INFO - Updating data for ETHUSDT from 1728051900001 to 1728052200000 (2024-10-04 14:25:00 to 2024-10-04 14:30:00)
2024-10-04 17:31:53,479 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 17:31:53,479 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        ETHUSDT    5          1728052200000 2359.330078125 2360.0400390625 2354.52001953125 2355.610107421875 973.7744750976562 2295212.75 8966.0     392.6452941894531 925557.875 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:31:54,138 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:31:54,138 - INFO - ------------------------
2024-10-04 17:31:56,169 - INFO - Updating data for ETHUSDT from 1728051300001 to 1728052200000 (2024-10-04 14:15:00 to 2024-10-04 14:30:00)
2024-10-04 17:31:56,535 - INFO - Data saved to data/ETHUSDT_15_data.csv
2024-10-04 17:31:56,536 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        ETHUSDT    15         1728052200000 2359.330078125 2360.0400390625 2354.52001953125 2355.800048828125 985.2979736328125 2322359.0  9101.0     400.69830322265625 944528.375 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14.0       0.0        -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:31:57,204 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:31:57,205 - INFO - ------------------------
2024-10-04 17:31:59,196 - INFO - Updating data for BTCUSDT from 1728052140001 to 1728052260000 (2024-10-04 14:29:00 to 2024-10-04 14:31:00)
2024-10-04 17:31:59,592 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:31:59,593 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052260000        BTCUSDT    1          1728052260000 60876.01171875 60890.0    60753.96875 60822.0    119.8219985961914 7288956.0  13866.0    37.55281066894531 2284673.25 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:32:00,235 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:32:00,235 - INFO - ------------------------
2024-10-04 17:32:02,175 - INFO - Updating data for BTCUSDT from 1728051900001 to 1728052200000 (2024-10-04 14:25:00 to 2024-10-04 14:30:00)
2024-10-04 17:32:02,520 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 17:32:02,521 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        BTCUSDT    5          1728052200000 60952.0    60952.0    60753.96875 60851.0    169.55006408691406 10316692.0 27623.0    62.38521957397461 3796540.5  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:32:03,154 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:32:03,155 - INFO - ------------------------
2024-10-04 17:32:05,097 - INFO - Updating data for BTCUSDT from 1728051300001 to 1728052200000 (2024-10-04 14:15:00 to 2024-10-04 14:30:00)
2024-10-04 17:32:05,433 - INFO - Data saved to data/BTCUSDT_15_data.csv
2024-10-04 17:32:05,433 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        BTCUSDT    15         1728052200000 60952.0    60952.0    60753.96875 60837.87890625 172.1502685546875 10474909.0 27958.0    62.57210159301758 3807909.5  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14.0       0.0        -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:32:06,066 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:32:06,066 - INFO - ------------------------
2024-10-04 17:32:07,067 - INFO - All files have been updated with the latest prices.
2024-10-04 17:32:07,097 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:32:07,177 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:32:07,178 - INFO - Logging is set up.
2024-10-04 17:32:07,178 - INFO - Using device: cuda
2024-10-04 17:32:07,218 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:32:07,243 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:32:07,243 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:32:07,428 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:32:07,428 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:32:29,801 - INFO - Epoch 1/5 - Loss: 0.9820
2024-10-04 17:32:29,884 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:32:29,884 - INFO - Validation loss improved to 0.9820. Model saved.
2024-10-04 17:32:51,719 - INFO - Epoch 2/5 - Loss: 0.9818
2024-10-04 17:32:51,808 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:32:51,808 - INFO - Validation loss improved to 0.9818. Model saved.
2024-10-04 17:33:13,058 - INFO - Epoch 3/5 - Loss: 0.9816
2024-10-04 17:33:13,142 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:33:13,142 - INFO - Validation loss improved to 0.9816. Model saved.
2024-10-04 17:33:34,935 - INFO - Epoch 4/5 - Loss: 0.9815
2024-10-04 17:33:35,019 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:33:35,019 - INFO - Validation loss improved to 0.9815. Model saved.
2024-10-04 17:33:56,771 - INFO - Epoch 5/5 - Loss: 0.9819
2024-10-04 17:33:56,772 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:33:56,772 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:33:56,772 - INFO - Script started
2024-10-04 17:33:57,166 - INFO - Binance API is available. Server time: 2024-10-04 14:33:57
2024-10-04 17:33:58,216 - INFO - Updating data for ETHUSDT from 1728052260001 to 1728052380000 (2024-10-04 14:31:00 to 2024-10-04 14:33:00)
2024-10-04 17:33:58,648 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:33:58,649 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052380000        ETHUSDT    1          1728052380000 2356.18994140625 2359.090087890625 2354.8701171875 2357.449951171875 369.7640075683594 871506.5625 4198.0     158.63999938964844 373925.71875 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:33:59,317 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:33:59,317 - INFO - ------------------------
2024-10-04 17:34:00,663 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:34:00,664 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        ETHUSDT    5          1728052200000 2359.330078125 2360.0400390625 2354.52001953125 2355.610107421875 973.7744750976562 2295212.75 8966.0     392.6452941894531 925557.875 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:34:01,322 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:34:01,322 - INFO - ------------------------
2024-10-04 17:34:02,668 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:34:02,669 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        ETHUSDT    15         1728052200000 2359.330078125 2360.0400390625 2354.52001953125 2355.800048828125 985.2979736328125 2322359.0  9101.0     400.69830322265625 944528.375 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:34:03,331 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:34:03,332 - INFO - ------------------------
2024-10-04 17:34:05,373 - INFO - Updating data for BTCUSDT from 1728052260001 to 1728052440000 (2024-10-04 14:31:00 to 2024-10-04 14:34:00)
2024-10-04 17:34:05,802 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:34:05,803 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052440000        BTCUSDT    1          1728052440000 60882.01171875 60882.5    60870.0    60870.01171875 0.8190000057220459 49859.77734375 534.0      0.21876999735832214 13318.8984375 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:34:06,482 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:34:06,482 - INFO - ------------------------
2024-10-04 17:34:07,828 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:34:07,829 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        BTCUSDT    5          1728052200000 60952.0    60952.0    60753.96875 60851.0    169.55006408691406 10316692.0 27623.0    62.38521957397461 3796540.5  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:34:08,511 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:34:08,511 - INFO - ------------------------
2024-10-04 17:34:09,859 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:34:09,860 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        BTCUSDT    15         1728052200000 60952.0    60952.0    60753.96875 60837.87890625 172.1502685546875 10474909.0 27958.0    62.57210159301758 3807909.5  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:34:10,537 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:34:10,537 - INFO - ------------------------
2024-10-04 17:34:11,538 - INFO - All files have been updated with the latest prices.
2024-10-04 17:34:11,566 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:34:11,650 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:34:11,651 - INFO - Logging is set up.
2024-10-04 17:34:11,651 - INFO - Using device: cuda
2024-10-04 17:34:11,690 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:34:11,713 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:34:11,713 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:34:11,889 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:34:11,889 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:34:34,334 - INFO - Epoch 1/5 - Loss: 0.9819
2024-10-04 17:34:34,418 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:34:34,418 - INFO - Validation loss improved to 0.9819. Model saved.
2024-10-04 17:34:55,693 - INFO - Epoch 2/5 - Loss: 0.9817
2024-10-04 17:34:55,777 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:34:55,777 - INFO - Validation loss improved to 0.9817. Model saved.
2024-10-04 17:35:17,545 - INFO - Epoch 3/5 - Loss: 0.9818
2024-10-04 17:35:17,545 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:35:17,545 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:35:39,523 - INFO - Epoch 4/5 - Loss: 0.9817
2024-10-04 17:35:39,524 - INFO - No improvement in validation loss. (2/5)
2024-10-04 17:35:39,524 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:36:00,735 - INFO - Epoch 5/5 - Loss: 0.9818
2024-10-04 17:36:00,735 - INFO - No improvement in validation loss. (3/5)
2024-10-04 17:36:00,735 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 17:36:00,735 - INFO - Script started
2024-10-04 17:36:01,096 - INFO - Binance API is available. Server time: 2024-10-04 14:36:01
2024-10-04 17:36:02,144 - INFO - Updating data for ETHUSDT from 1728052380001 to 1728052560000 (2024-10-04 14:33:00 to 2024-10-04 14:36:00)
2024-10-04 17:36:02,598 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:36:02,598 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052560000        ETHUSDT    1          1728052560000 2359.5     2359.699951171875 2358.8701171875 2359.360107421875 9.153900146484375 21596.109375 272.0      2.8896000385284424 6817.2841796875 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:36:03,879 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:36:03,879 - INFO - ------------------------
2024-10-04 17:36:05,928 - INFO - Updating data for ETHUSDT from 1728052200001 to 1728052500000 (2024-10-04 14:30:00 to 2024-10-04 14:35:00)
2024-10-04 17:36:06,311 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 17:36:06,312 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052500000        ETHUSDT    5          1728052500000 2357.510009765625 2359.719970703125 2356.89990234375 2358.909912109375 216.05929565429688 509579.46875 3380.0     135.25039672851562 318980.90625 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:36:06,992 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:36:06,992 - INFO - ------------------------
2024-10-04 17:36:08,337 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:36:08,338 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        ETHUSDT    15         1728052200000 2359.330078125 2360.0400390625 2354.52001953125 2355.800048828125 985.2979736328125 2322359.0  9101.0     400.69830322265625 944528.375 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:36:09,034 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:36:09,035 - INFO - ------------------------
2024-10-04 17:36:11,088 - INFO - Updating data for BTCUSDT from 1728052440001 to 1728052560000 (2024-10-04 14:34:00 to 2024-10-04 14:36:00)
2024-10-04 17:36:11,520 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:36:11,520 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052560000        BTCUSDT    1          1728052560000 60952.01171875 61020.0    60919.80859375 60986.01171875 36.985408782958984 2255125.75 3485.0     31.060260772705078 1893883.5  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:36:12,204 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:36:12,204 - INFO - ------------------------
2024-10-04 17:36:14,293 - INFO - Updating data for BTCUSDT from 1728052200001 to 1728052500000 (2024-10-04 14:30:00 to 2024-10-04 14:35:00)
2024-10-04 17:36:14,671 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 17:36:14,671 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052500000        BTCUSDT    5          1728052500000 60898.0    61020.0    60880.05859375 60982.01171875 68.28807830810547 4162186.5  12607.0    49.224029541015625 3000472.5  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:36:15,340 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:36:15,340 - INFO - ------------------------
2024-10-04 17:36:16,675 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:36:16,676 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        BTCUSDT    15         1728052200000 60952.0    60952.0    60753.96875 60837.87890625 172.1502685546875 10474909.0 27958.0    62.57210159301758 3807909.5  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:36:17,340 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:36:17,340 - INFO - ------------------------
2024-10-04 17:36:18,341 - INFO - All files have been updated with the latest prices.
2024-10-04 17:36:18,371 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:36:18,449 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:36:18,451 - INFO - Logging is set up.
2024-10-04 17:36:18,451 - INFO - Using device: cuda
2024-10-04 17:36:18,490 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:36:18,513 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:36:18,514 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:36:18,697 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:36:18,697 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:36:41,459 - INFO - Epoch 1/5 - Loss: 0.9821
2024-10-04 17:36:41,541 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:36:41,541 - INFO - Validation loss improved to 0.9821. Model saved.
2024-10-04 17:37:02,709 - INFO - Epoch 2/5 - Loss: 0.9817
2024-10-04 17:37:02,789 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:37:02,789 - INFO - Validation loss improved to 0.9817. Model saved.
2024-10-04 17:37:24,523 - INFO - Epoch 3/5 - Loss: 0.9816
2024-10-04 17:37:24,604 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:37:24,605 - INFO - Validation loss improved to 0.9816. Model saved.
2024-10-04 17:37:46,690 - INFO - Epoch 4/5 - Loss: 0.9815
2024-10-04 17:37:46,772 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:37:46,773 - INFO - Validation loss improved to 0.9815. Model saved.
2024-10-04 17:38:07,982 - INFO - Epoch 5/5 - Loss: 0.9817
2024-10-04 17:38:07,983 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:38:07,983 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:38:07,983 - INFO - Script started
2024-10-04 17:38:08,354 - INFO - Binance API is available. Server time: 2024-10-04 14:38:08
2024-10-04 17:38:09,395 - INFO - Updating data for ETHUSDT from 1728052560001 to 1728052680000 (2024-10-04 14:36:00 to 2024-10-04 14:38:00)
2024-10-04 17:38:09,824 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:38:09,825 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052680000        ETHUSDT    1          1728052680000 2359.14990234375 2359.949951171875 2358.739990234375 2358.739990234375 13.335100173950195 31459.822265625 431.0      4.738500118255615 11179.828125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:38:10,497 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:38:10,497 - INFO - ------------------------
2024-10-04 17:38:11,846 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:38:11,847 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052500000        ETHUSDT    5          1728052500000 2357.510009765625 2359.719970703125 2356.89990234375 2358.909912109375 216.05929565429688 509579.46875 3380.0     135.25039672851562 318980.90625 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:38:12,511 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:38:12,512 - INFO - ------------------------
2024-10-04 17:38:13,857 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:38:13,857 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        ETHUSDT    15         1728052200000 2359.330078125 2360.0400390625 2354.52001953125 2355.800048828125 985.2979736328125 2322359.0  9101.0     400.69830322265625 944528.375 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:38:15,128 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:38:15,129 - INFO - ------------------------
2024-10-04 17:38:17,181 - INFO - Updating data for BTCUSDT from 1728052560001 to 1728052680000 (2024-10-04 14:36:00 to 2024-10-04 14:38:00)
2024-10-04 17:38:17,697 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:38:17,697 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052680000        BTCUSDT    1          1728052680000 60960.0    60980.0    60952.828125 60958.0    6.261690139770508 381775.96875 2927.0     1.6875200271606445 102875.828125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:38:18,366 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:38:18,366 - INFO - ------------------------
2024-10-04 17:38:19,714 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:38:19,715 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052500000        BTCUSDT    5          1728052500000 60898.0    61020.0    60880.05859375 60982.01171875 68.28807830810547 4162186.5  12607.0    49.224029541015625 3000472.5  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:38:20,390 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:38:20,391 - INFO - ------------------------
2024-10-04 17:38:21,736 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:38:21,737 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        BTCUSDT    15         1728052200000 60952.0    60952.0    60753.96875 60837.87890625 172.1502685546875 10474909.0 27958.0    62.57210159301758 3807909.5  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:38:22,419 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:38:22,420 - INFO - ------------------------
2024-10-04 17:38:23,420 - INFO - All files have been updated with the latest prices.
2024-10-04 17:38:23,448 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:38:23,521 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:38:23,523 - INFO - Logging is set up.
2024-10-04 17:38:23,523 - INFO - Using device: cuda
2024-10-04 17:38:23,560 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:38:23,583 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:38:23,583 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:38:23,752 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:38:23,752 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:38:45,425 - INFO - Epoch 1/5 - Loss: 0.9816
2024-10-04 17:38:45,511 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:38:45,511 - INFO - Validation loss improved to 0.9816. Model saved.
2024-10-04 17:39:07,436 - INFO - Epoch 2/5 - Loss: 0.9815
2024-10-04 17:39:07,522 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:39:07,522 - INFO - Validation loss improved to 0.9815. Model saved.
2024-10-04 17:39:29,426 - INFO - Epoch 3/5 - Loss: 0.9817
2024-10-04 17:39:29,426 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:39:29,426 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:39:50,546 - INFO - Epoch 4/5 - Loss: 0.9817
2024-10-04 17:39:50,546 - INFO - No improvement in validation loss. (2/5)
2024-10-04 17:39:50,546 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:40:12,434 - INFO - Epoch 5/5 - Loss: 0.9816
2024-10-04 17:40:12,434 - INFO - No improvement in validation loss. (3/5)
2024-10-04 17:40:12,434 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 17:40:12,434 - INFO - Script started
2024-10-04 17:40:12,752 - INFO - Binance API is available. Server time: 2024-10-04 14:40:12
2024-10-04 17:40:13,701 - INFO - Updating data for ETHUSDT from 1728052680001 to 1728052800000 (2024-10-04 14:38:00 to 2024-10-04 14:40:00)
2024-10-04 17:40:14,179 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:40:14,179 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052800000        ETHUSDT    1          1728052800000 2357.699951171875 2360.0     2357.68994140625 2359.050048828125 37.75640106201172 89055.1015625 1086.0     20.973800659179688 49468.46484375 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:40:35,003 - INFO - Logging is set up.
2024-10-04 17:40:35,003 - INFO - Using device: cuda
2024-10-04 17:40:35,004 - INFO - Numerical columns for scaling: ['open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:40:35,004 - INFO - Categorical columns: ['symbol', 'interval']
2024-10-04 17:40:35,031 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:40:35,057 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:40:35,058 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:40:35,656 - WARNING - Model file models/enhanced_bilstm_model_ETHUSDT_v2.0.pth not found. A new model will be created.
2024-10-04 17:40:49,725 - INFO - Epoch 1/5 - Loss: 1.0020
2024-10-04 17:40:49,798 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:40:49,798 - INFO - Validation loss improved to 1.0020. Model saved.
2024-10-04 17:41:04,241 - INFO - Epoch 2/5 - Loss: 1.0022
2024-10-04 17:41:04,241 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:41:04,241 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:41:17,721 - INFO - Epoch 3/5 - Loss: 1.0038
2024-10-04 17:41:17,721 - INFO - No improvement in validation loss. (2/5)
2024-10-04 17:41:17,721 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:41:31,350 - INFO - Epoch 4/5 - Loss: 1.0163
2024-10-04 17:41:31,350 - INFO - No improvement in validation loss. (3/5)
2024-10-04 17:41:31,350 - INFO - Reducing learning rate to: 6.25e-05
2024-10-04 17:41:45,657 - INFO - Epoch 5/5 - Loss: 1.0022
2024-10-04 17:41:45,657 - INFO - No improvement in validation loss. (4/5)
2024-10-04 17:41:45,657 - INFO - Reducing learning rate to: 3.125e-05
2024-10-04 17:41:45,658 - INFO - Script started
2024-10-04 17:41:46,034 - INFO - Binance API is available. Server time: 2024-10-04 14:41:46
2024-10-04 17:41:47,072 - INFO - Updating data for ETHUSDT from 1728052800001 to 1728052860000 (2024-10-04 14:40:00 to 2024-10-04 14:41:00)
2024-10-04 17:41:47,503 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:41:47,503 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052860000        ETHUSDT    1          1728052860000 2361.389892578125 2364.699951171875 2361.389892578125 2362.25    110.05000305175781 260046.53125 1929.0     55.68840026855469 131585.78125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:41:48,069 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:41:48,069 - INFO - ------------------------
2024-10-04 17:41:50,083 - INFO - Updating data for ETHUSDT from 1728052500001 to 1728052800000 (2024-10-04 14:35:00 to 2024-10-04 14:40:00)
2024-10-04 17:41:50,457 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 17:41:50,457 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052800000        ETHUSDT    5          1728052800000 2357.699951171875 2364.699951171875 2357.68994140625 2362.199951171875 321.5397033691406 759204.5   6031.0     145.6551971435547 343901.65625 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:41:51,037 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:41:51,037 - INFO - ------------------------
2024-10-04 17:41:52,371 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:41:52,372 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        ETHUSDT    15         1728052200000 2359.330078125 2360.0400390625 2354.52001953125 2355.800048828125 985.2979736328125 2322359.0  9101.0     400.69830322265625 944528.375 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:41:52,970 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:41:52,970 - INFO - ------------------------
2024-10-04 17:41:55,016 - INFO - Updating data for BTCUSDT from 1728052680001 to 1728052860000 (2024-10-04 14:38:00 to 2024-10-04 14:41:00)
2024-10-04 17:41:55,447 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:41:55,448 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052860000        BTCUSDT    1          1728052860000 61037.98828125 61100.0    61034.80859375 61036.01171875 37.19506072998047 2271112.0  7656.0     28.71286964416504 1753089.0  14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:41:56,078 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:41:56,078 - INFO - ------------------------
2024-10-04 17:41:58,110 - INFO - Updating data for BTCUSDT from 1728052500001 to 1728052800000 (2024-10-04 14:35:00 to 2024-10-04 14:40:00)
2024-10-04 17:41:58,494 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 17:41:58,494 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052800000        BTCUSDT    5          1728052800000 60944.609375 61100.0    60940.05859375 61042.0    64.83365631103516 3957027.75 18533.0    47.066898345947266 2872536.25 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:41:59,141 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:41:59,141 - INFO - ------------------------
2024-10-04 17:42:00,483 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:42:00,483 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        BTCUSDT    15         1728052200000 60952.0    60952.0    60753.96875 60837.87890625 172.1502685546875 10474909.0 27958.0    62.57210159301758 3807909.5  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:42:01,173 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:42:01,173 - INFO - ------------------------
2024-10-04 17:42:02,173 - INFO - All files have been updated with the latest prices.
2024-10-04 17:42:02,203 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:42:02,287 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:42:02,289 - INFO - Logging is set up.
2024-10-04 17:42:02,289 - INFO - Using device: cuda
2024-10-04 17:42:02,327 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:42:02,353 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:42:02,353 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:42:02,529 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:42:02,529 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:42:25,120 - INFO - Epoch 1/5 - Loss: 1.6090
2024-10-04 17:42:25,206 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:42:25,206 - INFO - Validation loss improved to 1.6090. Model saved.
2024-10-04 17:42:47,201 - INFO - Epoch 2/5 - Loss: 1.6083
2024-10-04 17:42:47,286 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:42:47,287 - INFO - Validation loss improved to 1.6083. Model saved.
2024-10-04 17:43:08,463 - INFO - Epoch 3/5 - Loss: 1.6082
2024-10-04 17:43:08,547 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:43:08,547 - INFO - Validation loss improved to 1.6082. Model saved.
2024-10-04 17:43:30,381 - INFO - Epoch 4/5 - Loss: 1.6074
2024-10-04 17:43:30,465 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:43:30,465 - INFO - Validation loss improved to 1.6074. Model saved.
2024-10-04 17:43:52,479 - INFO - Epoch 5/5 - Loss: 1.6077
2024-10-04 17:43:52,479 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:43:52,479 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:43:52,480 - INFO - Script started
2024-10-04 17:43:52,841 - INFO - Binance API is available. Server time: 2024-10-04 14:43:52
2024-10-04 17:43:53,885 - INFO - Updating data for ETHUSDT from 1728052860001 to 1728052980000 (2024-10-04 14:41:00 to 2024-10-04 14:43:00)
2024-10-04 17:43:54,305 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:43:54,305 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052980000        ETHUSDT    1          1728052980000 2361.3701171875 2363.10009765625 2360.610107421875 2363.090087890625 58.394901275634766 137957.890625 1162.0     47.681800842285156 112647.78125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        ETHUSDT    1          1727273820000 2623.739990234375 2626.429931640625 2623.010009765625 2623.010009765625 134.4542999267578 352958.28125 2022.0     94.68710327148438 248560.953125 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:43:54,968 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:43:54,968 - INFO - ------------------------
2024-10-04 17:43:56,310 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:43:56,310 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052800000        ETHUSDT    5          1728052800000 2357.699951171875 2364.699951171875 2357.68994140625 2362.199951171875 321.5397033691406 759204.5   6031.0     145.6551971435547 343901.65625 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        ETHUSDT    5          1726496400000 2282.449951171875 2288.580078125 2279.0     2282.739990234375 2089.44873046875 4766593.0  14217.0    630.998779296875 1440206.125 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:43:56,965 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:43:56,965 - INFO - ------------------------
2024-10-04 17:43:58,318 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:43:58,319 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        ETHUSDT    15         1728052200000 2359.330078125 2360.0400390625 2354.52001953125 2355.800048828125 985.2979736328125 2322359.0  9101.0     400.69830322265625 944528.375 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        ETHUSDT    15         1724941800000 2564.800048828125 2574.89990234375 2560.330078125 2573.550048828125 2598.197509765625 6671317.5  17878.0    1427.3729248046875 3665418.25 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:43:59,001 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:43:59,001 - INFO - ------------------------
2024-10-04 17:44:01,038 - INFO - Updating data for BTCUSDT from 1728052860001 to 1728053040000 (2024-10-04 14:41:00 to 2024-10-04 14:44:00)
2024-10-04 17:44:01,470 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:44:01,471 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053040000        BTCUSDT    1          1728053040000 61065.19921875 61065.19921875 61065.19921875 61065.19921875 0.0016599999507889152 101.36823272705078 1.0        0.0        0.0        14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727273820000        BTCUSDT    1          1727273820000 63818.4296875 63855.0    63788.8203125 63788.8203125 13.546540260314941 864651.1875 5909.0     4.702209949493408 300162.21875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:44:02,137 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:44:02,137 - INFO - ------------------------
2024-10-04 17:44:03,483 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:44:03,483 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052800000        BTCUSDT    5          1728052800000 60944.609375 61100.0    60940.05859375 61042.0    64.83365631103516 3957027.75 18533.0    47.066898345947266 2872536.25 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726496400000        BTCUSDT    5          1726496400000 58164.0    58235.03125 58086.0    58116.0    123.02059936523438 7152746.0  21217.0    60.245418548583984 3502924.75 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:44:04,212 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:44:04,212 - INFO - ------------------------
2024-10-04 17:44:05,555 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:44:05,556 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728052200000        BTCUSDT    15         1728052200000 60952.0    60952.0    60753.96875 60837.87890625 172.1502685546875 10474909.0 27958.0    62.57210159301758 3807909.5  14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724941800000        BTCUSDT    15         1724941800000 60644.0    60909.0    60560.0    60879.98828125 446.8753967285156 27158244.0 46933.0    252.8336639404297 15367287.0 14         0          -0.5       -0.8660253882408142 0.0        1.0       

2024-10-04 17:44:06,216 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:44:06,216 - INFO - ------------------------
2024-10-04 17:44:07,217 - INFO - All files have been updated with the latest prices.
2024-10-04 17:44:07,246 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:44:07,332 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:44:07,333 - INFO - Logging is set up.
2024-10-04 17:44:07,333 - INFO - Using device: cuda
2024-10-04 17:44:07,370 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:44:07,394 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:44:07,394 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:44:07,568 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:44:07,568 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:44:30,058 - INFO - Epoch 1/5 - Loss: 1.6074
2024-10-04 17:44:30,143 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:44:30,144 - INFO - Validation loss improved to 1.6074. Model saved.
2024-10-04 17:44:52,048 - INFO - Epoch 2/5 - Loss: 1.6078
2024-10-04 17:44:52,048 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:44:52,048 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:45:13,335 - INFO - Epoch 3/5 - Loss: 1.6096
2024-10-04 17:45:13,336 - INFO - No improvement in validation loss. (2/5)
2024-10-04 17:45:13,336 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:45:35,228 - INFO - Epoch 4/5 - Loss: 1.6069
2024-10-04 17:45:35,311 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:45:35,311 - INFO - Validation loss improved to 1.6069. Model saved.
2024-10-04 17:51:48,457 - INFO - Logging is set up.
2024-10-04 17:51:48,458 - INFO - Using device: cuda
2024-10-04 17:51:48,458 - INFO - Numerical columns for scaling: ['open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:51:48,458 - INFO - Categorical columns: ['symbol', 'interval']
2024-10-04 17:51:48,500 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:51:48,533 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:51:48,534 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:51:49,129 - WARNING - Model file models/enhanced_bilstm_model_ETHUSDT_v2.0.pth not found. A new model will be created.
2024-10-04 17:52:11,790 - INFO - Epoch 1/5 - Loss: 0.1009
2024-10-04 17:52:11,863 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:52:11,863 - INFO - Validation loss improved to 0.1009. Model saved.
2024-10-04 17:52:33,685 - INFO - Epoch 2/5 - Loss: 0.0992
2024-10-04 17:52:33,765 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:52:33,765 - INFO - Validation loss improved to 0.0992. Model saved.
2024-10-04 17:52:54,927 - INFO - Epoch 3/5 - Loss: 0.0994
2024-10-04 17:52:54,927 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:52:54,927 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:53:16,760 - INFO - Epoch 4/5 - Loss: 0.0991
2024-10-04 17:53:16,840 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:53:16,840 - INFO - Validation loss improved to 0.0991. Model saved.
2024-10-04 17:53:38,683 - INFO - Epoch 5/5 - Loss: 0.0991
2024-10-04 17:53:38,763 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:53:38,763 - INFO - Validation loss improved to 0.0991. Model saved.
2024-10-04 17:53:38,764 - INFO - Script started
2024-10-04 17:53:39,133 - INFO - Binance API is available. Server time: 2024-10-04 14:53:39
2024-10-04 17:53:40,223 - INFO - Updating data for ETHUSDT from 1728053280001 to 1728053580000 (2024-10-04 14:48:00 to 2024-10-04 14:53:00)
2024-10-04 17:53:40,650 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:53:40,650 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053580000        ETHUSDT    1          1728053580000 2369.68994140625 2370.60009765625 2369.56005859375 2369.570068359375 133.71189880371094 316877.1875 1060.0     95.74099731445312 226885.421875 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727275560000        ETHUSDT    1          1727275560000 2623.219970703125 2623.409912109375 2622.360107421875 2623.219970703125 85.81849670410156 225086.1875 1920.0     30.86050033569336 80942.7421875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:53:41,394 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:53:41,394 - INFO - ------------------------
2024-10-04 17:53:43,442 - INFO - Updating data for ETHUSDT from 1728053100001 to 1728053400000 (2024-10-04 14:45:00 to 2024-10-04 14:50:00)
2024-10-04 17:53:43,820 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 17:53:43,820 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053400000        ETHUSDT    5          1728053400000 2368.1298828125 2370.919921875 2367.639892578125 2369.489990234375 615.956298828125 1459520.75 7537.0     353.28240966796875 837078.8125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726498200000        ETHUSDT    5          1726498200000 2279.699951171875 2284.550048828125 2278.800048828125 2279.449951171875 818.5986938476562 1867526.625 11799.0    509.2304992675781 1161805.875 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:53:44,499 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:53:44,500 - INFO - ------------------------
2024-10-04 17:53:45,844 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:53:45,845 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053100000        ETHUSDT    15         1728053100000 2365.360107421875 2365.52001953125 2362.969970703125 2363.300048828125 184.45889282226562 436007.71875 2086.0     44.02399826049805 104073.8671875 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724943600000        ETHUSDT    15         1724943600000 2569.550048828125 2579.8701171875 2567.639892578125 2575.489990234375 3397.218994140625 8748619.0  17585.0    2048.030029296875 5273692.5  15         0          -0.7071067690849304 -0.7071067690849304 0.0        1.0       

2024-10-04 17:53:46,521 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:53:46,521 - INFO - ------------------------
2024-10-04 17:53:48,554 - INFO - Updating data for BTCUSDT from 1728053340001 to 1728053580000 (2024-10-04 14:49:00 to 2024-10-04 14:53:00)
2024-10-04 17:53:48,980 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:53:48,981 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053580000        BTCUSDT    1          1728053580000 61249.109375 61260.0    61226.0    61227.44921875 7.378089904785156 451856.5625 2608.0     2.6486899852752686 162215.203125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727275620000        BTCUSDT    1          1727275620000 63809.98828125 63838.0    63780.0    63782.828125 9.135660171508789 582909.9375 4522.0     4.100729942321777 261667.4375 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:53:49,670 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:53:49,670 - INFO - ------------------------
2024-10-04 17:53:51,704 - INFO - Updating data for BTCUSDT from 1728053100001 to 1728053400000 (2024-10-04 14:45:00 to 2024-10-04 14:50:00)
2024-10-04 17:53:52,087 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 17:53:52,088 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053400000        BTCUSDT    5          1728053400000 61204.0    61275.98828125 61190.0    61218.0703125 63.06026077270508 3861363.5  19090.0    23.91506004333496 1464365.75 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726498200000        BTCUSDT    5          1726498200000 57690.01953125 57797.98828125 57642.0    57658.03125 140.4674835205078 8109055.0  20967.0    73.0241928100586 4215418.0  14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:53:52,755 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:53:52,755 - INFO - ------------------------
2024-10-04 17:53:54,098 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:53:54,098 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053100000        BTCUSDT    15         1728053100000 61152.0    61168.0    61100.73828125 61156.0    37.72536849975586 2306588.5  7053.0     16.669170379638672 1019246.3125 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724943600000        BTCUSDT    15         1724943600000 60815.0    61044.0    60792.0    60908.37109375 420.7099304199219 25636956.0 41676.0    231.10484313964844 14084383.0 15         0          -0.7071067690849304 -0.7071067690849304 0.0        1.0       

2024-10-04 17:53:54,776 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:53:54,776 - INFO - ------------------------
2024-10-04 17:53:55,776 - INFO - All files have been updated with the latest prices.
2024-10-04 17:53:55,807 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:53:55,894 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:53:55,896 - INFO - Logging is set up.
2024-10-04 17:53:55,896 - INFO - Using device: cuda
2024-10-04 17:53:55,936 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:53:55,962 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:53:55,963 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:53:56,133 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:53:56,133 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:54:18,748 - INFO - Epoch 1/5 - Loss: 0.0994
2024-10-04 17:54:18,836 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:54:18,836 - INFO - Validation loss improved to 0.0994. Model saved.
2024-10-04 17:54:40,096 - INFO - Epoch 2/5 - Loss: 0.0991
2024-10-04 17:54:40,183 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:54:40,183 - INFO - Validation loss improved to 0.0991. Model saved.
2024-10-04 17:55:02,074 - INFO - Epoch 3/5 - Loss: 0.0991
2024-10-04 17:55:02,162 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:55:02,162 - INFO - Validation loss improved to 0.0991. Model saved.
2024-10-04 17:55:24,087 - INFO - Epoch 4/5 - Loss: 0.0991
2024-10-04 17:55:24,172 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:55:24,173 - INFO - Validation loss improved to 0.0991. Model saved.
2024-10-04 17:55:45,481 - INFO - Epoch 5/5 - Loss: 0.0991
2024-10-04 17:55:45,564 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:55:45,564 - INFO - Validation loss improved to 0.0991. Model saved.
2024-10-04 17:55:45,565 - INFO - Script started
2024-10-04 17:55:45,968 - INFO - Binance API is available. Server time: 2024-10-04 14:55:46
2024-10-04 17:55:47,650 - INFO - Updating data for ETHUSDT from 1728053580001 to 1728053700000 (2024-10-04 14:53:00 to 2024-10-04 14:55:00)
2024-10-04 17:55:48,081 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:55:48,082 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053700000        ETHUSDT    1          1728053700000 2367.580078125 2368.169921875 2363.77001953125 2364.280029296875 205.9031982421875 487079.75  1255.0     25.313800811767578 59862.6015625 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727275560000        ETHUSDT    1          1727275560000 2623.219970703125 2623.409912109375 2622.360107421875 2623.219970703125 85.81849670410156 225086.1875 1920.0     30.86050033569336 80942.7421875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:55:48,766 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:55:48,766 - INFO - ------------------------
2024-10-04 17:55:50,801 - INFO - Updating data for ETHUSDT from 1728053400001 to 1728053700000 (2024-10-04 14:50:00 to 2024-10-04 14:55:00)
2024-10-04 17:55:51,183 - INFO - Data saved to data/ETHUSDT_5_data.csv
2024-10-04 17:55:51,184 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053700000        ETHUSDT    5          1728053700000 2367.580078125 2368.169921875 2363.77001953125 2363.97998046875 210.29359436035156 497459.59375 1345.0     25.561500549316406 60448.15234375 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726498200000        ETHUSDT    5          1726498200000 2279.699951171875 2284.550048828125 2278.800048828125 2279.449951171875 818.5986938476562 1867526.625 11799.0    509.2304992675781 1161805.875 14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:55:51,867 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:55:51,868 - INFO - ------------------------
2024-10-04 17:55:53,211 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:55:53,212 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053100000        ETHUSDT    15         1728053100000 2365.360107421875 2365.52001953125 2362.969970703125 2363.300048828125 184.45889282226562 436007.71875 2086.0     44.02399826049805 104073.8671875 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724943600000        ETHUSDT    15         1724943600000 2569.550048828125 2579.8701171875 2567.639892578125 2575.489990234375 3397.218994140625 8748619.0  17585.0    2048.030029296875 5273692.5  15         0          -0.7071067690849304 -0.7071067690849304 0.0        1.0       

2024-10-04 17:55:53,880 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:55:53,880 - INFO - ------------------------
2024-10-04 17:55:55,919 - INFO - Updating data for BTCUSDT from 1728053580001 to 1728053700000 (2024-10-04 14:53:00 to 2024-10-04 14:55:00)
2024-10-04 17:55:56,352 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:55:56,353 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053700000        BTCUSDT    1          1728053700000 61206.0    61231.96875 61126.53125 61126.5390625 13.854700088500977 847578.8125 5070.0     2.879499912261963 176179.953125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727275620000        BTCUSDT    1          1727275620000 63809.98828125 63838.0    63780.0    63782.828125 9.135660171508789 582909.9375 4522.0     4.100729942321777 261667.4375 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:55:57,025 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:55:57,025 - INFO - ------------------------
2024-10-04 17:55:59,059 - INFO - Updating data for BTCUSDT from 1728053400001 to 1728053700000 (2024-10-04 14:50:00 to 2024-10-04 14:55:00)
2024-10-04 17:55:59,446 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 17:55:59,447 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053700000        BTCUSDT    5          1728053700000 61206.0    61231.96875 61126.53125 61126.53125 14.323869705200195 876257.5625 5083.0     2.89274001121521 176989.265625 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726498200000        BTCUSDT    5          1726498200000 57690.01953125 57797.98828125 57642.0    57658.03125 140.4674835205078 8109055.0  20967.0    73.0241928100586 4215418.0  14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:56:00,114 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:56:00,114 - INFO - ------------------------
2024-10-04 17:56:01,458 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:56:01,459 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053100000        BTCUSDT    15         1728053100000 61152.0    61168.0    61100.73828125 61156.0    37.72536849975586 2306588.5  7053.0     16.669170379638672 1019246.3125 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724943600000        BTCUSDT    15         1724943600000 60815.0    61044.0    60792.0    60908.37109375 420.7099304199219 25636956.0 41676.0    231.10484313964844 14084383.0 15         0          -0.7071067690849304 -0.7071067690849304 0.0        1.0       

2024-10-04 17:56:02,134 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:56:02,134 - INFO - ------------------------
2024-10-04 17:56:03,135 - INFO - All files have been updated with the latest prices.
2024-10-04 17:56:03,164 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:56:03,248 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:56:03,249 - INFO - Logging is set up.
2024-10-04 17:56:03,249 - INFO - Using device: cuda
2024-10-04 17:56:03,288 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:56:03,313 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:56:03,313 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:56:03,486 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:56:03,486 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:56:26,061 - INFO - Epoch 1/5 - Loss: 0.0992
2024-10-04 17:56:26,147 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:56:26,147 - INFO - Validation loss improved to 0.0992. Model saved.
2024-10-04 17:56:47,336 - INFO - Epoch 2/5 - Loss: 0.0991
2024-10-04 17:56:47,423 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:56:47,423 - INFO - Validation loss improved to 0.0991. Model saved.
2024-10-04 17:57:09,361 - INFO - Epoch 3/5 - Loss: 0.0991
2024-10-04 17:57:09,361 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:57:09,361 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:57:31,225 - INFO - Epoch 4/5 - Loss: 0.0990
2024-10-04 17:57:31,314 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:57:31,315 - INFO - Validation loss improved to 0.0990. Model saved.
2024-10-04 17:57:52,487 - INFO - Epoch 5/5 - Loss: 0.0990
2024-10-04 17:57:52,487 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:57:52,487 - INFO - Reducing learning rate to: 0.000125
2024-10-04 17:57:52,488 - INFO - Script started
2024-10-04 17:57:52,840 - INFO - Binance API is available. Server time: 2024-10-04 14:57:53
2024-10-04 17:57:53,878 - INFO - Updating data for ETHUSDT from 1728053700001 to 1728053820000 (2024-10-04 14:55:00 to 2024-10-04 14:57:00)
2024-10-04 17:57:54,333 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:57:54,333 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053820000        ETHUSDT    1          1728053820000 2364.60009765625 2364.909912109375 2363.800048828125 2364.52001953125 78.80999755859375 186365.484375 705.0      17.643999099731445 41720.45703125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727275560000        ETHUSDT    1          1727275560000 2623.219970703125 2623.409912109375 2622.360107421875 2623.219970703125 85.81849670410156 225086.1875 1920.0     30.86050033569336 80942.7421875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:57:54,993 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:57:54,993 - INFO - ------------------------
2024-10-04 17:57:56,340 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:57:56,340 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053700000        ETHUSDT    5          1728053700000 2367.580078125 2368.169921875 2363.77001953125 2363.97998046875 210.29359436035156 497459.59375 1345.0     25.561500549316406 60448.15234375 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726498200000        ETHUSDT    5          1726498200000 2279.699951171875 2284.550048828125 2278.800048828125 2279.449951171875 818.5986938476562 1867526.625 11799.0    509.2304992675781 1161805.875 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:57:57,000 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:57:57,000 - INFO - ------------------------
2024-10-04 17:57:58,955 - INFO - Data for ETHUSDT does not require updating. Using current data.
2024-10-04 17:57:58,955 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053100000        ETHUSDT    15         1728053100000 2365.360107421875 2365.52001953125 2362.969970703125 2363.300048828125 184.45889282226562 436007.71875 2086.0     44.02399826049805 104073.8671875 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724943600000        ETHUSDT    15         1724943600000 2569.550048828125 2579.8701171875 2567.639892578125 2575.489990234375 3397.218994140625 8748619.0  17585.0    2048.030029296875 5273692.5  15         0          -0.7071067690849304 -0.7071067690849304 0.0        1.0       

2024-10-04 17:57:59,681 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:57:59,681 - INFO - ------------------------
2024-10-04 17:58:01,743 - INFO - Updating data for BTCUSDT from 1728053700001 to 1728053880000 (2024-10-04 14:55:00 to 2024-10-04 14:58:00)
2024-10-04 17:58:02,181 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 17:58:02,181 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053880000        BTCUSDT    1          1728053880000 61159.640625 61159.640625 61159.640625 61159.640625 0.0        0.0        0.0        0.0        0.0        14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727275620000        BTCUSDT    1          1727275620000 63809.98828125 63838.0    63780.0    63782.828125 9.135660171508789 582909.9375 4522.0     4.100729942321777 261667.4375 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:58:02,856 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:58:02,856 - INFO - ------------------------
2024-10-04 17:58:04,202 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:58:04,203 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053700000        BTCUSDT    5          1728053700000 61206.0    61231.96875 61126.53125 61126.53125 14.323869705200195 876257.5625 5083.0     2.89274001121521 176989.265625 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726498200000        BTCUSDT    5          1726498200000 57690.01953125 57797.98828125 57642.0    57658.03125 140.4674835205078 8109055.0  20967.0    73.0241928100586 4215418.0  14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 17:58:04,864 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:58:04,864 - INFO - ------------------------
2024-10-04 17:58:06,207 - INFO - Data for BTCUSDT does not require updating. Using current data.
2024-10-04 17:58:06,208 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053100000        BTCUSDT    15         1728053100000 61152.0    61168.0    61100.73828125 61156.0    37.72536849975586 2306588.5  7053.0     16.669170379638672 1019246.3125 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1724943600000        BTCUSDT    15         1724943600000 60815.0    61044.0    60792.0    60908.37109375 420.7099304199219 25636956.0 41676.0    231.10484313964844 14084383.0 15         0          -0.7071067690849304 -0.7071067690849304 0.0        1.0       

2024-10-04 17:58:06,882 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:58:06,883 - INFO - ------------------------
2024-10-04 17:58:07,883 - INFO - All files have been updated with the latest prices.
2024-10-04 17:58:07,912 - INFO - Latest dataset loaded with 300 records.
2024-10-04 17:58:07,996 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 17:58:07,998 - INFO - Logging is set up.
2024-10-04 17:58:07,998 - INFO - Using device: cuda
2024-10-04 17:58:08,036 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 17:58:08,059 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 17:58:08,060 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 17:58:08,238 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:58:08,238 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 17:58:29,993 - INFO - Epoch 1/5 - Loss: 0.0991
2024-10-04 17:58:30,079 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:58:30,079 - INFO - Validation loss improved to 0.0991. Model saved.
2024-10-04 17:58:51,899 - INFO - Epoch 2/5 - Loss: 0.0990
2024-10-04 17:58:51,982 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:58:51,982 - INFO - Validation loss improved to 0.0990. Model saved.
2024-10-04 17:59:13,841 - INFO - Epoch 3/5 - Loss: 0.0990
2024-10-04 17:59:13,924 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:59:13,924 - INFO - Validation loss improved to 0.0990. Model saved.
2024-10-04 17:59:34,927 - INFO - Epoch 4/5 - Loss: 0.0990
2024-10-04 17:59:35,011 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 17:59:35,011 - INFO - Validation loss improved to 0.0990. Model saved.
2024-10-04 17:59:56,905 - INFO - Epoch 5/5 - Loss: 0.0991
2024-10-04 17:59:56,905 - INFO - No improvement in validation loss. (1/5)
2024-10-04 17:59:56,905 - INFO - Reducing learning rate to: 0.00025
2024-10-04 17:59:56,905 - INFO - Script started
2024-10-04 17:59:57,258 - INFO - Binance API is available. Server time: 2024-10-04 14:59:57
2024-10-04 17:59:58,298 - INFO - Updating data for ETHUSDT from 1728053820001 to 1728053940000 (2024-10-04 14:57:00 to 2024-10-04 14:59:00)
2024-10-04 17:59:58,725 - INFO - Data saved to data/ETHUSDT_1_data.csv
2024-10-04 17:59:58,725 - INFO - Data summary for ETHUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053940000        ETHUSDT    1          1728053940000 2365.47998046875 2367.39990234375 2365.47998046875 2367.2099609375 57.86040115356445 136942.34375 577.0      26.400699615478516 62482.98828125 14.0       1.0        -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1727275560000        ETHUSDT    1          1727275560000 2623.219970703125 2623.409912109375 2622.360107421875 2623.219970703125 85.81849670410156 225086.1875 1920.0     30.86050033569336 80942.7421875 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 17:59:59,390 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 17:59:59,390 - INFO - ------------------------
2024-10-04 18:00:01,105 - WARNING - Failed to retrieve new data for ETHUSDT.
2024-10-04 18:00:01,106 - INFO - Data summary for ETHUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728053700000        ETHUSDT    5          1728053700000 2367.580078125 2368.169921875 2363.77001953125 2363.97998046875 210.29359436035156 497459.59375 1345.0     25.561500549316406 60448.15234375 14         1          -0.5       -0.8660253882408142 0.7818315029144287 0.6234897971153259
Last                 1726498200000        ETHUSDT    5          1726498200000 2279.699951171875 2284.550048828125 2278.800048828125 2279.449951171875 818.5986938476562 1867526.625 11799.0    509.2304992675781 1161805.875 14         4          -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 18:00:01,806 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 18:00:01,806 - INFO - ------------------------
2024-10-04 18:00:03,835 - INFO - Updating data for ETHUSDT from 1728053100001 to 1728054000000 (2024-10-04 14:45:00 to 2024-10-04 15:00:00)
2024-10-04 18:00:04,206 - INFO - Data saved to data/ETHUSDT_15_data.csv
2024-10-04 18:00:04,207 - INFO - Data summary for ETHUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728054000000        ETHUSDT    15         1728054000000 2367.2099609375 2367.389892578125 2366.949951171875 2367.3798828125 47.192100524902344 111705.515625 176.0      29.786300659179688 70503.6484375 15.0       1.0        -0.7071067690849304 -0.7071067690849304 0.7818315029144287 0.6234897971153259
Last                 1724943600000        ETHUSDT    15         1724943600000 2569.550048828125 2579.8701171875 2567.639892578125 2575.489990234375 3397.218994140625 8748619.0  17585.0    2048.030029296875 5273692.5  15.0       0.0        -0.7071067690849304 -0.7071067690849304 0.0        1.0       

2024-10-04 18:00:04,880 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 18:00:04,880 - INFO - ------------------------
2024-10-04 18:00:06,920 - INFO - Updating data for BTCUSDT from 1728053880001 to 1728054000000 (2024-10-04 14:58:00 to 2024-10-04 15:00:00)
2024-10-04 18:00:07,344 - INFO - Data saved to data/BTCUSDT_1_data.csv
2024-10-04 18:00:07,345 - INFO - Data summary for BTCUSDT (1):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728054000000        BTCUSDT    1          1728054000000 61240.0    61240.0    61230.0    61239.98828125 2.6024999618530273 159364.1875 1127.0     1.2571699619293213 76979.5546875 15.0       1.0        -0.7071067690849304 -0.7071067690849304 0.7818315029144287 0.6234897971153259
Last                 1727275620000        BTCUSDT    1          1727275620000 63809.98828125 63838.0    63780.0    63782.828125 9.135660171508789 582909.9375 4522.0     4.100729942321777 261667.4375 14.0       6.0        -0.5       -0.8660253882408142 -0.7818315029144287 0.6234897971153259

2024-10-04 18:00:08,017 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 18:00:08,017 - INFO - ------------------------
2024-10-04 18:00:10,684 - INFO - Updating data for BTCUSDT from 1728053700001 to 1728054000000 (2024-10-04 14:55:00 to 2024-10-04 15:00:00)
2024-10-04 18:00:11,073 - INFO - Data saved to data/BTCUSDT_5_data.csv
2024-10-04 18:00:11,073 - INFO - Data summary for BTCUSDT (5):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728054000000        BTCUSDT    5          1728054000000 61240.0    61240.0    61230.0    61240.0    2.7713398933410645 169703.953125 1154.0     1.4108699560165405 86392.1484375 15.0       1.0        -0.7071067690849304 -0.7071067690849304 0.7818315029144287 0.6234897971153259
Last                 1726498200000        BTCUSDT    5          1726498200000 57690.01953125 57797.98828125 57642.0    57658.03125 140.4674835205078 8109055.0  20967.0    73.0241928100586 4215418.0  14.0       4.0        -0.5       -0.8660253882408142 -0.4338837265968323 -0.9009688496589661

2024-10-04 18:00:11,770 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 18:00:11,770 - INFO - ------------------------
2024-10-04 18:00:13,824 - INFO - Updating data for BTCUSDT from 1728053100001 to 1728054000000 (2024-10-04 14:45:00 to 2024-10-04 15:00:00)
2024-10-04 18:00:14,200 - INFO - Data saved to data/BTCUSDT_15_data.csv
2024-10-04 18:00:14,200 - INFO - Data summary for BTCUSDT (15):
Timestamp            Symbol     Interval   Timestamp  Open       High       Low        Close      Volume     Quote_asset_volume Number_of_trades Taker_buy_base_asset_volume Taker_buy_quote_asset_volume Hour       Dayofweek  Sin_hour   Cos_hour   Sin_day    Cos_day   
First                1728054000000        BTCUSDT    15         1728054000000 61240.0    61246.0    61230.0    61240.30078125 3.407320022583008 208653.46875 1587.0     1.718940019607544 105259.0078125 15.0       1.0        -0.7071067690849304 -0.7071067690849304 0.7818315029144287 0.6234897971153259
Last                 1724943600000        BTCUSDT    15         1724943600000 60815.0    61044.0    60792.0    60908.37109375 420.7099304199219 25636956.0 41676.0    231.10484313964844 14084383.0 15.0       0.0        -0.7071067690849304 -0.7071067690849304 0.0        1.0       

2024-10-04 18:00:14,882 - INFO - Combined dataset updated: data/combined_dataset.csv
2024-10-04 18:00:14,882 - INFO - ------------------------
2024-10-04 18:00:15,883 - INFO - All files have been updated with the latest prices.
2024-10-04 18:00:15,911 - INFO - Latest dataset loaded with 300 records.
2024-10-04 18:00:15,997 - INFO - Predicted prices saved to data/predictions.csv.
2024-10-04 18:00:15,999 - INFO - Logging is set up.
2024-10-04 18:00:15,999 - INFO - Using device: cuda
2024-10-04 18:00:16,038 - INFO - Combined data loaded from data/combined_dataset.csv
2024-10-04 18:00:16,063 - INFO - num_symbols: 2, num_intervals: 3
2024-10-04 18:00:16,063 - INFO - Columns after processing: ['symbol', 'interval', 'timestamp', 'open', 'high', 'low', 'close', 'volume', 'quote_asset_volume', 'number_of_trades', 'taker_buy_base_asset_volume', 'taker_buy_quote_asset_volume', 'hour', 'dayofweek', 'sin_hour', 'cos_hour', 'sin_day', 'cos_day']
2024-10-04 18:00:16,248 - INFO - Optimizer loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 18:00:16,248 - INFO - Model loaded from models/enhanced_bilstm_model_ETHUSDT_v2.0.pth.
2024-10-04 18:00:38,130 - INFO - Epoch 1/5 - Loss: 0.0991
2024-10-04 18:00:38,222 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 18:00:38,222 - INFO - Validation loss improved to 0.0991. Model saved.
2024-10-04 18:01:00,179 - INFO - Epoch 2/5 - Loss: 0.0990
2024-10-04 18:01:00,262 - INFO - Model saved to models/enhanced_bilstm_model_ETHUSDT_v2.0.pth, and optimizer to models/enhanced_bilstm_model_ETHUSDT_v2.0_optimizer.pth.
2024-10-04 18:01:00,262 - INFO - Validation loss improved to 0.0990. Model saved.
