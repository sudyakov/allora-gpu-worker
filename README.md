# Модель прогнозирования финансовых показателей криптовалют

## Описание модели

Модель в файле BiLSTMModel.py предназначена для прогнозирования будущих значений финансовых показателей криптовалют. Она обучается на исторических данных, содержащих различные показатели рынка, и пытается предсказать следующий временной шаг на основе предыдущих наблюдений.

## Входные данные

### Исторические данные о рынке криптовалют

- **Файл данных**: Модель загружает данные из файла combined_dataset, который содержит объединенные данные по различным криптовалютам (например, "BTCUSDT", "ETHUSDT").
- **Показатели (фичи)**: Данные включают в себя различные финансовые показатели, определенные в словаре FEATURE_NAMES. Эти фичи могут включать цены открытия, закрытия, максимума, минимума, объемы торгов и другие важные метрики.
- **Категориальные признаки**: Символы криптовалют (например, "BTCUSDT") кодируются в числовые значения с помощью словаря SYMBOL_MAPPING.

### Дополнительные данные разностей (differences_data)

Во время обучения модель также использует данные разностей, которые содержат информацию об изменениях по определенным признакам. Это помогает модели лучше улавливать динамику рынка и улучшить точность прогнозов.

## Предобработка данных

1. **Масштабирование**: Числовые данные масштабируются в диапазон от 0 до 1 с помощью кастомного Min-Max скейлера CustomMinMaxScaler.
2. **Категориальные признаки**: Символы криптовалют, временые метки.
3. **Создание последовательностей**: Данные разбиваются на последовательности фиксированной длины (SEQ_LENGTH).

## Архитектура модели EnhancedBiLSTMModel

1. **Двунаправленный LSTM (BiLSTM)**: Учитывает зависимости в прямом и обратном направлении по последовательности.
2. **Механизм внимания (Attention)**: Позволяет модели фокусироваться на наиболее значимых временных шагах в последовательности.
3. **Полносвязный слой и функция активации ReLU**: Для получения конечных прогнозов.
4. **Инициализация весов**: Метод Xavier Uniform для улучшения сходимости.

## Процесс обучения

- **Функция потерь**: Среднеквадратичная ошибка (MSELoss) с учетом данных разностей.
- **Оптимизатор**: Adam с адаптивным шагом обучения.
- **Эпохи и ранняя остановка**: Механизм ранней остановки для предотвращения переобучения.
- **Пакетная обработка**: Данные подаются в модель пакетами (батчами) для эффективного обучения.

## Использование данных в модели

- **Входные данные**: Последовательности исторических данных определенной длины.
- **Выходные данные**: Прогноз следующего набора значений фичей.
- **Целевые значения**: Реальные значения фичей на следующий временной шаг.

## Заключение

Модель принимает последовательности исторических финансовых данных по криптовалютам, обрабатывает их с помощью двунаправленного LSTM и механизма внимания для выделения важных временных зависимостей, и обучается предсказывать будущие значения показателей рынка. Дополнительное использование данных разностей в функции потерь помогает модели лучше улавливать динамику изменений и повышает точность прогнозирования.
